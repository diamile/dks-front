{"remainingRequest":"C:\\Users\\diami\\OneDrive\\Bureau\\dakarspectatornews\\client\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\diami\\OneDrive\\Bureau\\dakarspectatornews\\client\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\diami\\OneDrive\\Bureau\\dakarspectatornews\\client\\src\\assets\\js\\jquery.bxslider.js","dependencies":[{"path":"C:\\Users\\diami\\OneDrive\\Bureau\\dakarspectatornews\\client\\src\\assets\\js\\jquery.bxslider.js","mtime":1612891469990},{"path":"C:\\Users\\diami\\OneDrive\\Bureau\\dakarspectatornews\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615656863448},{"path":"C:\\Users\\diami\\OneDrive\\Bureau\\dakarspectatornews\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1615656863461},{"path":"C:\\Users\\diami\\OneDrive\\Bureau\\dakarspectatornews\\client\\node_modules\\eslint-loader\\index.js","mtime":1615656899724}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiKTsKCi8qKgogKiBCeFNsaWRlciB2NC4xLjEgLSBGdWxseSBsb2FkZWQsIHJlc3BvbnNpdmUgY29udGVudCBzbGlkZXIKICogaHR0cDovL2J4c2xpZGVyLmNvbQogKgogKiBDb3B5cmlnaHQgMjAxMywgU3RldmVuIFdhbmRlcnNraSAtIGh0dHA6Ly9zdGV2ZW53YW5kZXJza2kuY29tIC0gaHR0cDovL2J4Y3JlYXRpdmUuY29tCiAqIFdyaXR0ZW4gd2hpbGUgZHJpbmtpbmcgQmVsZ2lhbiBhbGVzIGFuZCBsaXN0ZW5pbmcgdG8gamF6egogKgogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgLSBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlUCiAqLwo7CgooZnVuY3Rpb24gKCQpIHsKICB2YXIgcGx1Z2luID0ge307CiAgdmFyIGRlZmF1bHRzID0gewogICAgLy8gR0VORVJBTAogICAgbW9kZTogJ2hvcml6b250YWwnLAogICAgc2xpZGVTZWxlY3RvcjogJycsCiAgICBpbmZpbml0ZUxvb3A6IHRydWUsCiAgICBoaWRlQ29udHJvbE9uRW5kOiBmYWxzZSwKICAgIHNwZWVkOiA1MDAsCiAgICBlYXNpbmc6IG51bGwsCiAgICBzbGlkZU1hcmdpbjogMCwKICAgIHN0YXJ0U2xpZGU6IDAsCiAgICByYW5kb21TdGFydDogZmFsc2UsCiAgICBjYXB0aW9uczogZmFsc2UsCiAgICB0aWNrZXI6IGZhbHNlLAogICAgdGlja2VySG92ZXI6IGZhbHNlLAogICAgYWRhcHRpdmVIZWlnaHQ6IGZhbHNlLAogICAgYWRhcHRpdmVIZWlnaHRTcGVlZDogNTAwLAogICAgdmlkZW86IGZhbHNlLAogICAgdXNlQ1NTOiB0cnVlLAogICAgcHJlbG9hZEltYWdlczogJ3Zpc2libGUnLAogICAgcmVzcG9uc2l2ZTogdHJ1ZSwKICAgIC8vIFRPVUNICiAgICB0b3VjaEVuYWJsZWQ6IHRydWUsCiAgICBzd2lwZVRocmVzaG9sZDogNTAsCiAgICBvbmVUb09uZVRvdWNoOiB0cnVlLAogICAgcHJldmVudERlZmF1bHRTd2lwZVg6IHRydWUsCiAgICBwcmV2ZW50RGVmYXVsdFN3aXBlWTogZmFsc2UsCiAgICAvLyBQQUdFUgogICAgcGFnZXI6IHRydWUsCiAgICBwYWdlclR5cGU6ICdmdWxsJywKICAgIHBhZ2VyU2hvcnRTZXBhcmF0b3I6ICcgLyAnLAogICAgcGFnZXJTZWxlY3RvcjogbnVsbCwKICAgIGJ1aWxkUGFnZXI6IG51bGwsCiAgICBwYWdlckN1c3RvbTogbnVsbCwKICAgIC8vIENPTlRST0xTCiAgICBjb250cm9sczogdHJ1ZSwKICAgIG5leHRUZXh0OiAnTmV4dCcsCiAgICBwcmV2VGV4dDogJ1ByZXYnLAogICAgbmV4dFNlbGVjdG9yOiBudWxsLAogICAgcHJldlNlbGVjdG9yOiBudWxsLAogICAgYXV0b0NvbnRyb2xzOiBmYWxzZSwKICAgIHN0YXJ0VGV4dDogJ1N0YXJ0JywKICAgIHN0b3BUZXh0OiAnU3RvcCcsCiAgICBhdXRvQ29udHJvbHNDb21iaW5lOiBmYWxzZSwKICAgIGF1dG9Db250cm9sc1NlbGVjdG9yOiBudWxsLAogICAgLy8gQVVUTwogICAgYXV0bzogZmFsc2UsCiAgICBwYXVzZTogNDAwMCwKICAgIGF1dG9TdGFydDogdHJ1ZSwKICAgIGF1dG9EaXJlY3Rpb246ICduZXh0JywKICAgIGF1dG9Ib3ZlcjogZmFsc2UsCiAgICBhdXRvRGVsYXk6IDAsCiAgICAvLyBDQVJPVVNFTAogICAgbWluU2xpZGVzOiAxLAogICAgbWF4U2xpZGVzOiAxLAogICAgbW92ZVNsaWRlczogMCwKICAgIHNsaWRlV2lkdGg6IDAsCiAgICAvLyBDQUxMQkFDS1MKICAgIG9uU2xpZGVyTG9hZDogZnVuY3Rpb24gb25TbGlkZXJMb2FkKCkge30sCiAgICBvblNsaWRlQmVmb3JlOiBmdW5jdGlvbiBvblNsaWRlQmVmb3JlKCkge30sCiAgICBvblNsaWRlQWZ0ZXI6IGZ1bmN0aW9uIG9uU2xpZGVBZnRlcigpIHt9LAogICAgb25TbGlkZU5leHQ6IGZ1bmN0aW9uIG9uU2xpZGVOZXh0KCkge30sCiAgICBvblNsaWRlUHJldjogZnVuY3Rpb24gb25TbGlkZVByZXYoKSB7fQogIH07CgogICQuZm4uYnhTbGlkZXIgPSBmdW5jdGlvbiAob3B0aW9ucykgewogICAgaWYgKHRoaXMubGVuZ3RoID09IDApIHJldHVybiB0aGlzOyAvLyBzdXBwb3J0IG11dGx0aXBsZSBlbGVtZW50cwoKICAgIGlmICh0aGlzLmxlbmd0aCA+IDEpIHsKICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAkKHRoaXMpLmJ4U2xpZGVyKG9wdGlvbnMpOwogICAgICB9KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9IC8vIGNyZWF0ZSBhIG5hbWVzcGFjZSB0byBiZSB1c2VkIHRocm91Z2hvdXQgdGhlIHBsdWdpbgoKCiAgICB2YXIgc2xpZGVyID0ge307IC8vIHNldCBhIHJlZmVyZW5jZSB0byBvdXIgc2xpZGVyIGVsZW1lbnQKCiAgICB2YXIgZWwgPSB0aGlzOwogICAgcGx1Z2luLmVsID0gdGhpczsKICAgIC8qKgogICAgICogTWFrZXMgc2xpZGVzaG93IHJlc3BvbnNpdmUKICAgICAqLwogICAgLy8gZmlyc3QgZ2V0IHRoZSBvcmlnaW5hbCB3aW5kb3cgZGltZW5zICh0aGFua3MgYWxvdCBJRSkKCiAgICB2YXIgd2luZG93V2lkdGggPSAkKHdpbmRvdykud2lkdGgoKTsKICAgIHZhciB3aW5kb3dIZWlnaHQgPSAkKHdpbmRvdykuaGVpZ2h0KCk7CiAgICAvKioKICAgICAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgKiA9IFBSSVZBVEUgRlVOQ1RJT05TCiAgICAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgICovCgogICAgLyoqCiAgICAgKiBJbml0aWFsaXplcyBuYW1lc3BhY2Ugc2V0dGluZ3MgdG8gYmUgdXNlZCB0aHJvdWdob3V0IHBsdWdpbgogICAgICovCgogICAgdmFyIGluaXQgPSBmdW5jdGlvbiBpbml0KCkgewogICAgICAvLyBtZXJnZSB1c2VyLXN1cHBsaWVkIG9wdGlvbnMgd2l0aCB0aGUgZGVmYXVsdHMKICAgICAgc2xpZGVyLnNldHRpbmdzID0gJC5leHRlbmQoe30sIGRlZmF1bHRzLCBvcHRpb25zKTsgLy8gcGFyc2Ugc2xpZGVXaWR0aCBzZXR0aW5nCgogICAgICBzbGlkZXIuc2V0dGluZ3Muc2xpZGVXaWR0aCA9IHBhcnNlSW50KHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoKTsgLy8gc3RvcmUgdGhlIG9yaWdpbmFsIGNoaWxkcmVuCgogICAgICBzbGlkZXIuY2hpbGRyZW4gPSBlbC5jaGlsZHJlbihzbGlkZXIuc2V0dGluZ3Muc2xpZGVTZWxlY3Rvcik7IC8vIGNoZWNrIGlmIGFjdHVhbCBudW1iZXIgb2Ygc2xpZGVzIGlzIGxlc3MgdGhhbiBtaW5TbGlkZXMgLyBtYXhTbGlkZXMKCiAgICAgIGlmIChzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIDwgc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcykgc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcyA9IHNsaWRlci5jaGlsZHJlbi5sZW5ndGg7CiAgICAgIGlmIChzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIDwgc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcykgc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyA9IHNsaWRlci5jaGlsZHJlbi5sZW5ndGg7IC8vIGlmIHJhbmRvbSBzdGFydCwgc2V0IHRoZSBzdGFydFNsaWRlIHNldHRpbmcgdG8gcmFuZG9tIG51bWJlcgoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5yYW5kb21TdGFydCkgc2xpZGVyLnNldHRpbmdzLnN0YXJ0U2xpZGUgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoKTsgLy8gc3RvcmUgYWN0aXZlIHNsaWRlIGluZm9ybWF0aW9uCgogICAgICBzbGlkZXIuYWN0aXZlID0gewogICAgICAgIGluZGV4OiBzbGlkZXIuc2V0dGluZ3Muc3RhcnRTbGlkZQogICAgICB9OyAvLyBzdG9yZSBpZiB0aGUgc2xpZGVyIGlzIGluIGNhcm91c2VsIG1vZGUgKGRpc3BsYXlpbmcgLyBtb3ZpbmcgbXVsdGlwbGUgc2xpZGVzKQoKICAgICAgc2xpZGVyLmNhcm91c2VsID0gc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcyA+IDEgfHwgc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyA+IDE7IC8vIGlmIGNhcm91c2VsLCBmb3JjZSBwcmVsb2FkSW1hZ2VzID0gJ2FsbCcKCiAgICAgIGlmIChzbGlkZXIuY2Fyb3VzZWwpIHNsaWRlci5zZXR0aW5ncy5wcmVsb2FkSW1hZ2VzID0gJ2FsbCc7IC8vIGNhbGN1bGF0ZSB0aGUgbWluIC8gbWF4IHdpZHRoIHRocmVzaG9sZHMgYmFzZWQgb24gbWluIC8gbWF4IG51bWJlciBvZiBzbGlkZXMKICAgICAgLy8gdXNlZCB0byBzZXR1cCBhbmQgdXBkYXRlIGNhcm91c2VsIHNsaWRlcyBkaW1lbnNpb25zCgogICAgICBzbGlkZXIubWluVGhyZXNob2xkID0gc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcyAqIHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoICsgKHNsaWRlci5zZXR0aW5ncy5taW5TbGlkZXMgLSAxKSAqIHNsaWRlci5zZXR0aW5ncy5zbGlkZU1hcmdpbjsKICAgICAgc2xpZGVyLm1heFRocmVzaG9sZCA9IHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMgKiBzbGlkZXIuc2V0dGluZ3Muc2xpZGVXaWR0aCArIChzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzIC0gMSkgKiBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW47IC8vIHN0b3JlIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBzbGlkZXIgKGlmIGN1cnJlbnRseSBhbmltYXRpbmcsIHdvcmtpbmcgaXMgdHJ1ZSkKCiAgICAgIHNsaWRlci53b3JraW5nID0gZmFsc2U7IC8vIGluaXRpYWxpemUgdGhlIGNvbnRyb2xzIG9iamVjdAoKICAgICAgc2xpZGVyLmNvbnRyb2xzID0ge307IC8vIGluaXRpYWxpemUgYW4gYXV0byBpbnRlcnZhbAoKICAgICAgc2xpZGVyLmludGVydmFsID0gbnVsbDsgLy8gZGV0ZXJtaW5lIHdoaWNoIHByb3BlcnR5IHRvIHVzZSBmb3IgdHJhbnNpdGlvbnMKCiAgICAgIHNsaWRlci5hbmltUHJvcCA9IHNsaWRlci5zZXR0aW5ncy5tb2RlID09ICd2ZXJ0aWNhbCcgPyAndG9wJyA6ICdsZWZ0JzsgLy8gZGV0ZXJtaW5lIGlmIGhhcmR3YXJlIGFjY2VsZXJhdGlvbiBjYW4gYmUgdXNlZAoKICAgICAgc2xpZGVyLnVzaW5nQ1NTID0gc2xpZGVyLnNldHRpbmdzLnVzZUNTUyAmJiBzbGlkZXIuc2V0dGluZ3MubW9kZSAhPSAnZmFkZScgJiYgZnVuY3Rpb24gKCkgewogICAgICAgIC8vIGNyZWF0ZSBvdXIgdGVzdCBkaXYgZWxlbWVudAogICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgLy8gY3NzIHRyYW5zaXRpb24gcHJvcGVydGllcwoKICAgICAgICB2YXIgcHJvcHMgPSBbJ1dlYmtpdFBlcnNwZWN0aXZlJywgJ01velBlcnNwZWN0aXZlJywgJ09QZXJzcGVjdGl2ZScsICdtc1BlcnNwZWN0aXZlJ107IC8vIHRlc3QgZm9yIGVhY2ggcHJvcGVydHkKCiAgICAgICAgZm9yICh2YXIgaSBpbiBwcm9wcykgewogICAgICAgICAgaWYgKGRpdi5zdHlsZVtwcm9wc1tpXV0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBzbGlkZXIuY3NzUHJlZml4ID0gcHJvcHNbaV0ucmVwbGFjZSgnUGVyc3BlY3RpdmUnLCAnJykudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgc2xpZGVyLmFuaW1Qcm9wID0gJy0nICsgc2xpZGVyLmNzc1ByZWZpeCArICctdHJhbnNmb3JtJzsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0oKTsgLy8gaWYgdmVydGljYWwgbW9kZSBhbHdheXMgbWFrZSBtYXhTbGlkZXMgYW5kIG1pblNsaWRlcyBlcXVhbAoKCiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAndmVydGljYWwnKSBzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzID0gc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlczsgLy8gc2F2ZSBvcmlnaW5hbCBzdHlsZSBkYXRhCgogICAgICBlbC5kYXRhKCJvcmlnU3R5bGUiLCBlbC5hdHRyKCJzdHlsZSIpKTsKICAgICAgZWwuY2hpbGRyZW4oc2xpZGVyLnNldHRpbmdzLnNsaWRlU2VsZWN0b3IpLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICQodGhpcykuZGF0YSgib3JpZ1N0eWxlIiwgJCh0aGlzKS5hdHRyKCJzdHlsZSIpKTsKICAgICAgfSk7IC8vIHBlcmZvcm0gYWxsIERPTSAvIENTUyBtb2RpZmljYXRpb25zCgogICAgICBzZXR1cCgpOwogICAgfTsKICAgIC8qKgogICAgICogUGVyZm9ybXMgYWxsIERPTSBhbmQgQ1NTIG1vZGlmaWNhdGlvbnMKICAgICAqLwoKCiAgICB2YXIgc2V0dXAgPSBmdW5jdGlvbiBzZXR1cCgpIHsKICAgICAgLy8gd3JhcCBlbCBpbiBhIHdyYXBwZXIKICAgICAgZWwud3JhcCgnPGRpdiBjbGFzcz0iYngtd3JhcHBlciI+PGRpdiBjbGFzcz0iYngtdmlld3BvcnQiPjwvZGl2PjwvZGl2PicpOyAvLyBzdG9yZSBhIG5hbXNwYWNlIHJlZmVyZW5jZSB0byAuYngtdmlld3BvcnQKCiAgICAgIHNsaWRlci52aWV3cG9ydCA9IGVsLnBhcmVudCgpOyAvLyBhZGQgYSBsb2FkaW5nIGRpdiB0byBkaXNwbGF5IHdoaWxlIGltYWdlcyBhcmUgbG9hZGluZwoKICAgICAgc2xpZGVyLmxvYWRlciA9ICQoJzxkaXYgY2xhc3M9ImJ4LWxvYWRpbmciIC8+Jyk7CiAgICAgIHNsaWRlci52aWV3cG9ydC5wcmVwZW5kKHNsaWRlci5sb2FkZXIpOyAvLyBzZXQgZWwgdG8gYSBtYXNzaXZlIHdpZHRoLCB0byBob2xkIGFueSBuZWVkZWQgc2xpZGVzCiAgICAgIC8vIGFsc28gc3RyaXAgYW55IG1hcmdpbiBhbmQgcGFkZGluZyBmcm9tIGVsCgogICAgICBlbC5jc3MoewogICAgICAgIHdpZHRoOiBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAnaG9yaXpvbnRhbCcgPyBzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoICogMTAwICsgMjE1ICsgJyUnIDogJ2F1dG8nLAogICAgICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnCiAgICAgIH0pOyAvLyBpZiB1c2luZyBDU1MsIGFkZCB0aGUgZWFzaW5nIHByb3BlcnR5CgogICAgICBpZiAoc2xpZGVyLnVzaW5nQ1NTICYmIHNsaWRlci5zZXR0aW5ncy5lYXNpbmcpIHsKICAgICAgICBlbC5jc3MoJy0nICsgc2xpZGVyLmNzc1ByZWZpeCArICctdHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb24nLCBzbGlkZXIuc2V0dGluZ3MuZWFzaW5nKTsgLy8gaWYgbm90IHVzaW5nIENTUyBhbmQgbm8gZWFzaW5nIHZhbHVlIHdhcyBzdXBwbGllZCwgdXNlIHRoZSBkZWZhdWx0IEpTIGFuaW1hdGlvbiBlYXNpbmcgKHN3aW5nKQogICAgICB9IGVsc2UgaWYgKCFzbGlkZXIuc2V0dGluZ3MuZWFzaW5nKSB7CiAgICAgICAgc2xpZGVyLnNldHRpbmdzLmVhc2luZyA9ICdzd2luZyc7CiAgICAgIH0KCiAgICAgIHZhciBzbGlkZXNTaG93aW5nID0gZ2V0TnVtYmVyU2xpZGVzU2hvd2luZygpOyAvLyBtYWtlIG1vZGlmaWNhdGlvbnMgdG8gdGhlIHZpZXdwb3J0ICguYngtdmlld3BvcnQpCgogICAgICBzbGlkZXIudmlld3BvcnQuY3NzKHsKICAgICAgICB3aWR0aDogJzEwMCUnLAogICAgICAgIG92ZXJmbG93OiAnaGlkZGVuJywKICAgICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJwogICAgICB9KTsKICAgICAgc2xpZGVyLnZpZXdwb3J0LnBhcmVudCgpLmNzcyh7CiAgICAgICAgbWF4V2lkdGg6IGdldFZpZXdwb3J0TWF4V2lkdGgoKQogICAgICB9KTsgLy8gbWFrZSBtb2RpZmljYXRpb24gdG8gdGhlIHdyYXBwZXIgKC5ieC13cmFwcGVyKQoKICAgICAgaWYgKCFzbGlkZXIuc2V0dGluZ3MucGFnZXIpIHsKICAgICAgICBzbGlkZXIudmlld3BvcnQucGFyZW50KCkuY3NzKHsKICAgICAgICAgIG1hcmdpbjogJzAgYXV0byAwcHgnCiAgICAgICAgfSk7CiAgICAgIH0gLy8gYXBwbHkgY3NzIHRvIGFsbCBzbGlkZXIgY2hpbGRyZW4KCgogICAgICBzbGlkZXIuY2hpbGRyZW4uY3NzKHsKICAgICAgICAnZmxvYXQnOiBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAnaG9yaXpvbnRhbCcgPyAnbGVmdCcgOiAnbm9uZScsCiAgICAgICAgbGlzdFN0eWxlOiAnbm9uZScsCiAgICAgICAgcG9zaXRpb246ICdyZWxhdGl2ZScKICAgICAgfSk7IC8vIGFwcGx5IHRoZSBjYWxjdWxhdGVkIHdpZHRoIGFmdGVyIHRoZSBmbG9hdCBpcyBhcHBsaWVkIHRvIHByZXZlbnQgc2Nyb2xsYmFyIGludGVyZmVyZW5jZQoKICAgICAgc2xpZGVyLmNoaWxkcmVuLmNzcygnd2lkdGgnLCBnZXRTbGlkZVdpZHRoKCkpOyAvLyBpZiBzbGlkZU1hcmdpbiBpcyBzdXBwbGllZCwgYWRkIHRoZSBjc3MKCiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAnaG9yaXpvbnRhbCcgJiYgc2xpZGVyLnNldHRpbmdzLnNsaWRlTWFyZ2luID4gMCkgc2xpZGVyLmNoaWxkcmVuLmNzcygnbWFyZ2luUmlnaHQnLCBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4pOwogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT0gJ3ZlcnRpY2FsJyAmJiBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4gPiAwKSBzbGlkZXIuY2hpbGRyZW4uY3NzKCdtYXJnaW5Cb3R0b20nLCBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4pOyAvLyBpZiAiZmFkZSIgbW9kZSwgYWRkIHBvc2l0aW9uaW5nIGFuZCB6LWluZGV4IENTUwoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09ICdmYWRlJykgewogICAgICAgIHNsaWRlci5jaGlsZHJlbi5jc3MoewogICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsCiAgICAgICAgICB6SW5kZXg6IDAsCiAgICAgICAgICBkaXNwbGF5OiAnbm9uZScKICAgICAgICB9KTsgLy8gcHJlcGFyZSB0aGUgei1pbmRleCBvbiB0aGUgc2hvd2luZyBlbGVtZW50CgogICAgICAgIHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuc2V0dGluZ3Muc3RhcnRTbGlkZSkuY3NzKHsKICAgICAgICAgIHpJbmRleDogNTAsCiAgICAgICAgICBkaXNwbGF5OiAnYmxvY2snCiAgICAgICAgfSk7CiAgICAgIH0gLy8gY3JlYXRlIGFuIGVsZW1lbnQgdG8gY29udGFpbiBhbGwgc2xpZGVyIGNvbnRyb2xzIChwYWdlciwgc3RhcnQgLyBzdG9wLCBldGMpCgoKICAgICAgc2xpZGVyLmNvbnRyb2xzLmVsID0gJCgnPGRpdiBjbGFzcz0iYngtY29udHJvbHMiIC8+Jyk7IC8vIGlmIGNhcHRpb25zIGFyZSByZXF1ZXN0ZWQsIGFkZCB0aGVtCgogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmNhcHRpb25zKSBhcHBlbmRDYXB0aW9ucygpOyAvLyBjaGVjayBpZiBzdGFydFNsaWRlIGlzIGxhc3Qgc2xpZGUKCiAgICAgIHNsaWRlci5hY3RpdmUubGFzdCA9IHNsaWRlci5zZXR0aW5ncy5zdGFydFNsaWRlID09IGdldFBhZ2VyUXR5KCkgLSAxOyAvLyBpZiB2aWRlbyBpcyB0cnVlLCBzZXQgdXAgdGhlIGZpdFZpZHMgcGx1Z2luCgogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnZpZGVvKSBlbC5maXRWaWRzKCk7IC8vIHNldCB0aGUgZGVmYXVsdCBwcmVsb2FkIHNlbGVjdG9yICh2aXNpYmxlKQoKICAgICAgdmFyIHByZWxvYWRTZWxlY3RvciA9IHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuc2V0dGluZ3Muc3RhcnRTbGlkZSk7CiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MucHJlbG9hZEltYWdlcyA9PSAiYWxsIikgcHJlbG9hZFNlbGVjdG9yID0gc2xpZGVyLmNoaWxkcmVuOyAvLyBvbmx5IGNoZWNrIGZvciBjb250cm9sIGFkZGl0aW9uIGlmIG5vdCBpbiAidGlja2VyIiBtb2RlCgogICAgICBpZiAoIXNsaWRlci5zZXR0aW5ncy50aWNrZXIpIHsKICAgICAgICAvLyBpZiBwYWdlciBpcyByZXF1ZXN0ZWQsIGFkZCBpdAogICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MucGFnZXIpIGFwcGVuZFBhZ2VyKCk7IC8vIGlmIGNvbnRyb2xzIGFyZSByZXF1ZXN0ZWQsIGFkZCB0aGVtCgogICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuY29udHJvbHMpIGFwcGVuZENvbnRyb2xzKCk7IC8vIGlmIGF1dG8gaXMgdHJ1ZSwgYW5kIGF1dG8gY29udHJvbHMgYXJlIHJlcXVlc3RlZCwgYWRkIHRoZW0KCiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvICYmIHNsaWRlci5zZXR0aW5ncy5hdXRvQ29udHJvbHMpIGFwcGVuZENvbnRyb2xzQXV0bygpOyAvLyBpZiBhbnkgY29udHJvbCBvcHRpb24gaXMgcmVxdWVzdGVkLCBhZGQgdGhlIGNvbnRyb2xzIHdyYXBwZXIKCiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5jb250cm9scyB8fCBzbGlkZXIuc2V0dGluZ3MuYXV0b0NvbnRyb2xzIHx8IHNsaWRlci5zZXR0aW5ncy5wYWdlcikgc2xpZGVyLnZpZXdwb3J0LmFmdGVyKHNsaWRlci5jb250cm9scy5lbCk7IC8vIGlmIHRpY2tlciBtb2RlLCBkbyBub3QgYWxsb3cgYSBwYWdlcgogICAgICB9IGVsc2UgewogICAgICAgIHNsaWRlci5zZXR0aW5ncy5wYWdlciA9IGZhbHNlOwogICAgICB9IC8vIHByZWxvYWQgYWxsIGltYWdlcywgdGhlbiBwZXJmb3JtIGZpbmFsIERPTSAvIENTUyBtb2RpZmljYXRpb25zIHRoYXQgZGVwZW5kIG9uIGltYWdlcyBiZWluZyBsb2FkZWQKCgogICAgICBsb2FkRWxlbWVudHMocHJlbG9hZFNlbGVjdG9yLCBzdGFydCk7CiAgICB9OwoKICAgIHZhciBsb2FkRWxlbWVudHMgPSBmdW5jdGlvbiBsb2FkRWxlbWVudHMoc2VsZWN0b3IsIGNhbGxiYWNrKSB7CiAgICAgIHZhciB0b3RhbCA9IHNlbGVjdG9yLmZpbmQoJ2ltZywgaWZyYW1lJykubGVuZ3RoOwoKICAgICAgaWYgKHRvdGFsID09IDApIHsKICAgICAgICBjYWxsYmFjaygpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGNvdW50ID0gMDsKICAgICAgc2VsZWN0b3IuZmluZCgnaW1nLCBpZnJhbWUnKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAkKHRoaXMpLm9uZSgnbG9hZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICgrK2NvdW50ID09IHRvdGFsKSBjYWxsYmFjaygpOwogICAgICAgIH0pLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKHRoaXMuY29tcGxldGUpICQodGhpcykubG9hZCgpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH07CiAgICAvKioKICAgICAqIFN0YXJ0IHRoZSBzbGlkZXIKICAgICAqLwoKCiAgICB2YXIgc3RhcnQgPSBmdW5jdGlvbiBzdGFydCgpIHsKICAgICAgLy8gaWYgaW5maW5pdGUgbG9vcCwgcHJlcGFyZSBhZGRpdGlvbmFsIHNsaWRlcwogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmluZmluaXRlTG9vcCAmJiBzbGlkZXIuc2V0dGluZ3MubW9kZSAhPSAnZmFkZScgJiYgIXNsaWRlci5zZXR0aW5ncy50aWNrZXIpIHsKICAgICAgICB2YXIgc2xpY2UgPSBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAndmVydGljYWwnID8gc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcyA6IHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXM7CiAgICAgICAgdmFyIHNsaWNlQXBwZW5kID0gc2xpZGVyLmNoaWxkcmVuLnNsaWNlKDAsIHNsaWNlKS5jbG9uZSgpLmFkZENsYXNzKCdieC1jbG9uZScpOwogICAgICAgIHZhciBzbGljZVByZXBlbmQgPSBzbGlkZXIuY2hpbGRyZW4uc2xpY2UoLXNsaWNlKS5jbG9uZSgpLmFkZENsYXNzKCdieC1jbG9uZScpOwogICAgICAgIGVsLmFwcGVuZChzbGljZUFwcGVuZCkucHJlcGVuZChzbGljZVByZXBlbmQpOwogICAgICB9IC8vIHJlbW92ZSB0aGUgbG9hZGluZyBET00gZWxlbWVudAoKCiAgICAgIHNsaWRlci5sb2FkZXIucmVtb3ZlKCk7IC8vIHNldCB0aGUgbGVmdCAvIHRvcCBwb3NpdGlvbiBvZiAiZWwiCgogICAgICBzZXRTbGlkZVBvc2l0aW9uKCk7IC8vIGlmICJ2ZXJ0aWNhbCIgbW9kZSwgYWx3YXlzIHVzZSBhZGFwdGl2ZUhlaWdodCB0byBwcmV2ZW50IG9kZCBiZWhhdmlvcgoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09ICd2ZXJ0aWNhbCcpIHNsaWRlci5zZXR0aW5ncy5hZGFwdGl2ZUhlaWdodCA9IHRydWU7IC8vIHNldCB0aGUgdmlld3BvcnQgaGVpZ2h0CgogICAgICBzbGlkZXIudmlld3BvcnQuaGVpZ2h0KGdldFZpZXdwb3J0SGVpZ2h0KCkpOyAvLyBtYWtlIHN1cmUgZXZlcnl0aGluZyBpcyBwb3NpdGlvbmVkIGp1c3QgcmlnaHQgKHNhbWUgYXMgYSB3aW5kb3cgcmVzaXplKQoKICAgICAgZWwucmVkcmF3U2xpZGVyKCk7IC8vIG9uU2xpZGVyTG9hZCBjYWxsYmFjawoKICAgICAgc2xpZGVyLnNldHRpbmdzLm9uU2xpZGVyTG9hZChzbGlkZXIuYWN0aXZlLmluZGV4KTsgLy8gc2xpZGVyIGhhcyBiZWVuIGZ1bGx5IGluaXRpYWxpemVkCgogICAgICBzbGlkZXIuaW5pdGlhbGl6ZWQgPSB0cnVlOyAvLyBiaW5kIHRoZSByZXNpemUgY2FsbCB0byB0aGUgd2luZG93CgogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnJlc3BvbnNpdmUpICQod2luZG93KS5iaW5kKCdyZXNpemUnLCByZXNpemVXaW5kb3cpOyAvLyBpZiBhdXRvIGlzIHRydWUsIHN0YXJ0IHRoZSBzaG93CgogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG8gJiYgc2xpZGVyLnNldHRpbmdzLmF1dG9TdGFydCkgaW5pdEF1dG8oKTsgLy8gaWYgdGlja2VyIGlzIHRydWUsIHN0YXJ0IHRoZSB0aWNrZXIKCiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MudGlja2VyKSBpbml0VGlja2VyKCk7IC8vIGlmIHBhZ2VyIGlzIHJlcXVlc3RlZCwgbWFrZSB0aGUgYXBwcm9wcmlhdGUgcGFnZXIgbGluayBhY3RpdmUKCiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MucGFnZXIpIHVwZGF0ZVBhZ2VyQWN0aXZlKHNsaWRlci5zZXR0aW5ncy5zdGFydFNsaWRlKTsgLy8gY2hlY2sgZm9yIGFueSB1cGRhdGVzIHRvIHRoZSBjb250cm9scyAobGlrZSBoaWRlQ29udHJvbE9uRW5kIHVwZGF0ZXMpCgogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmNvbnRyb2xzKSB1cGRhdGVEaXJlY3Rpb25Db250cm9scygpOyAvLyBpZiB0b3VjaEVuYWJsZWQgaXMgdHJ1ZSwgc2V0dXAgdGhlIHRvdWNoIGV2ZW50cwoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy50b3VjaEVuYWJsZWQgJiYgIXNsaWRlci5zZXR0aW5ncy50aWNrZXIpIGluaXRUb3VjaCgpOwogICAgfTsKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgY2FsY3VsYXRlZCBoZWlnaHQgb2YgdGhlIHZpZXdwb3J0LCB1c2VkIHRvIGRldGVybWluZSBlaXRoZXIgYWRhcHRpdmVIZWlnaHQgb3IgdGhlIG1heEhlaWdodCB2YWx1ZQogICAgICovCgoKICAgIHZhciBnZXRWaWV3cG9ydEhlaWdodCA9IGZ1bmN0aW9uIGdldFZpZXdwb3J0SGVpZ2h0KCkgewogICAgICB2YXIgaGVpZ2h0ID0gMDsgLy8gZmlyc3QgZGV0ZXJtaW5lIHdoaWNoIGNoaWxkcmVuIChzbGlkZXMpIHNob3VsZCBiZSB1c2VkIGluIG91ciBoZWlnaHQgY2FsY3VsYXRpb24KCiAgICAgIHZhciBjaGlsZHJlbiA9ICQoKTsgLy8gaWYgbW9kZSBpcyBub3QgInZlcnRpY2FsIiBhbmQgYWRhcHRpdmVIZWlnaHQgaXMgZmFsc2UsIGluY2x1ZGUgYWxsIGNoaWxkcmVuCgogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgIT0gJ3ZlcnRpY2FsJyAmJiAhc2xpZGVyLnNldHRpbmdzLmFkYXB0aXZlSGVpZ2h0KSB7CiAgICAgICAgY2hpbGRyZW4gPSBzbGlkZXIuY2hpbGRyZW47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gaWYgbm90IGNhcm91c2VsLCByZXR1cm4gdGhlIHNpbmdsZSBhY3RpdmUgY2hpbGQKICAgICAgICBpZiAoIXNsaWRlci5jYXJvdXNlbCkgewogICAgICAgICAgY2hpbGRyZW4gPSBzbGlkZXIuY2hpbGRyZW4uZXEoc2xpZGVyLmFjdGl2ZS5pbmRleCk7IC8vIGlmIGNhcm91c2VsLCByZXR1cm4gYSBzbGljZSBvZiBjaGlsZHJlbgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBnZXQgdGhlIGluZGl2aWR1YWwgc2xpZGUgaW5kZXgKICAgICAgICAgIHZhciBjdXJyZW50SW5kZXggPSBzbGlkZXIuc2V0dGluZ3MubW92ZVNsaWRlcyA9PSAxID8gc2xpZGVyLmFjdGl2ZS5pbmRleCA6IHNsaWRlci5hY3RpdmUuaW5kZXggKiBnZXRNb3ZlQnkoKTsgLy8gYWRkIHRoZSBjdXJyZW50IHNsaWRlIHRvIHRoZSBjaGlsZHJlbgoKICAgICAgICAgIGNoaWxkcmVuID0gc2xpZGVyLmNoaWxkcmVuLmVxKGN1cnJlbnRJbmRleCk7IC8vIGN5Y2xlIHRocm91Z2ggdGhlIHJlbWFpbmluZyAic2hvd2luZyIgc2xpZGVzCgogICAgICAgICAgZm9yIChpID0gMTsgaSA8PSBzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzIC0gMTsgaSsrKSB7CiAgICAgICAgICAgIC8vIGlmIGxvb3BlZCBiYWNrIHRvIHRoZSBzdGFydAogICAgICAgICAgICBpZiAoY3VycmVudEluZGV4ICsgaSA+PSBzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgICAgICAgICAgY2hpbGRyZW4gPSBjaGlsZHJlbi5hZGQoc2xpZGVyLmNoaWxkcmVuLmVxKGkgLSAxKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY2hpbGRyZW4gPSBjaGlsZHJlbi5hZGQoc2xpZGVyLmNoaWxkcmVuLmVxKGN1cnJlbnRJbmRleCArIGkpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvLyBpZiAidmVydGljYWwiIG1vZGUsIGNhbGN1bGF0ZSB0aGUgc3VtIG9mIHRoZSBoZWlnaHRzIG9mIHRoZSBjaGlsZHJlbgoKCiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAndmVydGljYWwnKSB7CiAgICAgICAgY2hpbGRyZW4uZWFjaChmdW5jdGlvbiAoaW5kZXgpIHsKICAgICAgICAgIGhlaWdodCArPSAkKHRoaXMpLm91dGVySGVpZ2h0KCk7CiAgICAgICAgfSk7IC8vIGFkZCB1c2VyLXN1cHBsaWVkIG1hcmdpbnMKCiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5zbGlkZU1hcmdpbiA+IDApIHsKICAgICAgICAgIGhlaWdodCArPSBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4gKiAoc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcyAtIDEpOwogICAgICAgIH0gLy8gaWYgbm90ICJ2ZXJ0aWNhbCIgbW9kZSwgY2FsY3VsYXRlIHRoZSBtYXggaGVpZ2h0IG9mIHRoZSBjaGlsZHJlbgoKICAgICAgfSBlbHNlIHsKICAgICAgICBoZWlnaHQgPSBNYXRoLm1heC5hcHBseShNYXRoLCBjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuICQodGhpcykub3V0ZXJIZWlnaHQoZmFsc2UpOwogICAgICAgIH0pLmdldCgpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGhlaWdodDsKICAgIH07CiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIGNhbGN1bGF0ZWQgd2lkdGggdG8gYmUgdXNlZCBmb3IgdGhlIG91dGVyIHdyYXBwZXIgLyB2aWV3cG9ydAogICAgICovCgoKICAgIHZhciBnZXRWaWV3cG9ydE1heFdpZHRoID0gZnVuY3Rpb24gZ2V0Vmlld3BvcnRNYXhXaWR0aCgpIHsKICAgICAgdmFyIHdpZHRoID0gJzEwMCUnOwoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoID4gMCkgewogICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAnaG9yaXpvbnRhbCcpIHsKICAgICAgICAgIHdpZHRoID0gc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyAqIHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoICsgKHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMgLSAxKSAqIHNsaWRlci5zZXR0aW5ncy5zbGlkZU1hcmdpbjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgd2lkdGggPSBzbGlkZXIuc2V0dGluZ3Muc2xpZGVXaWR0aDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB3aWR0aDsKICAgIH07CiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIGNhbGN1bGF0ZWQgd2lkdGggdG8gYmUgYXBwbGllZCB0byBlYWNoIHNsaWRlCiAgICAgKi8KCgogICAgdmFyIGdldFNsaWRlV2lkdGggPSBmdW5jdGlvbiBnZXRTbGlkZVdpZHRoKCkgewogICAgICAvLyBzdGFydCB3aXRoIGFueSB1c2VyLXN1cHBsaWVkIHNsaWRlIHdpZHRoCiAgICAgIHZhciBuZXdFbFdpZHRoID0gc2xpZGVyLnNldHRpbmdzLnNsaWRlV2lkdGg7IC8vIGdldCB0aGUgY3VycmVudCB2aWV3cG9ydCB3aWR0aAoKICAgICAgdmFyIHdyYXBXaWR0aCA9IHNsaWRlci52aWV3cG9ydC53aWR0aCgpOyAvLyBpZiBzbGlkZSB3aWR0aCB3YXMgbm90IHN1cHBsaWVkLCBvciBpcyBsYXJnZXIgdGhhbiB0aGUgdmlld3BvcnQgdXNlIHRoZSB2aWV3cG9ydCB3aWR0aAoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoID09IDAgfHwgc2xpZGVyLnNldHRpbmdzLnNsaWRlV2lkdGggPiB3cmFwV2lkdGggJiYgIXNsaWRlci5jYXJvdXNlbCB8fCBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAndmVydGljYWwnKSB7CiAgICAgICAgbmV3RWxXaWR0aCA9IHdyYXBXaWR0aDsgLy8gaWYgY2Fyb3VzZWwsIHVzZSB0aGUgdGhyZXNob2xkcyB0byBkZXRlcm1pbmUgdGhlIHdpZHRoCiAgICAgIH0gZWxzZSBpZiAoc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyA+IDEgJiYgc2xpZGVyLnNldHRpbmdzLm1vZGUgPT0gJ2hvcml6b250YWwnKSB7CiAgICAgICAgaWYgKHdyYXBXaWR0aCA+IHNsaWRlci5tYXhUaHJlc2hvbGQpIHsvLyBuZXdFbFdpZHRoID0gKHdyYXBXaWR0aCAtIChzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4gKiAoc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyAtIDEpKSkgLyBzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzOwogICAgICAgIH0gZWxzZSBpZiAod3JhcFdpZHRoIDwgc2xpZGVyLm1pblRocmVzaG9sZCkgewogICAgICAgICAgbmV3RWxXaWR0aCA9ICh3cmFwV2lkdGggLSBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4gKiAoc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcyAtIDEpKSAvIHNsaWRlci5zZXR0aW5ncy5taW5TbGlkZXM7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbmV3RWxXaWR0aDsKICAgIH07CiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiBzbGlkZXMgY3VycmVudGx5IHZpc2libGUgaW4gdGhlIHZpZXdwb3J0IChpbmNsdWRlcyBwYXJ0aWFsbHkgdmlzaWJsZSBzbGlkZXMpCiAgICAgKi8KCgogICAgdmFyIGdldE51bWJlclNsaWRlc1Nob3dpbmcgPSBmdW5jdGlvbiBnZXROdW1iZXJTbGlkZXNTaG93aW5nKCkgewogICAgICB2YXIgc2xpZGVzU2hvd2luZyA9IDE7CgogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT0gJ2hvcml6b250YWwnICYmIHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoID4gMCkgewogICAgICAgIC8vIGlmIHZpZXdwb3J0IGlzIHNtYWxsZXIgdGhhbiBtaW5UaHJlc2hvbGQsIHJldHVybiBtaW5TbGlkZXMKICAgICAgICBpZiAoc2xpZGVyLnZpZXdwb3J0LndpZHRoKCkgPCBzbGlkZXIubWluVGhyZXNob2xkKSB7CiAgICAgICAgICBzbGlkZXNTaG93aW5nID0gc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlczsgLy8gaWYgdmlld3BvcnQgaXMgbGFyZ2VyIHRoYW4gbWluVGhyZXNob2xkLCByZXR1cm4gbWF4U2xpZGVzCiAgICAgICAgfSBlbHNlIGlmIChzbGlkZXIudmlld3BvcnQud2lkdGgoKSA+IHNsaWRlci5tYXhUaHJlc2hvbGQpIHsKICAgICAgICAgIHNsaWRlc1Nob3dpbmcgPSBzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzOyAvLyBpZiB2aWV3cG9ydCBpcyBiZXR3ZWVuIG1pbiAvIG1heCB0aHJlc2hvbGRzLCBkaXZpZGUgdmlld3BvcnQgd2lkdGggYnkgZmlyc3QgY2hpbGQgd2lkdGgKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIGNoaWxkV2lkdGggPSBzbGlkZXIuY2hpbGRyZW4uZmlyc3QoKS53aWR0aCgpOwogICAgICAgICAgc2xpZGVzU2hvd2luZyA9IE1hdGguZmxvb3Ioc2xpZGVyLnZpZXdwb3J0LndpZHRoKCkgLyBjaGlsZFdpZHRoKTsKICAgICAgICB9IC8vIGlmICJ2ZXJ0aWNhbCIgbW9kZSwgc2xpZGVzIHNob3dpbmcgd2lsbCBhbHdheXMgYmUgbWluU2xpZGVzCgogICAgICB9IGVsc2UgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09ICd2ZXJ0aWNhbCcpIHsKICAgICAgICBzbGlkZXNTaG93aW5nID0gc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlczsKICAgICAgfQoKICAgICAgcmV0dXJuIHNsaWRlc1Nob3dpbmc7CiAgICB9OwogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgcGFnZXMgKG9uZSBmdWxsIHZpZXdwb3J0IG9mIHNsaWRlcyBpcyBvbmUgInBhZ2UiKQogICAgICovCgoKICAgIHZhciBnZXRQYWdlclF0eSA9IGZ1bmN0aW9uIGdldFBhZ2VyUXR5KCkgewogICAgICB2YXIgcGFnZXJRdHkgPSAwOyAvLyBpZiBtb3ZlU2xpZGVzIGlzIHNwZWNpZmllZCBieSB0aGUgdXNlcgoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb3ZlU2xpZGVzID4gMCkgewogICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuaW5maW5pdGVMb29wKSB7CiAgICAgICAgICBwYWdlclF0eSA9IHNsaWRlci5jaGlsZHJlbi5sZW5ndGggLyBnZXRNb3ZlQnkoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gdXNlIGEgd2hpbGUgbG9vcCB0byBkZXRlcm1pbmUgcGFnZXMKICAgICAgICAgIHZhciBicmVha1BvaW50ID0gMDsKICAgICAgICAgIHZhciBjb3VudGVyID0gMDsgLy8gd2hlbiBicmVha3BvaW50IGdvZXMgYWJvdmUgY2hpbGRyZW4gbGVuZ3RoLCBjb3VudGVyIGlzIHRoZSBudW1iZXIgb2YgcGFnZXMKCiAgICAgICAgICB3aGlsZSAoYnJlYWtQb2ludCA8IHNsaWRlci5jaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICAgICAgKytwYWdlclF0eTsKICAgICAgICAgICAgYnJlYWtQb2ludCA9IGNvdW50ZXIgKyBnZXROdW1iZXJTbGlkZXNTaG93aW5nKCk7CiAgICAgICAgICAgIGNvdW50ZXIgKz0gc2xpZGVyLnNldHRpbmdzLm1vdmVTbGlkZXMgPD0gZ2V0TnVtYmVyU2xpZGVzU2hvd2luZygpID8gc2xpZGVyLnNldHRpbmdzLm1vdmVTbGlkZXMgOiBnZXROdW1iZXJTbGlkZXNTaG93aW5nKCk7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBpZiBtb3ZlU2xpZGVzIGlzIDAgKGF1dG8pIGRpdmlkZSBjaGlsZHJlbiBsZW5ndGggYnkgc2lkZXMgc2hvd2luZywgdGhlbiByb3VuZCB1cAoKICAgICAgfSBlbHNlIHsKICAgICAgICBwYWdlclF0eSA9IE1hdGguY2VpbChzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIC8gZ2V0TnVtYmVyU2xpZGVzU2hvd2luZygpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHBhZ2VyUXR5OwogICAgfTsKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIGluZGl2dWFsIHNsaWRlcyBieSB3aGljaCB0byBzaGlmdCB0aGUgc2xpZGVyCiAgICAgKi8KCgogICAgdmFyIGdldE1vdmVCeSA9IGZ1bmN0aW9uIGdldE1vdmVCeSgpIHsKICAgICAgLy8gaWYgbW92ZVNsaWRlcyB3YXMgc2V0IGJ5IHRoZSB1c2VyIGFuZCBtb3ZlU2xpZGVzIGlzIGxlc3MgdGhhbiBudW1iZXIgb2Ygc2xpZGVzIHNob3dpbmcKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb3ZlU2xpZGVzID4gMCAmJiBzbGlkZXIuc2V0dGluZ3MubW92ZVNsaWRlcyA8PSBnZXROdW1iZXJTbGlkZXNTaG93aW5nKCkpIHsKICAgICAgICByZXR1cm4gc2xpZGVyLnNldHRpbmdzLm1vdmVTbGlkZXM7CiAgICAgIH0gLy8gaWYgbW92ZVNsaWRlcyBpcyAwIChhdXRvKQoKCiAgICAgIHJldHVybiBnZXROdW1iZXJTbGlkZXNTaG93aW5nKCk7CiAgICB9OwogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBzbGlkZXIncyAoZWwpIGxlZnQgb3IgdG9wIHBvc2l0aW9uCiAgICAgKi8KCgogICAgdmFyIHNldFNsaWRlUG9zaXRpb24gPSBmdW5jdGlvbiBzZXRTbGlkZVBvc2l0aW9uKCkgewogICAgICAvLyBpZiBsYXN0IHNsaWRlLCBub3QgaW5maW5pdGUgbG9vcCwgYW5kIG51bWJlciBvZiBjaGlsZHJlbiBpcyBsYXJnZXIgdGhhbiBzcGVjaWZpZWQgbWF4U2xpZGVzCiAgICAgIGlmIChzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoID4gc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyAmJiBzbGlkZXIuYWN0aXZlLmxhc3QgJiYgIXNsaWRlci5zZXR0aW5ncy5pbmZpbml0ZUxvb3ApIHsKICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT0gJ2hvcml6b250YWwnKSB7CiAgICAgICAgICAvLyBnZXQgdGhlIGxhc3QgY2hpbGQncyBwb3NpdGlvbgogICAgICAgICAgdmFyIGxhc3RDaGlsZCA9IHNsaWRlci5jaGlsZHJlbi5sYXN0KCk7CiAgICAgICAgICB2YXIgcG9zaXRpb24gPSBsYXN0Q2hpbGQucG9zaXRpb24oKTsgLy8gc2V0IHRoZSBsZWZ0IHBvc2l0aW9uCgogICAgICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eSgtKHBvc2l0aW9uLmxlZnQgLSAoc2xpZGVyLnZpZXdwb3J0LndpZHRoKCkgLSBsYXN0Q2hpbGQud2lkdGgoKSkpLCAncmVzZXQnLCAwKTsKICAgICAgICB9IGVsc2UgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09ICd2ZXJ0aWNhbCcpIHsKICAgICAgICAgIC8vIGdldCB0aGUgbGFzdCBzaG93aW5nIGluZGV4J3MgcG9zaXRpb24KICAgICAgICAgIHZhciBsYXN0U2hvd2luZ0luZGV4ID0gc2xpZGVyLmNoaWxkcmVuLmxlbmd0aCAtIHNsaWRlci5zZXR0aW5ncy5taW5TbGlkZXM7CiAgICAgICAgICB2YXIgcG9zaXRpb24gPSBzbGlkZXIuY2hpbGRyZW4uZXEobGFzdFNob3dpbmdJbmRleCkucG9zaXRpb24oKTsgLy8gc2V0IHRoZSB0b3AgcG9zaXRpb24KCiAgICAgICAgICBzZXRQb3NpdGlvblByb3BlcnR5KC1wb3NpdGlvbi50b3AsICdyZXNldCcsIDApOwogICAgICAgIH0gLy8gaWYgbm90IGxhc3Qgc2xpZGUKCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gZ2V0IHRoZSBwb3NpdGlvbiBvZiB0aGUgZmlyc3Qgc2hvd2luZyBzbGlkZQogICAgICAgIHZhciBwb3NpdGlvbiA9IHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuYWN0aXZlLmluZGV4ICogZ2V0TW92ZUJ5KCkpLnBvc2l0aW9uKCk7IC8vIGNoZWNrIGZvciBsYXN0IHNsaWRlCgogICAgICAgIGlmIChzbGlkZXIuYWN0aXZlLmluZGV4ID09IGdldFBhZ2VyUXR5KCkgLSAxKSBzbGlkZXIuYWN0aXZlLmxhc3QgPSB0cnVlOyAvLyBzZXQgdGhlIHJlcGVjdGl2ZSBwb3NpdGlvbgoKICAgICAgICBpZiAocG9zaXRpb24gIT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT0gJ2hvcml6b250YWwnKSBzZXRQb3NpdGlvblByb3BlcnR5KC1wb3NpdGlvbi5sZWZ0LCAncmVzZXQnLCAwKTtlbHNlIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAndmVydGljYWwnKSBzZXRQb3NpdGlvblByb3BlcnR5KC1wb3NpdGlvbi50b3AsICdyZXNldCcsIDApOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIC8qKgogICAgICogU2V0cyB0aGUgZWwncyBhbmltYXRpbmcgcHJvcGVydHkgcG9zaXRpb24gKHdoaWNoIGluIHR1cm4gd2lsbCBzb21ldGltZXMgYW5pbWF0ZSBlbCkuCiAgICAgKiBJZiB1c2luZyBDU1MsIHNldHMgdGhlIHRyYW5zZm9ybSBwcm9wZXJ0eS4gSWYgbm90IHVzaW5nIENTUywgc2V0cyB0aGUgdG9wIC8gbGVmdCBwcm9wZXJ0eS4KICAgICAqCiAgICAgKiBAcGFyYW0gdmFsdWUgKGludCkKICAgICAqICAtIHRoZSBhbmltYXRpbmcgcHJvcGVydHkncyB2YWx1ZQogICAgICoKICAgICAqIEBwYXJhbSB0eXBlIChzdHJpbmcpICdzbGlkZXInLCAncmVzZXQnLCAndGlja2VyJwogICAgICogIC0gdGhlIHR5cGUgb2YgaW5zdGFuY2UgZm9yIHdoaWNoIHRoZSBmdW5jdGlvbiBpcyBiZWluZwogICAgICoKICAgICAqIEBwYXJhbSBkdXJhdGlvbiAoaW50KQogICAgICogIC0gdGhlIGFtb3VudCBvZiB0aW1lIChpbiBtcykgdGhlIHRyYW5zaXRpb24gc2hvdWxkIG9jY3VweQogICAgICoKICAgICAqIEBwYXJhbSBwYXJhbXMgKGFycmF5KSBvcHRpb25hbAogICAgICogIC0gYW4gb3B0aW9uYWwgcGFyYW1ldGVyIGNvbnRhaW5pbmcgYW55IHZhcmlhYmxlcyB0aGF0IG5lZWQgdG8gYmUgcGFzc2VkIGluCiAgICAgKi8KCgogICAgdmFyIHNldFBvc2l0aW9uUHJvcGVydHkgPSBmdW5jdGlvbiBzZXRQb3NpdGlvblByb3BlcnR5KHZhbHVlLCB0eXBlLCBkdXJhdGlvbiwgcGFyYW1zKSB7CiAgICAgIC8vIHVzZSBDU1MgdHJhbnNmb3JtCiAgICAgIGlmIChzbGlkZXIudXNpbmdDU1MpIHsKICAgICAgICAvLyBkZXRlcm1pbmUgdGhlIHRyYW5zbGF0ZTNkIHZhbHVlCiAgICAgICAgdmFyIHByb3BWYWx1ZSA9IHNsaWRlci5zZXR0aW5ncy5tb2RlID09ICd2ZXJ0aWNhbCcgPyAndHJhbnNsYXRlM2QoMCwgJyArIHZhbHVlICsgJ3B4LCAwKScgOiAndHJhbnNsYXRlM2QoJyArIHZhbHVlICsgJ3B4LCAwLCAwKSc7IC8vIGFkZCB0aGUgQ1NTIHRyYW5zaXRpb24tZHVyYXRpb24KCiAgICAgICAgZWwuY3NzKCctJyArIHNsaWRlci5jc3NQcmVmaXggKyAnLXRyYW5zaXRpb24tZHVyYXRpb24nLCBkdXJhdGlvbiAvIDEwMDAgKyAncycpOwoKICAgICAgICBpZiAodHlwZSA9PSAnc2xpZGUnKSB7CiAgICAgICAgICAvLyBzZXQgdGhlIHByb3BlcnR5IHZhbHVlCiAgICAgICAgICBlbC5jc3Moc2xpZGVyLmFuaW1Qcm9wLCBwcm9wVmFsdWUpOyAvLyBiaW5kIGEgY2FsbGJhY2sgbWV0aG9kIC0gZXhlY3V0ZXMgd2hlbiBDU1MgdHJhbnNpdGlvbiBjb21wbGV0ZXMKCiAgICAgICAgICBlbC5iaW5kKCd0cmFuc2l0aW9uZW5kIHdlYmtpdFRyYW5zaXRpb25FbmQgb1RyYW5zaXRpb25FbmQgTVNUcmFuc2l0aW9uRW5kJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvLyB1bmJpbmQgdGhlIGNhbGxiYWNrCiAgICAgICAgICAgIGVsLnVuYmluZCgndHJhbnNpdGlvbmVuZCB3ZWJraXRUcmFuc2l0aW9uRW5kIG9UcmFuc2l0aW9uRW5kIE1TVHJhbnNpdGlvbkVuZCcpOwogICAgICAgICAgICB1cGRhdGVBZnRlclNsaWRlVHJhbnNpdGlvbigpOwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09ICdyZXNldCcpIHsKICAgICAgICAgIGVsLmNzcyhzbGlkZXIuYW5pbVByb3AsIHByb3BWYWx1ZSk7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09ICd0aWNrZXInKSB7CiAgICAgICAgICAvLyBtYWtlIHRoZSB0cmFuc2l0aW9uIHVzZSAnbGluZWFyJwogICAgICAgICAgZWwuY3NzKCctJyArIHNsaWRlci5jc3NQcmVmaXggKyAnLXRyYW5zaXRpb24tdGltaW5nLWZ1bmN0aW9uJywgJ2xpbmVhcicpOwogICAgICAgICAgZWwuY3NzKHNsaWRlci5hbmltUHJvcCwgcHJvcFZhbHVlKTsgLy8gYmluZCBhIGNhbGxiYWNrIG1ldGhvZCAtIGV4ZWN1dGVzIHdoZW4gQ1NTIHRyYW5zaXRpb24gY29tcGxldGVzCgogICAgICAgICAgZWwuYmluZCgndHJhbnNpdGlvbmVuZCB3ZWJraXRUcmFuc2l0aW9uRW5kIG9UcmFuc2l0aW9uRW5kIE1TVHJhbnNpdGlvbkVuZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgLy8gdW5iaW5kIHRoZSBjYWxsYmFjawogICAgICAgICAgICBlbC51bmJpbmQoJ3RyYW5zaXRpb25lbmQgd2Via2l0VHJhbnNpdGlvbkVuZCBvVHJhbnNpdGlvbkVuZCBNU1RyYW5zaXRpb25FbmQnKTsgLy8gcmVzZXQgdGhlIHBvc2l0aW9uCgogICAgICAgICAgICBzZXRQb3NpdGlvblByb3BlcnR5KHBhcmFtc1sncmVzZXRWYWx1ZSddLCAncmVzZXQnLCAwKTsgLy8gc3RhcnQgdGhlIGxvb3AgYWdhaW4KCiAgICAgICAgICAgIHRpY2tlckxvb3AoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gLy8gdXNlIEpTIGFuaW1hdGUKCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGFuaW1hdGVPYmogPSB7fTsKICAgICAgICBhbmltYXRlT2JqW3NsaWRlci5hbmltUHJvcF0gPSB2YWx1ZTsKCiAgICAgICAgaWYgKHR5cGUgPT0gJ3NsaWRlJykgewogICAgICAgICAgZWwuYW5pbWF0ZShhbmltYXRlT2JqLCBkdXJhdGlvbiwgc2xpZGVyLnNldHRpbmdzLmVhc2luZywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICB1cGRhdGVBZnRlclNsaWRlVHJhbnNpdGlvbigpOwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09ICdyZXNldCcpIHsKICAgICAgICAgIGVsLmNzcyhzbGlkZXIuYW5pbVByb3AsIHZhbHVlKTsKICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gJ3RpY2tlcicpIHsKICAgICAgICAgIGVsLmFuaW1hdGUoYW5pbWF0ZU9iaiwgc3BlZWQsICdsaW5lYXInLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkocGFyYW1zWydyZXNldFZhbHVlJ10sICdyZXNldCcsIDApOyAvLyBydW4gdGhlIHJlY3Vyc2l2ZSBsb29wIGFmdGVyIGFuaW1hdGlvbgoKICAgICAgICAgICAgdGlja2VyTG9vcCgpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgLyoqCiAgICAgKiBQb3B1bGF0ZXMgdGhlIHBhZ2VyIHdpdGggcHJvcGVyIGFtb3VudCBvZiBwYWdlcwogICAgICovCgoKICAgIHZhciBwb3B1bGF0ZVBhZ2VyID0gZnVuY3Rpb24gcG9wdWxhdGVQYWdlcigpIHsKICAgICAgdmFyIHBhZ2VySHRtbCA9ICcnOwogICAgICB2YXIgcGFnZXJRdHkgPSBnZXRQYWdlclF0eSgpOyAvLyBsb29wIHRocm91Z2ggZWFjaCBwYWdlciBpdGVtCgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhZ2VyUXR5OyBpKyspIHsKICAgICAgICB2YXIgbGlua0NvbnRlbnQgPSAnJzsgLy8gaWYgYSBidWlsZFBhZ2VyIGZ1bmN0aW9uIGlzIHN1cHBsaWVkLCB1c2UgaXQgdG8gZ2V0IHBhZ2VyIGxpbmsgdmFsdWUsIGVsc2UgdXNlIGluZGV4ICsgMQoKICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmJ1aWxkUGFnZXIgJiYgJC5pc0Z1bmN0aW9uKHNsaWRlci5zZXR0aW5ncy5idWlsZFBhZ2VyKSkgewogICAgICAgICAgbGlua0NvbnRlbnQgPSBzbGlkZXIuc2V0dGluZ3MuYnVpbGRQYWdlcihpKTsKICAgICAgICAgIHNsaWRlci5wYWdlckVsLmFkZENsYXNzKCdieC1jdXN0b20tcGFnZXInKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbGlua0NvbnRlbnQgPSBpICsgMTsKICAgICAgICAgIHNsaWRlci5wYWdlckVsLmFkZENsYXNzKCdieC1kZWZhdWx0LXBhZ2VyJyk7CiAgICAgICAgfSAvLyB2YXIgbGlua0NvbnRlbnQgPSBzbGlkZXIuc2V0dGluZ3MuYnVpbGRQYWdlciAmJiAkLmlzRnVuY3Rpb24oc2xpZGVyLnNldHRpbmdzLmJ1aWxkUGFnZXIpID8gc2xpZGVyLnNldHRpbmdzLmJ1aWxkUGFnZXIoaSkgOiBpICsgMTsKICAgICAgICAvLyBhZGQgdGhlIG1hcmt1cCB0byB0aGUgc3RyaW5nCgoKICAgICAgICBwYWdlckh0bWwgKz0gJzxkaXYgY2xhc3M9ImJ4LXBhZ2VyLWl0ZW0iPjxhIGhyZWY9IiIgZGF0YS1zbGlkZS1pbmRleD0iJyArIGkgKyAnIiBjbGFzcz0iYngtcGFnZXItbGluayI+JyArIGxpbmtDb250ZW50ICsgJzwvYT48L2Rpdj4nOwogICAgICB9CgogICAgICA7IC8vIHBvcHVsYXRlIHRoZSBwYWdlciBlbGVtZW50IHdpdGggcGFnZXIgbGlua3MKCiAgICAgIHNsaWRlci5wYWdlckVsLmh0bWwocGFnZXJIdG1sKTsKICAgIH07CiAgICAvKioKICAgICAqIEFwcGVuZHMgdGhlIHBhZ2VyIHRvIHRoZSBjb250cm9scyBlbGVtZW50CiAgICAgKi8KCgogICAgdmFyIGFwcGVuZFBhZ2VyID0gZnVuY3Rpb24gYXBwZW5kUGFnZXIoKSB7CiAgICAgIGlmICghc2xpZGVyLnNldHRpbmdzLnBhZ2VyQ3VzdG9tKSB7CiAgICAgICAgLy8gY3JlYXRlIHRoZSBwYWdlciBET00gZWxlbWVudAogICAgICAgIHNsaWRlci5wYWdlckVsID0gJCgnPGRpdiBjbGFzcz0iYngtcGFnZXIiIC8+Jyk7IC8vIGlmIGEgcGFnZXIgc2VsZWN0b3Igd2FzIHN1cHBsaWVkLCBwb3B1bGF0ZSBpdCB3aXRoIHRoZSBwYWdlcgoKICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnBhZ2VyU2VsZWN0b3IpIHsKICAgICAgICAgICQoc2xpZGVyLnNldHRpbmdzLnBhZ2VyU2VsZWN0b3IpLmh0bWwoc2xpZGVyLnBhZ2VyRWwpOyAvLyBpZiBubyBwYWdlciBzZWxlY3RvciB3YXMgc3VwcGxpZWQsIGFkZCBpdCBhZnRlciB0aGUgd3JhcHBlcgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzbGlkZXIuY29udHJvbHMuZWwuYWRkQ2xhc3MoJ2J4LWhhcy1wYWdlcicpLmFwcGVuZChzbGlkZXIucGFnZXJFbCk7CiAgICAgICAgfSAvLyBwb3B1bGF0ZSB0aGUgcGFnZXIKCgogICAgICAgIHBvcHVsYXRlUGFnZXIoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzbGlkZXIucGFnZXJFbCA9ICQoc2xpZGVyLnNldHRpbmdzLnBhZ2VyQ3VzdG9tKTsKICAgICAgfSAvLyBhc3NpZ24gdGhlIHBhZ2VyIGNsaWNrIGJpbmRpbmcKCgogICAgICBzbGlkZXIucGFnZXJFbC5kZWxlZ2F0ZSgnYScsICdjbGljaycsIGNsaWNrUGFnZXJCaW5kKTsKICAgIH07CiAgICAvKioKICAgICAqIEFwcGVuZHMgcHJldiAvIG5leHQgY29udHJvbHMgdG8gdGhlIGNvbnRyb2xzIGVsZW1lbnQKICAgICAqLwoKCiAgICB2YXIgYXBwZW5kQ29udHJvbHMgPSBmdW5jdGlvbiBhcHBlbmRDb250cm9scygpIHsKICAgICAgc2xpZGVyLmNvbnRyb2xzLm5leHQgPSAkKCc8YSBjbGFzcz0iYngtbmV4dCIgaHJlZj0iIj4nICsgc2xpZGVyLnNldHRpbmdzLm5leHRUZXh0ICsgJzwvYT4nKTsKICAgICAgc2xpZGVyLmNvbnRyb2xzLnByZXYgPSAkKCc8YSBjbGFzcz0iYngtcHJldiIgaHJlZj0iIj4nICsgc2xpZGVyLnNldHRpbmdzLnByZXZUZXh0ICsgJzwvYT4nKTsgLy8gYmluZCBjbGljayBhY3Rpb25zIHRvIHRoZSBjb250cm9scwoKICAgICAgc2xpZGVyLmNvbnRyb2xzLm5leHQuYmluZCgnY2xpY2snLCBjbGlja05leHRCaW5kKTsKICAgICAgc2xpZGVyLmNvbnRyb2xzLnByZXYuYmluZCgnY2xpY2snLCBjbGlja1ByZXZCaW5kKTsgLy8gaWYgbmV4dFNsZWN0b3Igd2FzIHN1cHBsaWVkLCBwb3B1bGF0ZSBpdAoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5uZXh0U2VsZWN0b3IpIHsKICAgICAgICAkKHNsaWRlci5zZXR0aW5ncy5uZXh0U2VsZWN0b3IpLmFwcGVuZChzbGlkZXIuY29udHJvbHMubmV4dCk7CiAgICAgIH0gLy8gaWYgcHJldlNsZWN0b3Igd2FzIHN1cHBsaWVkLCBwb3B1bGF0ZSBpdAoKCiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MucHJldlNlbGVjdG9yKSB7CiAgICAgICAgJChzbGlkZXIuc2V0dGluZ3MucHJldlNlbGVjdG9yKS5hcHBlbmQoc2xpZGVyLmNvbnRyb2xzLnByZXYpOwogICAgICB9IC8vIGlmIG5vIGN1c3RvbSBzZWxlY3RvcnMgd2VyZSBzdXBwbGllZAoKCiAgICAgIGlmICghc2xpZGVyLnNldHRpbmdzLm5leHRTZWxlY3RvciAmJiAhc2xpZGVyLnNldHRpbmdzLnByZXZTZWxlY3RvcikgewogICAgICAgIC8vIGFkZCB0aGUgY29udHJvbHMgdG8gdGhlIERPTQogICAgICAgIHNsaWRlci5jb250cm9scy5kaXJlY3Rpb25FbCA9ICQoJzxkaXYgY2xhc3M9ImJ4LWNvbnRyb2xzLWRpcmVjdGlvbiIgLz4nKTsgLy8gYWRkIHRoZSBjb250cm9sIGVsZW1lbnRzIHRvIHRoZSBkaXJlY3Rpb25FbAoKICAgICAgICBzbGlkZXIuY29udHJvbHMuZGlyZWN0aW9uRWwuYXBwZW5kKHNsaWRlci5jb250cm9scy5wcmV2KS5hcHBlbmQoc2xpZGVyLmNvbnRyb2xzLm5leHQpOyAvLyBzbGlkZXIudmlld3BvcnQuYXBwZW5kKHNsaWRlci5jb250cm9scy5kaXJlY3Rpb25FbCk7CgogICAgICAgIHNsaWRlci5jb250cm9scy5lbC5hZGRDbGFzcygnYngtaGFzLWNvbnRyb2xzLWRpcmVjdGlvbicpLmFwcGVuZChzbGlkZXIuY29udHJvbHMuZGlyZWN0aW9uRWwpOwogICAgICB9CiAgICB9OwogICAgLyoqCiAgICAgKiBBcHBlbmRzIHN0YXJ0IC8gc3RvcCBhdXRvIGNvbnRyb2xzIHRvIHRoZSBjb250cm9scyBlbGVtZW50CiAgICAgKi8KCgogICAgdmFyIGFwcGVuZENvbnRyb2xzQXV0byA9IGZ1bmN0aW9uIGFwcGVuZENvbnRyb2xzQXV0bygpIHsKICAgICAgc2xpZGVyLmNvbnRyb2xzLnN0YXJ0ID0gJCgnPGRpdiBjbGFzcz0iYngtY29udHJvbHMtYXV0by1pdGVtIj48YSBjbGFzcz0iYngtc3RhcnQiIGhyZWY9IiI+JyArIHNsaWRlci5zZXR0aW5ncy5zdGFydFRleHQgKyAnPC9hPjwvZGl2PicpOwogICAgICBzbGlkZXIuY29udHJvbHMuc3RvcCA9ICQoJzxkaXYgY2xhc3M9ImJ4LWNvbnRyb2xzLWF1dG8taXRlbSI+PGEgY2xhc3M9ImJ4LXN0b3AiIGhyZWY9IiI+JyArIHNsaWRlci5zZXR0aW5ncy5zdG9wVGV4dCArICc8L2E+PC9kaXY+Jyk7IC8vIGFkZCB0aGUgY29udHJvbHMgdG8gdGhlIERPTQoKICAgICAgc2xpZGVyLmNvbnRyb2xzLmF1dG9FbCA9ICQoJzxkaXYgY2xhc3M9ImJ4LWNvbnRyb2xzLWF1dG8iIC8+Jyk7IC8vIGJpbmQgY2xpY2sgYWN0aW9ucyB0byB0aGUgY29udHJvbHMKCiAgICAgIHNsaWRlci5jb250cm9scy5hdXRvRWwuZGVsZWdhdGUoJy5ieC1zdGFydCcsICdjbGljaycsIGNsaWNrU3RhcnRCaW5kKTsKICAgICAgc2xpZGVyLmNvbnRyb2xzLmF1dG9FbC5kZWxlZ2F0ZSgnLmJ4LXN0b3AnLCAnY2xpY2snLCBjbGlja1N0b3BCaW5kKTsgLy8gaWYgYXV0b0NvbnRyb2xzQ29tYmluZSwgaW5zZXJ0IG9ubHkgdGhlICJzdGFydCIgY29udHJvbAoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvQ29udHJvbHNDb21iaW5lKSB7CiAgICAgICAgc2xpZGVyLmNvbnRyb2xzLmF1dG9FbC5hcHBlbmQoc2xpZGVyLmNvbnRyb2xzLnN0YXJ0KTsgLy8gaWYgYXV0b0NvbnRyb2xzQ29tYmluZSBpcyBmYWxzZSwgaW5zZXJ0IGJvdGggY29udHJvbHMKICAgICAgfSBlbHNlIHsKICAgICAgICBzbGlkZXIuY29udHJvbHMuYXV0b0VsLmFwcGVuZChzbGlkZXIuY29udHJvbHMuc3RhcnQpLmFwcGVuZChzbGlkZXIuY29udHJvbHMuc3RvcCk7CiAgICAgIH0gLy8gaWYgYXV0byBjb250cm9scyBzZWxlY3RvciB3YXMgc3VwcGxpZWQsIHBvcHVsYXRlIGl0IHdpdGggdGhlIGNvbnRyb2xzCgoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvQ29udHJvbHNTZWxlY3RvcikgewogICAgICAgICQoc2xpZGVyLnNldHRpbmdzLmF1dG9Db250cm9sc1NlbGVjdG9yKS5odG1sKHNsaWRlci5jb250cm9scy5hdXRvRWwpOyAvLyBpZiBhdXRvIGNvbnRyb2xzIHNlbGVjdG9yIHdhcyBub3Qgc3VwcGxpZWQsIGFkZCBpdCBhZnRlciB0aGUgd3JhcHBlcgogICAgICB9IGVsc2UgewogICAgICAgIHNsaWRlci5jb250cm9scy5lbC5hZGRDbGFzcygnYngtaGFzLWNvbnRyb2xzLWF1dG8nKS5hcHBlbmQoc2xpZGVyLmNvbnRyb2xzLmF1dG9FbCk7CiAgICAgIH0gLy8gdXBkYXRlIHRoZSBhdXRvIGNvbnRyb2xzCgoKICAgICAgdXBkYXRlQXV0b0NvbnRyb2xzKHNsaWRlci5zZXR0aW5ncy5hdXRvU3RhcnQgPyAnc3RvcCcgOiAnc3RhcnQnKTsKICAgIH07CiAgICAvKioKICAgICAqIEFwcGVuZHMgaW1hZ2UgY2FwdGlvbnMgdG8gdGhlIERPTQogICAgICovCgoKICAgIHZhciBhcHBlbmRDYXB0aW9ucyA9IGZ1bmN0aW9uIGFwcGVuZENhcHRpb25zKCkgewogICAgICAvLyBjeWNsZSB0aHJvdWdoIGVhY2ggY2hpbGQKICAgICAgc2xpZGVyLmNoaWxkcmVuLmVhY2goZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgICAgLy8gZ2V0IHRoZSBpbWFnZSB0aXRsZSBhdHRyaWJ1dGUKICAgICAgICB2YXIgdGl0bGUgPSAkKHRoaXMpLmZpbmQoJ2ltZzpmaXJzdCcpLmF0dHIoJ3RpdGxlJyk7IC8vIGFwcGVuZCB0aGUgY2FwdGlvbgoKICAgICAgICBpZiAodGl0bGUgIT0gdW5kZWZpbmVkICYmICgnJyArIHRpdGxlKS5sZW5ndGgpIHsKICAgICAgICAgICQodGhpcykuYXBwZW5kKCc8ZGl2IGNsYXNzPSJieC1jYXB0aW9uIj48c3Bhbj4nICsgdGl0bGUgKyAnPC9zcGFuPjwvZGl2PicpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogICAgLyoqCiAgICAgKiBDbGljayBuZXh0IGJpbmRpbmcKICAgICAqCiAgICAgKiBAcGFyYW0gZSAoZXZlbnQpCiAgICAgKiAgLSBET00gZXZlbnQgb2JqZWN0CiAgICAgKi8KCgogICAgdmFyIGNsaWNrTmV4dEJpbmQgPSBmdW5jdGlvbiBjbGlja05leHRCaW5kKGUpIHsKICAgICAgLy8gaWYgYXV0byBzaG93IGlzIHJ1bm5pbmcsIHN0b3AgaXQKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvKSBlbC5zdG9wQXV0bygpOwogICAgICBlbC5nb1RvTmV4dFNsaWRlKCk7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIH07CiAgICAvKioKICAgICAqIENsaWNrIHByZXYgYmluZGluZwogICAgICoKICAgICAqIEBwYXJhbSBlIChldmVudCkKICAgICAqICAtIERPTSBldmVudCBvYmplY3QKICAgICAqLwoKCiAgICB2YXIgY2xpY2tQcmV2QmluZCA9IGZ1bmN0aW9uIGNsaWNrUHJldkJpbmQoZSkgewogICAgICAvLyBpZiBhdXRvIHNob3cgaXMgcnVubmluZywgc3RvcCBpdAogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG8pIGVsLnN0b3BBdXRvKCk7CiAgICAgIGVsLmdvVG9QcmV2U2xpZGUoKTsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgfTsKICAgIC8qKgogICAgICogQ2xpY2sgc3RhcnQgYmluZGluZwogICAgICoKICAgICAqIEBwYXJhbSBlIChldmVudCkKICAgICAqICAtIERPTSBldmVudCBvYmplY3QKICAgICAqLwoKCiAgICB2YXIgY2xpY2tTdGFydEJpbmQgPSBmdW5jdGlvbiBjbGlja1N0YXJ0QmluZChlKSB7CiAgICAgIGVsLnN0YXJ0QXV0bygpOwogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICB9OwogICAgLyoqCiAgICAgKiBDbGljayBzdG9wIGJpbmRpbmcKICAgICAqCiAgICAgKiBAcGFyYW0gZSAoZXZlbnQpCiAgICAgKiAgLSBET00gZXZlbnQgb2JqZWN0CiAgICAgKi8KCgogICAgdmFyIGNsaWNrU3RvcEJpbmQgPSBmdW5jdGlvbiBjbGlja1N0b3BCaW5kKGUpIHsKICAgICAgZWwuc3RvcEF1dG8oKTsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgfTsKICAgIC8qKgogICAgICogQ2xpY2sgcGFnZXIgYmluZGluZwogICAgICoKICAgICAqIEBwYXJhbSBlIChldmVudCkKICAgICAqICAtIERPTSBldmVudCBvYmplY3QKICAgICAqLwoKCiAgICB2YXIgY2xpY2tQYWdlckJpbmQgPSBmdW5jdGlvbiBjbGlja1BhZ2VyQmluZChlKSB7CiAgICAgIC8vIGlmIGF1dG8gc2hvdyBpcyBydW5uaW5nLCBzdG9wIGl0CiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXV0bykgZWwuc3RvcEF1dG8oKTsKICAgICAgdmFyIHBhZ2VyTGluayA9ICQoZS5jdXJyZW50VGFyZ2V0KTsKICAgICAgdmFyIHBhZ2VySW5kZXggPSBwYXJzZUludChwYWdlckxpbmsuYXR0cignZGF0YS1zbGlkZS1pbmRleCcpKTsgLy8gaWYgY2xpY2tlZCBwYWdlciBsaW5rIGlzIG5vdCBhY3RpdmUsIGNvbnRpbnVlIHdpdGggdGhlIGdvVG9TbGlkZSBjYWxsCgogICAgICBpZiAocGFnZXJJbmRleCAhPSBzbGlkZXIuYWN0aXZlLmluZGV4KSBlbC5nb1RvU2xpZGUocGFnZXJJbmRleCk7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIH07CiAgICAvKioKICAgICAqIFVwZGF0ZXMgdGhlIHBhZ2VyIGxpbmtzIHdpdGggYW4gYWN0aXZlIGNsYXNzCiAgICAgKgogICAgICogQHBhcmFtIHNsaWRlSW5kZXggKGludCkKICAgICAqICAtIGluZGV4IG9mIHNsaWRlIHRvIG1ha2UgYWN0aXZlCiAgICAgKi8KCgogICAgdmFyIHVwZGF0ZVBhZ2VyQWN0aXZlID0gZnVuY3Rpb24gdXBkYXRlUGFnZXJBY3RpdmUoc2xpZGVJbmRleCkgewogICAgICAvLyBpZiAic2hvcnQiIHBhZ2VyIHR5cGUKICAgICAgdmFyIGxlbiA9IHNsaWRlci5jaGlsZHJlbi5sZW5ndGg7IC8vIG5iIG9mIGNoaWxkcmVuCgogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnBhZ2VyVHlwZSA9PSAnc2hvcnQnKSB7CiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMgPiAxKSB7CiAgICAgICAgICBsZW4gPSBNYXRoLmNlaWwoc2xpZGVyLmNoaWxkcmVuLmxlbmd0aCAvIHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMpOwogICAgICAgIH0KCiAgICAgICAgc2xpZGVyLnBhZ2VyRWwuaHRtbChzbGlkZUluZGV4ICsgMSArIHNsaWRlci5zZXR0aW5ncy5wYWdlclNob3J0U2VwYXJhdG9yICsgbGVuKTsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gcmVtb3ZlIGFsbCBwYWdlciBhY3RpdmUgY2xhc3NlcwoKCiAgICAgIHNsaWRlci5wYWdlckVsLmZpbmQoJ2EnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7IC8vIGFwcGx5IHRoZSBhY3RpdmUgY2xhc3MgZm9yIGFsbCBwYWdlcnMKCiAgICAgIHNsaWRlci5wYWdlckVsLmVhY2goZnVuY3Rpb24gKGksIGVsKSB7CiAgICAgICAgJChlbCkuZmluZCgnYScpLmVxKHNsaWRlSW5kZXgpLmFkZENsYXNzKCdhY3RpdmUnKTsKICAgICAgfSk7CiAgICB9OwogICAgLyoqCiAgICAgKiBQZXJmb3JtcyBuZWVkZWQgYWN0aW9ucyBhZnRlciBhIHNsaWRlIHRyYW5zaXRpb24KICAgICAqLwoKCiAgICB2YXIgdXBkYXRlQWZ0ZXJTbGlkZVRyYW5zaXRpb24gPSBmdW5jdGlvbiB1cGRhdGVBZnRlclNsaWRlVHJhbnNpdGlvbigpIHsKICAgICAgLy8gaWYgaW5maW50ZSBsb29wIGlzIHRydWUKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5pbmZpbml0ZUxvb3ApIHsKICAgICAgICB2YXIgcG9zaXRpb24gPSAnJzsgLy8gZmlyc3Qgc2xpZGUKCiAgICAgICAgaWYgKHNsaWRlci5hY3RpdmUuaW5kZXggPT0gMCkgewogICAgICAgICAgLy8gc2V0IHRoZSBuZXcgcG9zaXRpb24KICAgICAgICAgIHBvc2l0aW9uID0gc2xpZGVyLmNoaWxkcmVuLmVxKDApLnBvc2l0aW9uKCk7IC8vIGNhcm91c2VsLCBsYXN0IHNsaWRlCiAgICAgICAgfSBlbHNlIGlmIChzbGlkZXIuYWN0aXZlLmluZGV4ID09IGdldFBhZ2VyUXR5KCkgLSAxICYmIHNsaWRlci5jYXJvdXNlbCkgewogICAgICAgICAgcG9zaXRpb24gPSBzbGlkZXIuY2hpbGRyZW4uZXEoKGdldFBhZ2VyUXR5KCkgLSAxKSAqIGdldE1vdmVCeSgpKS5wb3NpdGlvbigpOyAvLyBsYXN0IHNsaWRlCiAgICAgICAgfSBlbHNlIGlmIChzbGlkZXIuYWN0aXZlLmluZGV4ID09IHNsaWRlci5jaGlsZHJlbi5sZW5ndGggLSAxKSB7CiAgICAgICAgICBwb3NpdGlvbiA9IHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIC0gMSkucG9zaXRpb24oKTsKICAgICAgICB9CgogICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAnaG9yaXpvbnRhbCcpIHsKICAgICAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkoLXBvc2l0aW9uLmxlZnQsICdyZXNldCcsIDApOwogICAgICAgICAgOwogICAgICAgIH0gZWxzZSBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT0gJ3ZlcnRpY2FsJykgewogICAgICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eSgtcG9zaXRpb24udG9wLCAncmVzZXQnLCAwKTsKICAgICAgICAgIDsKICAgICAgICB9CiAgICAgIH0gLy8gZGVjbGFyZSB0aGF0IHRoZSB0cmFuc2l0aW9uIGlzIGNvbXBsZXRlCgoKICAgICAgc2xpZGVyLndvcmtpbmcgPSBmYWxzZTsgLy8gb25TbGlkZUFmdGVyIGNhbGxiYWNrCgogICAgICBzbGlkZXIuc2V0dGluZ3Mub25TbGlkZUFmdGVyKHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuYWN0aXZlLmluZGV4KSwgc2xpZGVyLm9sZEluZGV4LCBzbGlkZXIuYWN0aXZlLmluZGV4KTsKICAgIH07CiAgICAvKioKICAgICAqIFVwZGF0ZXMgdGhlIGF1dG8gY29udHJvbHMgc3RhdGUgKGVpdGhlciBhY3RpdmUsIG9yIGNvbWJpbmVkIHN3aXRjaCkKICAgICAqCiAgICAgKiBAcGFyYW0gc3RhdGUgKHN0cmluZykgInN0YXJ0IiwgInN0b3AiCiAgICAgKiAgLSB0aGUgbmV3IHN0YXRlIG9mIHRoZSBhdXRvIHNob3cKICAgICAqLwoKCiAgICB2YXIgdXBkYXRlQXV0b0NvbnRyb2xzID0gZnVuY3Rpb24gdXBkYXRlQXV0b0NvbnRyb2xzKHN0YXRlKSB7CiAgICAgIC8vIGlmIGF1dG9Db250cm9sc0NvbWJpbmUgaXMgdHJ1ZSwgcmVwbGFjZSB0aGUgY3VycmVudCBjb250cm9sIHdpdGggdGhlIG5ldyBzdGF0ZQogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG9Db250cm9sc0NvbWJpbmUpIHsKICAgICAgICBzbGlkZXIuY29udHJvbHMuYXV0b0VsLmh0bWwoc2xpZGVyLmNvbnRyb2xzW3N0YXRlXSk7IC8vIGlmIGF1dG9Db250cm9sc0NvbWJpbmUgaXMgZmFsc2UsIGFwcGx5IHRoZSAiYWN0aXZlIiBjbGFzcyB0byB0aGUgYXBwcm9wcmlhdGUgY29udHJvbAogICAgICB9IGVsc2UgewogICAgICAgIHNsaWRlci5jb250cm9scy5hdXRvRWwuZmluZCgnYScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTsKICAgICAgICBzbGlkZXIuY29udHJvbHMuYXV0b0VsLmZpbmQoJ2E6bm90KC5ieC0nICsgc3RhdGUgKyAnKScpLmFkZENsYXNzKCdhY3RpdmUnKTsKICAgICAgfQogICAgfTsKICAgIC8qKgogICAgICogVXBkYXRlcyB0aGUgZGlyZWN0aW9uIGNvbnRyb2xzIChjaGVja3MgaWYgZWl0aGVyIHNob3VsZCBiZSBoaWRkZW4pCiAgICAgKi8KCgogICAgdmFyIHVwZGF0ZURpcmVjdGlvbkNvbnRyb2xzID0gZnVuY3Rpb24gdXBkYXRlRGlyZWN0aW9uQ29udHJvbHMoKSB7CiAgICAgIGlmIChnZXRQYWdlclF0eSgpID09IDEpIHsKICAgICAgICBzbGlkZXIuY29udHJvbHMucHJldi5hZGRDbGFzcygnZGlzYWJsZWQnKTsKICAgICAgICBzbGlkZXIuY29udHJvbHMubmV4dC5hZGRDbGFzcygnZGlzYWJsZWQnKTsKICAgICAgfSBlbHNlIGlmICghc2xpZGVyLnNldHRpbmdzLmluZmluaXRlTG9vcCAmJiBzbGlkZXIuc2V0dGluZ3MuaGlkZUNvbnRyb2xPbkVuZCkgewogICAgICAgIC8vIGlmIGZpcnN0IHNsaWRlCiAgICAgICAgaWYgKHNsaWRlci5hY3RpdmUuaW5kZXggPT0gMCkgewogICAgICAgICAgc2xpZGVyLmNvbnRyb2xzLnByZXYuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7CiAgICAgICAgICBzbGlkZXIuY29udHJvbHMubmV4dC5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTsgLy8gaWYgbGFzdCBzbGlkZQogICAgICAgIH0gZWxzZSBpZiAoc2xpZGVyLmFjdGl2ZS5pbmRleCA9PSBnZXRQYWdlclF0eSgpIC0gMSkgewogICAgICAgICAgc2xpZGVyLmNvbnRyb2xzLm5leHQuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7CiAgICAgICAgICBzbGlkZXIuY29udHJvbHMucHJldi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTsgLy8gaWYgYW55IHNsaWRlIGluIHRoZSBtaWRkbGUKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2xpZGVyLmNvbnRyb2xzLnByZXYucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7CiAgICAgICAgICBzbGlkZXIuY29udHJvbHMubmV4dC5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICAvKioKICAgICAqIEluaXRpYWx6ZXMgdGhlIGF1dG8gcHJvY2VzcwogICAgICovCgoKICAgIHZhciBpbml0QXV0byA9IGZ1bmN0aW9uIGluaXRBdXRvKCkgewogICAgICAvLyBpZiBhdXRvRGVsYXkgd2FzIHN1cHBsaWVkLCBsYXVuY2ggdGhlIGF1dG8gc2hvdyB1c2luZyBhIHNldFRpbWVvdXQoKSBjYWxsCiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXV0b0RlbGF5ID4gMCkgewogICAgICAgIHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChlbC5zdGFydEF1dG8sIHNsaWRlci5zZXR0aW5ncy5hdXRvRGVsYXkpOyAvLyBpZiBhdXRvRGVsYXkgd2FzIG5vdCBzdXBwbGllZCwgc3RhcnQgdGhlIGF1dG8gc2hvdyBub3JtYWxseQogICAgICB9IGVsc2UgewogICAgICAgIGVsLnN0YXJ0QXV0bygpOwogICAgICB9IC8vIGlmIGF1dG9Ib3ZlciBpcyByZXF1ZXN0ZWQKCgogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG9Ib3ZlcikgewogICAgICAgIC8vIG9uIGVsIGhvdmVyCiAgICAgICAgZWwuaG92ZXIoZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gaWYgdGhlIGF1dG8gc2hvdyBpcyBjdXJyZW50bHkgcGxheWluZyAoaGFzIGFuIGFjdGl2ZSBpbnRlcnZhbCkKICAgICAgICAgIGlmIChzbGlkZXIuaW50ZXJ2YWwpIHsKICAgICAgICAgICAgLy8gc3RvcCB0aGUgYXV0byBzaG93IGFuZCBwYXNzIHRydWUgYWd1bWVudCB3aGljaCB3aWxsIHByZXZlbnQgY29udHJvbCB1cGRhdGUKICAgICAgICAgICAgZWwuc3RvcEF1dG8odHJ1ZSk7IC8vIGNyZWF0ZSBhIG5ldyBhdXRvUGF1c2VkIHZhbHVlIHdoaWNoIHdpbGwgYmUgdXNlZCBieSB0aGUgcmVsYXRpdmUgIm1vdXNlb3V0IiBldmVudAoKICAgICAgICAgICAgc2xpZGVyLmF1dG9QYXVzZWQgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIGlmIHRoZSBhdXRvUGF1c2VkIHZhbHVlIHdhcyBjcmVhdGVkIGJlIHRoZSBwcmlvciAibW91c2VvdmVyIiBldmVudAogICAgICAgICAgaWYgKHNsaWRlci5hdXRvUGF1c2VkKSB7CiAgICAgICAgICAgIC8vIHN0YXJ0IHRoZSBhdXRvIHNob3cgYW5kIHBhc3MgdHJ1ZSBhZ3VtZW50IHdoaWNoIHdpbGwgcHJldmVudCBjb250cm9sIHVwZGF0ZQogICAgICAgICAgICBlbC5zdGFydEF1dG8odHJ1ZSk7IC8vIHJlc2V0IHRoZSBhdXRvUGF1c2VkIHZhbHVlCgogICAgICAgICAgICBzbGlkZXIuYXV0b1BhdXNlZCA9IG51bGw7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH07CiAgICAvKioKICAgICAqIEluaXRpYWx6ZXMgdGhlIHRpY2tlciBwcm9jZXNzCiAgICAgKi8KCgogICAgdmFyIGluaXRUaWNrZXIgPSBmdW5jdGlvbiBpbml0VGlja2VyKCkgewogICAgICB2YXIgc3RhcnRQb3NpdGlvbiA9IDA7IC8vIGlmIGF1dG9EaXJlY3Rpb24gaXMgIm5leHQiLCBhcHBlbmQgYSBjbG9uZSBvZiB0aGUgZW50aXJlIHNsaWRlcgoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvRGlyZWN0aW9uID09ICduZXh0JykgewogICAgICAgIGVsLmFwcGVuZChzbGlkZXIuY2hpbGRyZW4uY2xvbmUoKS5hZGRDbGFzcygnYngtY2xvbmUnKSk7IC8vIGlmIGF1dG9EaXJlY3Rpb24gaXMgInByZXYiLCBwcmVwZW5kIGEgY2xvbmUgb2YgdGhlIGVudGlyZSBzbGlkZXIsIGFuZCBzZXQgdGhlIGxlZnQgcG9zaXRpb24KICAgICAgfSBlbHNlIHsKICAgICAgICBlbC5wcmVwZW5kKHNsaWRlci5jaGlsZHJlbi5jbG9uZSgpLmFkZENsYXNzKCdieC1jbG9uZScpKTsKICAgICAgICB2YXIgcG9zaXRpb24gPSBzbGlkZXIuY2hpbGRyZW4uZmlyc3QoKS5wb3NpdGlvbigpOwogICAgICAgIHN0YXJ0UG9zaXRpb24gPSBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAnaG9yaXpvbnRhbCcgPyAtcG9zaXRpb24ubGVmdCA6IC1wb3NpdGlvbi50b3A7CiAgICAgIH0KCiAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkoc3RhcnRQb3NpdGlvbiwgJ3Jlc2V0JywgMCk7IC8vIGRvIG5vdCBhbGxvdyBjb250cm9scyBpbiB0aWNrZXIgbW9kZQoKICAgICAgc2xpZGVyLnNldHRpbmdzLnBhZ2VyID0gZmFsc2U7CiAgICAgIHNsaWRlci5zZXR0aW5ncy5jb250cm9scyA9IGZhbHNlOwogICAgICBzbGlkZXIuc2V0dGluZ3MuYXV0b0NvbnRyb2xzID0gZmFsc2U7IC8vIGlmIGF1dG9Ib3ZlciBpcyByZXF1ZXN0ZWQKCiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MudGlja2VySG92ZXIgJiYgIXNsaWRlci51c2luZ0NTUykgewogICAgICAgIC8vIG9uIGVsIGhvdmVyCiAgICAgICAgc2xpZGVyLnZpZXdwb3J0LmhvdmVyKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGVsLnN0b3AoKTsKICAgICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIHRvdGFsIHdpZHRoIG9mIGNoaWxkcmVuICh1c2VkIHRvIGNhbGN1bGF0ZSB0aGUgc3BlZWQgcmF0aW8pCiAgICAgICAgICB2YXIgdG90YWxEaW1lbnMgPSAwOwogICAgICAgICAgc2xpZGVyLmNoaWxkcmVuLmVhY2goZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgICAgICAgIHRvdGFsRGltZW5zICs9IHNsaWRlci5zZXR0aW5ncy5tb2RlID09ICdob3Jpem9udGFsJyA/ICQodGhpcykub3V0ZXJXaWR0aCh0cnVlKSA6ICQodGhpcykub3V0ZXJIZWlnaHQodHJ1ZSk7CiAgICAgICAgICB9KTsgLy8gY2FsY3VsYXRlIHRoZSBzcGVlZCByYXRpbyAodXNlZCB0byBkZXRlcm1pbmUgdGhlIG5ldyBzcGVlZCB0byBmaW5pc2ggdGhlIHBhdXNlZCBhbmltYXRpb24pCgogICAgICAgICAgdmFyIHJhdGlvID0gc2xpZGVyLnNldHRpbmdzLnNwZWVkIC8gdG90YWxEaW1lbnM7IC8vIGRldGVybWluZSB3aGljaCBwcm9wZXJ0eSB0byB1c2UKCiAgICAgICAgICB2YXIgcHJvcGVydHkgPSBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAnaG9yaXpvbnRhbCcgPyAnbGVmdCcgOiAndG9wJzsgLy8gY2FsY3VsYXRlIHRoZSBuZXcgc3BlZWQKCiAgICAgICAgICB2YXIgbmV3U3BlZWQgPSByYXRpbyAqICh0b3RhbERpbWVucyAtIE1hdGguYWJzKHBhcnNlSW50KGVsLmNzcyhwcm9wZXJ0eSkpKSk7CiAgICAgICAgICB0aWNrZXJMb29wKG5ld1NwZWVkKTsKICAgICAgICB9KTsKICAgICAgfSAvLyBzdGFydCB0aGUgdGlja2VyIGxvb3AKCgogICAgICB0aWNrZXJMb29wKCk7CiAgICB9OwogICAgLyoqCiAgICAgKiBSdW5zIGEgY29udGludW91cyBsb29wLCBuZXdzIHRpY2tlci1zdHlsZQogICAgICovCgoKICAgIHZhciB0aWNrZXJMb29wID0gZnVuY3Rpb24gdGlja2VyTG9vcChyZXN1bWVTcGVlZCkgewogICAgICBzcGVlZCA9IHJlc3VtZVNwZWVkID8gcmVzdW1lU3BlZWQgOiBzbGlkZXIuc2V0dGluZ3Muc3BlZWQ7CiAgICAgIHZhciBwb3NpdGlvbiA9IHsKICAgICAgICBsZWZ0OiAwLAogICAgICAgIHRvcDogMAogICAgICB9OwogICAgICB2YXIgcmVzZXQgPSB7CiAgICAgICAgbGVmdDogMCwKICAgICAgICB0b3A6IDAKICAgICAgfTsgLy8gaWYgIm5leHQiIGFuaW1hdGUgbGVmdCBwb3NpdGlvbiB0byBsYXN0IGNoaWxkLCB0aGVuIHJlc2V0IGxlZnQgdG8gMAoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvRGlyZWN0aW9uID09ICduZXh0JykgewogICAgICAgIHBvc2l0aW9uID0gZWwuZmluZCgnLmJ4LWNsb25lJykuZmlyc3QoKS5wb3NpdGlvbigpOyAvLyBpZiAicHJldiIgYW5pbWF0ZSBsZWZ0IHBvc2l0aW9uIHRvIDAsIHRoZW4gcmVzZXQgbGVmdCB0byBmaXJzdCBub24tY2xvbmUgY2hpbGQKICAgICAgfSBlbHNlIHsKICAgICAgICByZXNldCA9IHNsaWRlci5jaGlsZHJlbi5maXJzdCgpLnBvc2l0aW9uKCk7CiAgICAgIH0KCiAgICAgIHZhciBhbmltYXRlUHJvcGVydHkgPSBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAnaG9yaXpvbnRhbCcgPyAtcG9zaXRpb24ubGVmdCA6IC1wb3NpdGlvbi50b3A7CiAgICAgIHZhciByZXNldFZhbHVlID0gc2xpZGVyLnNldHRpbmdzLm1vZGUgPT0gJ2hvcml6b250YWwnID8gLXJlc2V0LmxlZnQgOiAtcmVzZXQudG9wOwogICAgICB2YXIgcGFyYW1zID0gewogICAgICAgIHJlc2V0VmFsdWU6IHJlc2V0VmFsdWUKICAgICAgfTsKICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eShhbmltYXRlUHJvcGVydHksICd0aWNrZXInLCBzcGVlZCwgcGFyYW1zKTsKICAgIH07CiAgICAvKioKICAgICAqIEluaXRpYWxpemVzIHRvdWNoIGV2ZW50cwogICAgICovCgoKICAgIHZhciBpbml0VG91Y2ggPSBmdW5jdGlvbiBpbml0VG91Y2goKSB7CiAgICAgIC8vIGluaXRpYWxpemUgb2JqZWN0IHRvIGNvbnRhaW4gYWxsIHRvdWNoIHZhbHVlcwogICAgICBzbGlkZXIudG91Y2ggPSB7CiAgICAgICAgc3RhcnQ6IHsKICAgICAgICAgIHg6IDAsCiAgICAgICAgICB5OiAwCiAgICAgICAgfSwKICAgICAgICBlbmQ6IHsKICAgICAgICAgIHg6IDAsCiAgICAgICAgICB5OiAwCiAgICAgICAgfQogICAgICB9OwogICAgICBzbGlkZXIudmlld3BvcnQuYmluZCgndG91Y2hzdGFydCcsIG9uVG91Y2hTdGFydCk7CiAgICB9OwogICAgLyoqCiAgICAgKiBFdmVudCBoYW5kbGVyIGZvciAidG91Y2hzdGFydCIKICAgICAqCiAgICAgKiBAcGFyYW0gZSAoZXZlbnQpCiAgICAgKiAgLSBET00gZXZlbnQgb2JqZWN0CiAgICAgKi8KCgogICAgdmFyIG9uVG91Y2hTdGFydCA9IGZ1bmN0aW9uIG9uVG91Y2hTdGFydChlKSB7CiAgICAgIGlmIChzbGlkZXIud29ya2luZykgewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyByZWNvcmQgdGhlIG9yaWdpbmFsIHBvc2l0aW9uIHdoZW4gdG91Y2ggc3RhcnRzCiAgICAgICAgc2xpZGVyLnRvdWNoLm9yaWdpbmFsUG9zID0gZWwucG9zaXRpb24oKTsKICAgICAgICB2YXIgb3JpZyA9IGUub3JpZ2luYWxFdmVudDsgLy8gcmVjb3JkIHRoZSBzdGFydGluZyB0b3VjaCB4LCB5IGNvb3JkaW5hdGVzCgogICAgICAgIHNsaWRlci50b3VjaC5zdGFydC54ID0gb3JpZy5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWDsKICAgICAgICBzbGlkZXIudG91Y2guc3RhcnQueSA9IG9yaWcuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVk7IC8vIGJpbmQgYSAidG91Y2htb3ZlIiBldmVudCB0byB0aGUgdmlld3BvcnQKCiAgICAgICAgc2xpZGVyLnZpZXdwb3J0LmJpbmQoJ3RvdWNobW92ZScsIG9uVG91Y2hNb3ZlKTsgLy8gYmluZCBhICJ0b3VjaGVuZCIgZXZlbnQgdG8gdGhlIHZpZXdwb3J0CgogICAgICAgIHNsaWRlci52aWV3cG9ydC5iaW5kKCd0b3VjaGVuZCcsIG9uVG91Y2hFbmQpOwogICAgICB9CiAgICB9OwogICAgLyoqCiAgICAgKiBFdmVudCBoYW5kbGVyIGZvciAidG91Y2htb3ZlIgogICAgICoKICAgICAqIEBwYXJhbSBlIChldmVudCkKICAgICAqICAtIERPTSBldmVudCBvYmplY3QKICAgICAqLwoKCiAgICB2YXIgb25Ub3VjaE1vdmUgPSBmdW5jdGlvbiBvblRvdWNoTW92ZShlKSB7CiAgICAgIHZhciBvcmlnID0gZS5vcmlnaW5hbEV2ZW50OyAvLyBpZiBzY3JvbGxpbmcgb24geSBheGlzLCBkbyBub3QgcHJldmVudCBkZWZhdWx0CgogICAgICB2YXIgeE1vdmVtZW50ID0gTWF0aC5hYnMob3JpZy5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWCAtIHNsaWRlci50b3VjaC5zdGFydC54KTsKICAgICAgdmFyIHlNb3ZlbWVudCA9IE1hdGguYWJzKG9yaWcuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVkgLSBzbGlkZXIudG91Y2guc3RhcnQueSk7IC8vIHggYXhpcyBzd2lwZQoKICAgICAgaWYgKHhNb3ZlbWVudCAqIDMgPiB5TW92ZW1lbnQgJiYgc2xpZGVyLnNldHRpbmdzLnByZXZlbnREZWZhdWx0U3dpcGVYKSB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOyAvLyB5IGF4aXMgc3dpcGUKICAgICAgfSBlbHNlIGlmICh5TW92ZW1lbnQgKiAzID4geE1vdmVtZW50ICYmIHNsaWRlci5zZXR0aW5ncy5wcmV2ZW50RGVmYXVsdFN3aXBlWSkgewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgfQoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlICE9ICdmYWRlJyAmJiBzbGlkZXIuc2V0dGluZ3Mub25lVG9PbmVUb3VjaCkgewogICAgICAgIHZhciB2YWx1ZSA9IDA7IC8vIGlmIGhvcml6b250YWwsIGRyYWcgYWxvbmcgeCBheGlzCgogICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PSAnaG9yaXpvbnRhbCcpIHsKICAgICAgICAgIHZhciBjaGFuZ2UgPSBvcmlnLmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VYIC0gc2xpZGVyLnRvdWNoLnN0YXJ0Lng7CiAgICAgICAgICB2YWx1ZSA9IHNsaWRlci50b3VjaC5vcmlnaW5hbFBvcy5sZWZ0ICsgY2hhbmdlOyAvLyBpZiB2ZXJ0aWNhbCwgZHJhZyBhbG9uZyB5IGF4aXMKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIGNoYW5nZSA9IG9yaWcuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVkgLSBzbGlkZXIudG91Y2guc3RhcnQueTsKICAgICAgICAgIHZhbHVlID0gc2xpZGVyLnRvdWNoLm9yaWdpbmFsUG9zLnRvcCArIGNoYW5nZTsKICAgICAgICB9CgogICAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkodmFsdWUsICdyZXNldCcsIDApOwogICAgICB9CiAgICB9OwogICAgLyoqCiAgICAgKiBFdmVudCBoYW5kbGVyIGZvciAidG91Y2hlbmQiCiAgICAgKgogICAgICogQHBhcmFtIGUgKGV2ZW50KQogICAgICogIC0gRE9NIGV2ZW50IG9iamVjdAogICAgICovCgoKICAgIHZhciBvblRvdWNoRW5kID0gZnVuY3Rpb24gb25Ub3VjaEVuZChlKSB7CiAgICAgIHNsaWRlci52aWV3cG9ydC51bmJpbmQoJ3RvdWNobW92ZScsIG9uVG91Y2hNb3ZlKTsKICAgICAgdmFyIG9yaWcgPSBlLm9yaWdpbmFsRXZlbnQ7CiAgICAgIHZhciB2YWx1ZSA9IDA7IC8vIHJlY29yZCBlbmQgeCwgeSBwb3NpdGlvbnMKCiAgICAgIHNsaWRlci50b3VjaC5lbmQueCA9IG9yaWcuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVg7CiAgICAgIHNsaWRlci50b3VjaC5lbmQueSA9IG9yaWcuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVk7IC8vIGlmIGZhZGUgbW9kZSwgY2hlY2sgaWYgYWJzb2x1dGUgeCBkaXN0YW5jZSBjbGVhcnMgdGhlIHRocmVzaG9sZAoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09ICdmYWRlJykgewogICAgICAgIHZhciBkaXN0YW5jZSA9IE1hdGguYWJzKHNsaWRlci50b3VjaC5zdGFydC54IC0gc2xpZGVyLnRvdWNoLmVuZC54KTsKCiAgICAgICAgaWYgKGRpc3RhbmNlID49IHNsaWRlci5zZXR0aW5ncy5zd2lwZVRocmVzaG9sZCkgewogICAgICAgICAgc2xpZGVyLnRvdWNoLnN0YXJ0LnggPiBzbGlkZXIudG91Y2guZW5kLnggPyBlbC5nb1RvTmV4dFNsaWRlKCkgOiBlbC5nb1RvUHJldlNsaWRlKCk7CiAgICAgICAgICBlbC5zdG9wQXV0bygpOwogICAgICAgIH0gLy8gbm90IGZhZGUgbW9kZQoKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgZGlzdGFuY2UgPSAwOyAvLyBjYWxjdWxhdGUgZGlzdGFuY2UgYW5kIGVsJ3MgYW5pbWF0ZSBwcm9wZXJ0eQoKICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT0gJ2hvcml6b250YWwnKSB7CiAgICAgICAgICBkaXN0YW5jZSA9IHNsaWRlci50b3VjaC5lbmQueCAtIHNsaWRlci50b3VjaC5zdGFydC54OwogICAgICAgICAgdmFsdWUgPSBzbGlkZXIudG91Y2gub3JpZ2luYWxQb3MubGVmdDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZGlzdGFuY2UgPSBzbGlkZXIudG91Y2guZW5kLnkgLSBzbGlkZXIudG91Y2guc3RhcnQueTsKICAgICAgICAgIHZhbHVlID0gc2xpZGVyLnRvdWNoLm9yaWdpbmFsUG9zLnRvcDsKICAgICAgICB9IC8vIGlmIG5vdCBpbmZpbml0ZSBsb29wIGFuZCBmaXJzdCAvIGxhc3Qgc2xpZGUsIGRvIG5vdCBhdHRlbXB0IGEgc2xpZGUgdHJhbnNpdGlvbgoKCiAgICAgICAgaWYgKCFzbGlkZXIuc2V0dGluZ3MuaW5maW5pdGVMb29wICYmIChzbGlkZXIuYWN0aXZlLmluZGV4ID09IDAgJiYgZGlzdGFuY2UgPiAwIHx8IHNsaWRlci5hY3RpdmUubGFzdCAmJiBkaXN0YW5jZSA8IDApKSB7CiAgICAgICAgICBzZXRQb3NpdGlvblByb3BlcnR5KHZhbHVlLCAncmVzZXQnLCAyMDApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBjaGVjayBpZiBkaXN0YW5jZSBjbGVhcnMgdGhyZXNob2xkCiAgICAgICAgICBpZiAoTWF0aC5hYnMoZGlzdGFuY2UpID49IHNsaWRlci5zZXR0aW5ncy5zd2lwZVRocmVzaG9sZCkgewogICAgICAgICAgICBkaXN0YW5jZSA8IDAgPyBlbC5nb1RvTmV4dFNsaWRlKCkgOiBlbC5nb1RvUHJldlNsaWRlKCk7CiAgICAgICAgICAgIGVsLnN0b3BBdXRvKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBlbC5hbmltYXRlKHByb3BlcnR5LCAyMDApOwogICAgICAgICAgICBzZXRQb3NpdGlvblByb3BlcnR5KHZhbHVlLCAncmVzZXQnLCAyMDApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgc2xpZGVyLnZpZXdwb3J0LnVuYmluZCgndG91Y2hlbmQnLCBvblRvdWNoRW5kKTsKICAgIH07CiAgICAvKioKICAgICAqIFdpbmRvdyByZXNpemUgZXZlbnQgY2FsbGJhY2sKICAgICAqLwoKCiAgICB2YXIgcmVzaXplV2luZG93ID0gZnVuY3Rpb24gcmVzaXplV2luZG93KGUpIHsKICAgICAgLy8gZ2V0IHRoZSBuZXcgd2luZG93IGRpbWVucyAoYWdhaW4sIHRoYW5rIHlvdSBJRSkKICAgICAgdmFyIHdpbmRvd1dpZHRoTmV3ID0gJCh3aW5kb3cpLndpZHRoKCk7CiAgICAgIHZhciB3aW5kb3dIZWlnaHROZXcgPSAkKHdpbmRvdykuaGVpZ2h0KCk7IC8vIG1ha2Ugc3VyZSB0aGF0IGl0IGlzIGEgdHJ1ZSB3aW5kb3cgcmVzaXplCiAgICAgIC8vICp3ZSBtdXN0IGNoZWNrIHRoaXMgYmVjYXVzZSBvdXIgZGlub3NhdXIgZnJpZW5kIElFIGZpcmVzIGEgd2luZG93IHJlc2l6ZSBldmVudCB3aGVuIGNlcnRhaW4gRE9NIGVsZW1lbnRzCiAgICAgIC8vIGFyZSByZXNpemVkLiBDYW4geW91IGp1c3QgZGllIGFscmVhZHk/KgoKICAgICAgaWYgKHdpbmRvd1dpZHRoICE9IHdpbmRvd1dpZHRoTmV3IHx8IHdpbmRvd0hlaWdodCAhPSB3aW5kb3dIZWlnaHROZXcpIHsKICAgICAgICAvLyBzZXQgdGhlIG5ldyB3aW5kb3cgZGltZW5zCiAgICAgICAgd2luZG93V2lkdGggPSB3aW5kb3dXaWR0aE5ldzsKICAgICAgICB3aW5kb3dIZWlnaHQgPSB3aW5kb3dIZWlnaHROZXc7IC8vIHVwZGF0ZSBhbGwgZHluYW1pYyBlbGVtZW50cwoKICAgICAgICBlbC5yZWRyYXdTbGlkZXIoKTsKICAgICAgfQogICAgfTsKICAgIC8qKgogICAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAqID0gUFVCTElDIEZVTkNUSU9OUwogICAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAqLwoKICAgIC8qKgogICAgICogUGVyZm9ybXMgc2xpZGUgdHJhbnNpdGlvbiB0byB0aGUgc3BlY2lmaWVkIHNsaWRlCiAgICAgKgogICAgICogQHBhcmFtIHNsaWRlSW5kZXggKGludCkKICAgICAqICAtIHRoZSBkZXN0aW5hdGlvbiBzbGlkZSdzIGluZGV4ICh6ZXJvLWJhc2VkKQogICAgICoKICAgICAqIEBwYXJhbSBkaXJlY3Rpb24gKHN0cmluZykKICAgICAqICAtIElOVEVSTkFMIFVTRSBPTkxZIC0gdGhlIGRpcmVjdGlvbiBvZiB0cmF2ZWwgKCJwcmV2IiAvICJuZXh0IikKICAgICAqLwoKCiAgICBlbC5nb1RvU2xpZGUgPSBmdW5jdGlvbiAoc2xpZGVJbmRleCwgZGlyZWN0aW9uKSB7CiAgICAgIC8vIGlmIHBsdWdpbiBpcyBjdXJyZW50bHkgaW4gbW90aW9uLCBpZ25vcmUgcmVxdWVzdAogICAgICBpZiAoc2xpZGVyLndvcmtpbmcgfHwgc2xpZGVyLmFjdGl2ZS5pbmRleCA9PSBzbGlkZUluZGV4KSByZXR1cm47IC8vIGRlY2xhcmUgdGhhdCBwbHVnaW4gaXMgaW4gbW90aW9uCgogICAgICBzbGlkZXIud29ya2luZyA9IHRydWU7IC8vIHN0b3JlIHRoZSBvbGQgaW5kZXgKCiAgICAgIHNsaWRlci5vbGRJbmRleCA9IHNsaWRlci5hY3RpdmUuaW5kZXg7IC8vIGlmIHNsaWRlSW5kZXggaXMgbGVzcyB0aGFuIHplcm8sIHNldCBhY3RpdmUgaW5kZXggdG8gbGFzdCBjaGlsZCAodGhpcyBoYXBwZW5zIGR1cmluZyBpbmZpbml0ZSBsb29wKQoKICAgICAgaWYgKHNsaWRlSW5kZXggPCAwKSB7CiAgICAgICAgc2xpZGVyLmFjdGl2ZS5pbmRleCA9IGdldFBhZ2VyUXR5KCkgLSAxOyAvLyBpZiBzbGlkZUluZGV4IGlzIGdyZWF0ZXIgdGhhbiBjaGlsZHJlbiBsZW5ndGgsIHNldCBhY3RpdmUgaW5kZXggdG8gMCAodGhpcyBoYXBwZW5zIGR1cmluZyBpbmZpbml0ZSBsb29wKQogICAgICB9IGVsc2UgaWYgKHNsaWRlSW5kZXggPj0gZ2V0UGFnZXJRdHkoKSkgewogICAgICAgIHNsaWRlci5hY3RpdmUuaW5kZXggPSAwOyAvLyBzZXQgYWN0aXZlIGluZGV4IHRvIHJlcXVlc3RlZCBzbGlkZQogICAgICB9IGVsc2UgewogICAgICAgIHNsaWRlci5hY3RpdmUuaW5kZXggPSBzbGlkZUluZGV4OwogICAgICB9IC8vIG9uU2xpZGVCZWZvcmUsIG9uU2xpZGVOZXh0LCBvblNsaWRlUHJldiBjYWxsYmFja3MKCgogICAgICBzbGlkZXIuc2V0dGluZ3Mub25TbGlkZUJlZm9yZShzbGlkZXIuY2hpbGRyZW4uZXEoc2xpZGVyLmFjdGl2ZS5pbmRleCksIHNsaWRlci5vbGRJbmRleCwgc2xpZGVyLmFjdGl2ZS5pbmRleCk7CgogICAgICBpZiAoZGlyZWN0aW9uID09ICduZXh0JykgewogICAgICAgIHNsaWRlci5zZXR0aW5ncy5vblNsaWRlTmV4dChzbGlkZXIuY2hpbGRyZW4uZXEoc2xpZGVyLmFjdGl2ZS5pbmRleCksIHNsaWRlci5vbGRJbmRleCwgc2xpZGVyLmFjdGl2ZS5pbmRleCk7CiAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09ICdwcmV2JykgewogICAgICAgIHNsaWRlci5zZXR0aW5ncy5vblNsaWRlUHJldihzbGlkZXIuY2hpbGRyZW4uZXEoc2xpZGVyLmFjdGl2ZS5pbmRleCksIHNsaWRlci5vbGRJbmRleCwgc2xpZGVyLmFjdGl2ZS5pbmRleCk7CiAgICAgIH0gLy8gY2hlY2sgaWYgbGFzdCBzbGlkZQoKCiAgICAgIHNsaWRlci5hY3RpdmUubGFzdCA9IHNsaWRlci5hY3RpdmUuaW5kZXggPj0gZ2V0UGFnZXJRdHkoKSAtIDE7IC8vIHVwZGF0ZSB0aGUgcGFnZXIgd2l0aCBhY3RpdmUgY2xhc3MKCiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MucGFnZXIpIHVwZGF0ZVBhZ2VyQWN0aXZlKHNsaWRlci5hY3RpdmUuaW5kZXgpOyAvLyAvLyBjaGVjayBmb3IgZGlyZWN0aW9uIGNvbnRyb2wgdXBkYXRlCgogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmNvbnRyb2xzKSB1cGRhdGVEaXJlY3Rpb25Db250cm9scygpOyAvLyBpZiBzbGlkZXIgaXMgc2V0IHRvIG1vZGU6ICJmYWRlIgoKICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09ICdmYWRlJykgewogICAgICAgIC8vIGlmIGFkYXB0aXZlSGVpZ2h0IGlzIHRydWUgYW5kIG5leHQgaGVpZ2h0IGlzIGRpZmZlcmVudCBmcm9tIGN1cnJlbnQgaGVpZ2h0LCBhbmltYXRlIHRvIHRoZSBuZXcgaGVpZ2h0CiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hZGFwdGl2ZUhlaWdodCAmJiBzbGlkZXIudmlld3BvcnQuaGVpZ2h0KCkgIT0gZ2V0Vmlld3BvcnRIZWlnaHQoKSkgewogICAgICAgICAgc2xpZGVyLnZpZXdwb3J0LmFuaW1hdGUoewogICAgICAgICAgICBoZWlnaHQ6IGdldFZpZXdwb3J0SGVpZ2h0KCkKICAgICAgICAgIH0sIHNsaWRlci5zZXR0aW5ncy5hZGFwdGl2ZUhlaWdodFNwZWVkKTsKICAgICAgICB9IC8vIGZhZGUgb3V0IHRoZSB2aXNpYmxlIGNoaWxkIGFuZCByZXNldCBpdHMgei1pbmRleCB2YWx1ZQoKCiAgICAgICAgc2xpZGVyLmNoaWxkcmVuLmZpbHRlcignOnZpc2libGUnKS5mYWRlT3V0KHNsaWRlci5zZXR0aW5ncy5zcGVlZCkuY3NzKHsKICAgICAgICAgIHpJbmRleDogMAogICAgICAgIH0pOyAvLyBmYWRlIGluIHRoZSBuZXdseSByZXF1ZXN0ZWQgc2xpZGUKCiAgICAgICAgc2xpZGVyLmNoaWxkcmVuLmVxKHNsaWRlci5hY3RpdmUuaW5kZXgpLmNzcygnekluZGV4JywgNTEpLmZhZGVJbihzbGlkZXIuc2V0dGluZ3Muc3BlZWQsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICQodGhpcykuY3NzKCd6SW5kZXgnLCA1MCk7CiAgICAgICAgICB1cGRhdGVBZnRlclNsaWRlVHJhbnNpdGlvbigpOwogICAgICAgIH0pOyAvLyBzbGlkZXIgbW9kZSBpcyBub3QgImZhZGUiCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gaWYgYWRhcHRpdmVIZWlnaHQgaXMgdHJ1ZSBhbmQgbmV4dCBoZWlnaHQgaXMgZGlmZmVyZW50IGZyb20gY3VycmVudCBoZWlnaHQsIGFuaW1hdGUgdG8gdGhlIG5ldyBoZWlnaHQKICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmFkYXB0aXZlSGVpZ2h0ICYmIHNsaWRlci52aWV3cG9ydC5oZWlnaHQoKSAhPSBnZXRWaWV3cG9ydEhlaWdodCgpKSB7CiAgICAgICAgICBzbGlkZXIudmlld3BvcnQuYW5pbWF0ZSh7CiAgICAgICAgICAgIGhlaWdodDogZ2V0Vmlld3BvcnRIZWlnaHQoKQogICAgICAgICAgfSwgc2xpZGVyLnNldHRpbmdzLmFkYXB0aXZlSGVpZ2h0U3BlZWQpOwogICAgICAgIH0KCiAgICAgICAgdmFyIG1vdmVCeSA9IDA7CiAgICAgICAgdmFyIHBvc2l0aW9uID0gewogICAgICAgICAgbGVmdDogMCwKICAgICAgICAgIHRvcDogMAogICAgICAgIH07IC8vIGlmIGNhcm91c2VsIGFuZCBub3QgaW5maW5pdGUgbG9vcAoKICAgICAgICBpZiAoIXNsaWRlci5zZXR0aW5ncy5pbmZpbml0ZUxvb3AgJiYgc2xpZGVyLmNhcm91c2VsICYmIHNsaWRlci5hY3RpdmUubGFzdCkgewogICAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09ICdob3Jpem9udGFsJykgewogICAgICAgICAgICAvLyBnZXQgdGhlIGxhc3QgY2hpbGQgcG9zaXRpb24KICAgICAgICAgICAgdmFyIGxhc3RDaGlsZCA9IHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIC0gMSk7CiAgICAgICAgICAgIHBvc2l0aW9uID0gbGFzdENoaWxkLnBvc2l0aW9uKCk7IC8vIGNhbGN1bGF0ZSB0aGUgcG9zaXRpb24gb2YgdGhlIGxhc3Qgc2xpZGUKCiAgICAgICAgICAgIG1vdmVCeSA9IHNsaWRlci52aWV3cG9ydC53aWR0aCgpIC0gbGFzdENoaWxkLm91dGVyV2lkdGgoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGdldCBsYXN0IHNob3dpbmcgaW5kZXggcG9zaXRpb24KICAgICAgICAgICAgdmFyIGxhc3RTaG93aW5nSW5kZXggPSBzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIC0gc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlczsKICAgICAgICAgICAgcG9zaXRpb24gPSBzbGlkZXIuY2hpbGRyZW4uZXEobGFzdFNob3dpbmdJbmRleCkucG9zaXRpb24oKTsKICAgICAgICAgIH0gLy8gaG9yaXpvbnRhbCBjYXJvdXNlbCwgZ29pbmcgcHJldmlvdXMgd2hpbGUgb24gZmlyc3Qgc2xpZGUgKGluZmluaXRlTG9vcCBtb2RlKQoKICAgICAgICB9IGVsc2UgaWYgKHNsaWRlci5jYXJvdXNlbCAmJiBzbGlkZXIuYWN0aXZlLmxhc3QgJiYgZGlyZWN0aW9uID09ICdwcmV2JykgewogICAgICAgICAgLy8gZ2V0IHRoZSBsYXN0IGNoaWxkIHBvc2l0aW9uCiAgICAgICAgICB2YXIgZXEgPSBzbGlkZXIuc2V0dGluZ3MubW92ZVNsaWRlcyA9PSAxID8gc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyAtIGdldE1vdmVCeSgpIDogKGdldFBhZ2VyUXR5KCkgLSAxKSAqIGdldE1vdmVCeSgpIC0gKHNsaWRlci5jaGlsZHJlbi5sZW5ndGggLSBzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzKTsKICAgICAgICAgIHZhciBsYXN0Q2hpbGQgPSBlbC5jaGlsZHJlbignLmJ4LWNsb25lJykuZXEoZXEpOwogICAgICAgICAgcG9zaXRpb24gPSBsYXN0Q2hpbGQucG9zaXRpb24oKTsgLy8gaWYgaW5maW5pdGUgbG9vcCBhbmQgIk5leHQiIGlzIGNsaWNrZWQgb24gdGhlIGxhc3Qgc2xpZGUKICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PSAnbmV4dCcgJiYgc2xpZGVyLmFjdGl2ZS5pbmRleCA9PSAwKSB7CiAgICAgICAgICAvLyBnZXQgdGhlIGxhc3QgY2xvbmUgcG9zaXRpb24KICAgICAgICAgIHBvc2l0aW9uID0gZWwuZmluZCgnPiAuYngtY2xvbmUnKS5lcShzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzKS5wb3NpdGlvbigpOwogICAgICAgICAgc2xpZGVyLmFjdGl2ZS5sYXN0ID0gZmFsc2U7IC8vIG5vcm1hbCBub24temVybyByZXF1ZXN0cwogICAgICAgIH0gZWxzZSBpZiAoc2xpZGVJbmRleCA+PSAwKSB7CiAgICAgICAgICB2YXIgcmVxdWVzdEVsID0gc2xpZGVJbmRleCAqIGdldE1vdmVCeSgpOwogICAgICAgICAgcG9zaXRpb24gPSBzbGlkZXIuY2hpbGRyZW4uZXEocmVxdWVzdEVsKS5wb3NpdGlvbigpOwogICAgICAgIH0KICAgICAgICAvKiBJZiB0aGUgcG9zaXRpb24gZG9lc24ndCBleGlzdAogICAgICAgICAqIChlLmcuIGlmIHlvdSBkZXN0cm95IHRoZSBzbGlkZXIgb24gYSBuZXh0IGNsaWNrKSwKICAgICAgICAgKiBpdCBkb2Vzbid0IHRocm93IGFuIGVycm9yLgogICAgICAgICAqLwoKCiAgICAgICAgaWYgKCJ1bmRlZmluZWQiICE9PSB0eXBlb2YgcG9zaXRpb24pIHsKICAgICAgICAgIHZhciB2YWx1ZSA9IHNsaWRlci5zZXR0aW5ncy5tb2RlID09ICdob3Jpem9udGFsJyA/IC0ocG9zaXRpb24ubGVmdCAtIG1vdmVCeSkgOiAtcG9zaXRpb24udG9wOyAvLyBwbHVnaW4gdmFsdWVzIHRvIGJlIGFuaW1hdGVkCgogICAgICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eSh2YWx1ZSwgJ3NsaWRlJywgc2xpZGVyLnNldHRpbmdzLnNwZWVkKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICAvKioKICAgICAqIFRyYW5zaXRpb25zIHRvIHRoZSBuZXh0IHNsaWRlIGluIHRoZSBzaG93CiAgICAgKi8KCgogICAgZWwuZ29Ub05leHRTbGlkZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgLy8gaWYgaW5maW5pdGVMb29wIGlzIGZhbHNlIGFuZCBsYXN0IHBhZ2UgaXMgc2hvd2luZywgZGlzcmVnYXJkIGNhbGwKICAgICAgaWYgKCFzbGlkZXIuc2V0dGluZ3MuaW5maW5pdGVMb29wICYmIHNsaWRlci5hY3RpdmUubGFzdCkgcmV0dXJuOwogICAgICB2YXIgcGFnZXJJbmRleCA9IHBhcnNlSW50KHNsaWRlci5hY3RpdmUuaW5kZXgpICsgMTsKICAgICAgZWwuZ29Ub1NsaWRlKHBhZ2VySW5kZXgsICduZXh0Jyk7CiAgICB9OwogICAgLyoqCiAgICAgKiBUcmFuc2l0aW9ucyB0byB0aGUgcHJldiBzbGlkZSBpbiB0aGUgc2hvdwogICAgICovCgoKICAgIGVsLmdvVG9QcmV2U2xpZGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIGlmIGluZmluaXRlTG9vcCBpcyBmYWxzZSBhbmQgbGFzdCBwYWdlIGlzIHNob3dpbmcsIGRpc3JlZ2FyZCBjYWxsCiAgICAgIGlmICghc2xpZGVyLnNldHRpbmdzLmluZmluaXRlTG9vcCAmJiBzbGlkZXIuYWN0aXZlLmluZGV4ID09IDApIHJldHVybjsKICAgICAgdmFyIHBhZ2VySW5kZXggPSBwYXJzZUludChzbGlkZXIuYWN0aXZlLmluZGV4KSAtIDE7CiAgICAgIGVsLmdvVG9TbGlkZShwYWdlckluZGV4LCAncHJldicpOwogICAgfTsKICAgIC8qKgogICAgICogU3RhcnRzIHRoZSBhdXRvIHNob3cKICAgICAqCiAgICAgKiBAcGFyYW0gcHJldmVudENvbnRyb2xVcGRhdGUgKGJvb2xlYW4pCiAgICAgKiAgLSBpZiB0cnVlLCBhdXRvIGNvbnRyb2xzIHN0YXRlIHdpbGwgbm90IGJlIHVwZGF0ZWQKICAgICAqLwoKCiAgICBlbC5zdGFydEF1dG8gPSBmdW5jdGlvbiAocHJldmVudENvbnRyb2xVcGRhdGUpIHsKICAgICAgLy8gaWYgYW4gaW50ZXJ2YWwgYWxyZWFkeSBleGlzdHMsIGRpc3JlZ2FyZCBjYWxsCiAgICAgIGlmIChzbGlkZXIuaW50ZXJ2YWwpIHJldHVybjsgLy8gY3JlYXRlIGFuIGludGVydmFsCgogICAgICBzbGlkZXIuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgc2xpZGVyLnNldHRpbmdzLmF1dG9EaXJlY3Rpb24gPT0gJ25leHQnID8gZWwuZ29Ub05leHRTbGlkZSgpIDogZWwuZ29Ub1ByZXZTbGlkZSgpOwogICAgICB9LCBzbGlkZXIuc2V0dGluZ3MucGF1c2UpOyAvLyBpZiBhdXRvIGNvbnRyb2xzIGFyZSBkaXNwbGF5ZWQgYW5kIHByZXZlbnRDb250cm9sVXBkYXRlIGlzIG5vdCB0cnVlCgogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG9Db250cm9scyAmJiBwcmV2ZW50Q29udHJvbFVwZGF0ZSAhPSB0cnVlKSB1cGRhdGVBdXRvQ29udHJvbHMoJ3N0b3AnKTsKICAgIH07CiAgICAvKioKICAgICAqIFN0b3BzIHRoZSBhdXRvIHNob3cKICAgICAqCiAgICAgKiBAcGFyYW0gcHJldmVudENvbnRyb2xVcGRhdGUgKGJvb2xlYW4pCiAgICAgKiAgLSBpZiB0cnVlLCBhdXRvIGNvbnRyb2xzIHN0YXRlIHdpbGwgbm90IGJlIHVwZGF0ZWQKICAgICAqLwoKCiAgICBlbC5zdG9wQXV0byA9IGZ1bmN0aW9uIChwcmV2ZW50Q29udHJvbFVwZGF0ZSkgewogICAgICAvLyBpZiBubyBpbnRlcnZhbCBleGlzdHMsIGRpc3JlZ2FyZCBjYWxsCiAgICAgIGlmICghc2xpZGVyLmludGVydmFsKSByZXR1cm47IC8vIGNsZWFyIHRoZSBpbnRlcnZhbAoKICAgICAgY2xlYXJJbnRlcnZhbChzbGlkZXIuaW50ZXJ2YWwpOwogICAgICBzbGlkZXIuaW50ZXJ2YWwgPSBudWxsOyAvLyBpZiBhdXRvIGNvbnRyb2xzIGFyZSBkaXNwbGF5ZWQgYW5kIHByZXZlbnRDb250cm9sVXBkYXRlIGlzIG5vdCB0cnVlCgogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG9Db250cm9scyAmJiBwcmV2ZW50Q29udHJvbFVwZGF0ZSAhPSB0cnVlKSB1cGRhdGVBdXRvQ29udHJvbHMoJ3N0YXJ0Jyk7CiAgICB9OwogICAgLyoqCiAgICAgKiBSZXR1cm5zIGN1cnJlbnQgc2xpZGUgaW5kZXggKHplcm8tYmFzZWQpCiAgICAgKi8KCgogICAgZWwuZ2V0Q3VycmVudFNsaWRlID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gc2xpZGVyLmFjdGl2ZS5pbmRleDsKICAgIH07CiAgICAvKioKICAgICAqIFJldHVybnMgbnVtYmVyIG9mIHNsaWRlcyBpbiBzaG93CiAgICAgKi8KCgogICAgZWwuZ2V0U2xpZGVDb3VudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHNsaWRlci5jaGlsZHJlbi5sZW5ndGg7CiAgICB9OwogICAgLyoqCiAgICAgKiBVcGRhdGUgYWxsIGR5bmFtaWMgc2xpZGVyIGVsZW1lbnRzCiAgICAgKi8KCgogICAgZWwucmVkcmF3U2xpZGVyID0gZnVuY3Rpb24gKCkgewogICAgICAvLyByZXNpemUgYWxsIGNoaWxkcmVuIGluIHJhdGlvIHRvIG5ldyBzY3JlZW4gc2l6ZQogICAgICBzbGlkZXIuY2hpbGRyZW4uYWRkKGVsLmZpbmQoJy5ieC1jbG9uZScpKS5vdXRlcldpZHRoKGdldFNsaWRlV2lkdGgoKSk7IC8vIGFkanVzdCB0aGUgaGVpZ2h0CgogICAgICBzbGlkZXIudmlld3BvcnQuY3NzKCdoZWlnaHQnLCBnZXRWaWV3cG9ydEhlaWdodCgpKTsgLy8gdXBkYXRlIHRoZSBzbGlkZSBwb3NpdGlvbgoKICAgICAgaWYgKCFzbGlkZXIuc2V0dGluZ3MudGlja2VyKSBzZXRTbGlkZVBvc2l0aW9uKCk7IC8vIGlmIGFjdGl2ZS5sYXN0IHdhcyB0cnVlIGJlZm9yZSB0aGUgc2NyZWVuIHJlc2l6ZSwgd2Ugd2FudAogICAgICAvLyB0byBrZWVwIGl0IGxhc3Qgbm8gbWF0dGVyIHdoYXQgc2NyZWVuIHNpemUgd2UgZW5kIG9uCgogICAgICBpZiAoc2xpZGVyLmFjdGl2ZS5sYXN0KSBzbGlkZXIuYWN0aXZlLmluZGV4ID0gZ2V0UGFnZXJRdHkoKSAtIDE7IC8vIGlmIHRoZSBhY3RpdmUgaW5kZXggKHBhZ2UpIG5vIGxvbmdlciBleGlzdHMgZHVlIHRvIHRoZSByZXNpemUsIHNpbXBseSBzZXQgdGhlIGluZGV4IGFzIGxhc3QKCiAgICAgIGlmIChzbGlkZXIuYWN0aXZlLmluZGV4ID49IGdldFBhZ2VyUXR5KCkpIHNsaWRlci5hY3RpdmUubGFzdCA9IHRydWU7IC8vIGlmIGEgcGFnZXIgaXMgYmVpbmcgZGlzcGxheWVkIGFuZCBhIGN1c3RvbSBwYWdlciBpcyBub3QgYmVpbmcgdXNlZCwgdXBkYXRlIGl0CgogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnBhZ2VyICYmICFzbGlkZXIuc2V0dGluZ3MucGFnZXJDdXN0b20pIHsKICAgICAgICBwb3B1bGF0ZVBhZ2VyKCk7CiAgICAgICAgdXBkYXRlUGFnZXJBY3RpdmUoc2xpZGVyLmFjdGl2ZS5pbmRleCk7CiAgICAgIH0KICAgIH07CiAgICAvKioKICAgICAqIERlc3Ryb3kgdGhlIGN1cnJlbnQgaW5zdGFuY2Ugb2YgdGhlIHNsaWRlciAocmV2ZXJ0IGV2ZXJ5dGhpbmcgYmFjayB0byBvcmlnaW5hbCBzdGF0ZSkKICAgICAqLwoKCiAgICBlbC5kZXN0cm95U2xpZGVyID0gZnVuY3Rpb24gKCkgewogICAgICAvLyBkb24ndCBkbyBhbnl0aGluZyBpZiBzbGlkZXIgaGFzIGFscmVhZHkgYmVlbiBkZXN0cm95ZWQKICAgICAgaWYgKCFzbGlkZXIuaW5pdGlhbGl6ZWQpIHJldHVybjsKICAgICAgc2xpZGVyLmluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICQoJy5ieC1jbG9uZScsIHRoaXMpLnJlbW92ZSgpOwogICAgICBzbGlkZXIuY2hpbGRyZW4uZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgJCh0aGlzKS5kYXRhKCJvcmlnU3R5bGUiKSAhPSB1bmRlZmluZWQgPyAkKHRoaXMpLmF0dHIoInN0eWxlIiwgJCh0aGlzKS5kYXRhKCJvcmlnU3R5bGUiKSkgOiAkKHRoaXMpLnJlbW92ZUF0dHIoJ3N0eWxlJyk7CiAgICAgIH0pOwogICAgICAkKHRoaXMpLmRhdGEoIm9yaWdTdHlsZSIpICE9IHVuZGVmaW5lZCA/IHRoaXMuYXR0cigic3R5bGUiLCAkKHRoaXMpLmRhdGEoIm9yaWdTdHlsZSIpKSA6ICQodGhpcykucmVtb3ZlQXR0cignc3R5bGUnKTsKICAgICAgJCh0aGlzKS51bndyYXAoKS51bndyYXAoKTsKICAgICAgaWYgKHNsaWRlci5jb250cm9scy5lbCkgc2xpZGVyLmNvbnRyb2xzLmVsLnJlbW92ZSgpOwogICAgICBpZiAoc2xpZGVyLmNvbnRyb2xzLm5leHQpIHNsaWRlci5jb250cm9scy5uZXh0LnJlbW92ZSgpOwogICAgICBpZiAoc2xpZGVyLmNvbnRyb2xzLnByZXYpIHNsaWRlci5jb250cm9scy5wcmV2LnJlbW92ZSgpOwogICAgICBpZiAoc2xpZGVyLnBhZ2VyRWwpIHNsaWRlci5wYWdlckVsLnJlbW92ZSgpOwogICAgICAkKCcuYngtY2FwdGlvbicsIHRoaXMpLnJlbW92ZSgpOwogICAgICBpZiAoc2xpZGVyLmNvbnRyb2xzLmF1dG9FbCkgc2xpZGVyLmNvbnRyb2xzLmF1dG9FbC5yZW1vdmUoKTsKICAgICAgY2xlYXJJbnRlcnZhbChzbGlkZXIuaW50ZXJ2YWwpOwogICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnJlc3BvbnNpdmUpICQod2luZG93KS51bmJpbmQoJ3Jlc2l6ZScsIHJlc2l6ZVdpbmRvdyk7CiAgICB9OwogICAgLyoqCiAgICAgKiBSZWxvYWQgdGhlIHNsaWRlciAocmV2ZXJ0IGFsbCBET00gY2hhbmdlcywgYW5kIHJlLWluaXRpYWxpemUpCiAgICAgKi8KCgogICAgZWwucmVsb2FkU2xpZGVyID0gZnVuY3Rpb24gKHNldHRpbmdzKSB7CiAgICAgIGlmIChzZXR0aW5ncyAhPSB1bmRlZmluZWQpIG9wdGlvbnMgPSBzZXR0aW5nczsKICAgICAgZWwuZGVzdHJveVNsaWRlcigpOwogICAgICBpbml0KCk7CiAgICB9OwoKICAgIGluaXQoKTsgLy8gcmV0dXJucyB0aGUgY3VycmVudCBqUXVlcnkgb2JqZWN0CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKfSkoalF1ZXJ5KTs="},{"version":3,"sources":["C:/Users/diami/OneDrive/Bureau/dakarspectatornews/client/src/assets/js/jquery.bxslider.js"],"names":["$","plugin","defaults","mode","slideSelector","infiniteLoop","hideControlOnEnd","speed","easing","slideMargin","startSlide","randomStart","captions","ticker","tickerHover","adaptiveHeight","adaptiveHeightSpeed","video","useCSS","preloadImages","responsive","touchEnabled","swipeThreshold","oneToOneTouch","preventDefaultSwipeX","preventDefaultSwipeY","pager","pagerType","pagerShortSeparator","pagerSelector","buildPager","pagerCustom","controls","nextText","prevText","nextSelector","prevSelector","autoControls","startText","stopText","autoControlsCombine","autoControlsSelector","auto","pause","autoStart","autoDirection","autoHover","autoDelay","minSlides","maxSlides","moveSlides","slideWidth","onSliderLoad","onSlideBefore","onSlideAfter","onSlideNext","onSlidePrev","fn","bxSlider","options","length","each","slider","el","windowWidth","window","width","windowHeight","height","init","settings","extend","parseInt","children","Math","floor","random","active","index","carousel","minThreshold","maxThreshold","working","interval","animProp","usingCSS","div","document","createElement","props","i","style","undefined","cssPrefix","replace","toLowerCase","data","attr","setup","wrap","viewport","parent","loader","prepend","css","position","slidesShowing","getNumberSlidesShowing","overflow","maxWidth","getViewportMaxWidth","margin","listStyle","getSlideWidth","zIndex","display","eq","appendCaptions","last","getPagerQty","fitVids","preloadSelector","appendPager","appendControls","appendControlsAuto","after","loadElements","start","selector","callback","total","find","count","one","complete","load","slice","sliceAppend","clone","addClass","slicePrepend","append","remove","setSlidePosition","getViewportHeight","redrawSlider","initialized","bind","resizeWindow","initAuto","initTicker","updatePagerActive","updateDirectionControls","initTouch","currentIndex","getMoveBy","add","outerHeight","max","apply","map","get","newElWidth","wrapWidth","childWidth","first","pagerQty","breakPoint","counter","ceil","lastChild","setPositionProperty","left","lastShowingIndex","top","value","type","duration","params","propValue","unbind","updateAfterSlideTransition","tickerLoop","animateObj","animate","populatePager","pagerHtml","linkContent","isFunction","pagerEl","html","delegate","clickPagerBind","next","prev","clickNextBind","clickPrevBind","directionEl","stop","autoEl","clickStartBind","clickStopBind","updateAutoControls","title","e","stopAuto","goToNextSlide","preventDefault","goToPrevSlide","startAuto","pagerLink","currentTarget","pagerIndex","goToSlide","slideIndex","len","removeClass","oldIndex","state","timeout","setTimeout","hover","autoPaused","startPosition","totalDimens","outerWidth","ratio","property","newSpeed","abs","resumeSpeed","reset","animateProperty","resetValue","touch","x","y","end","onTouchStart","originalPos","orig","originalEvent","changedTouches","pageX","pageY","onTouchMove","onTouchEnd","xMovement","yMovement","change","distance","windowWidthNew","windowHeightNew","direction","filter","fadeOut","fadeIn","moveBy","requestEl","preventControlUpdate","setInterval","clearInterval","getCurrentSlide","getSlideCount","destroySlider","removeAttr","unwrap","reloadSlider","jQuery"],"mappings":"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","sourcesContent":["/**\n * BxSlider v4.1.1 - Fully loaded, responsive content slider\n * http://bxslider.com\n *\n * Copyright 2013, Steven Wanderski - http://stevenwanderski.com - http://bxcreative.com\n * Written while drinking Belgian ales and listening to jazz\n *\n * Released under the MIT license - http://opensource.org/licenses/MIT\n */\n\n;(function($){\n\n\tvar plugin = {};\n\n\tvar defaults = {\n\n\t\t// GENERAL\n\t\tmode: 'horizontal',\n\t\tslideSelector: '',\n\t\tinfiniteLoop: true,\n\t\thideControlOnEnd: false,\n\t\tspeed: 500,\n\t\teasing: null,\n\t\tslideMargin: 0,\n\t\tstartSlide: 0,\n\t\trandomStart: false,\n\t\tcaptions: false,\n\t\tticker: false,\n\t\ttickerHover: false,\n\t\tadaptiveHeight: false,\n\t\tadaptiveHeightSpeed: 500,\n\t\tvideo: false,\n\t\tuseCSS: true,\n\t\tpreloadImages: 'visible',\n\t\tresponsive: true,\n\n\t\t// TOUCH\n\t\ttouchEnabled: true,\n\t\tswipeThreshold: 50,\n\t\toneToOneTouch: true,\n\t\tpreventDefaultSwipeX: true,\n\t\tpreventDefaultSwipeY: false,\n\n\t\t// PAGER\n\t\tpager: true,\n\t\tpagerType: 'full',\n\t\tpagerShortSeparator: ' / ',\n\t\tpagerSelector: null,\n\t\tbuildPager: null,\n\t\tpagerCustom: null,\n\n\t\t// CONTROLS\n\t\tcontrols: true,\n\t\tnextText: 'Next',\n\t\tprevText: 'Prev',\n\t\tnextSelector: null,\n\t\tprevSelector: null,\n\t\tautoControls: false,\n\t\tstartText: 'Start',\n\t\tstopText: 'Stop',\n\t\tautoControlsCombine: false,\n\t\tautoControlsSelector: null,\n\n\t\t// AUTO\n\t\tauto: false,\n\t\tpause: 4000,\n\t\tautoStart: true,\n\t\tautoDirection: 'next',\n\t\tautoHover: false,\n\t\tautoDelay: 0,\n\n\t\t// CAROUSEL\n\t\tminSlides: 1,\n\t\tmaxSlides: 1,\n\t\tmoveSlides: 0,\n\t\tslideWidth: 0,\n\n\t\t// CALLBACKS\n\t\tonSliderLoad: function() {},\n\t\tonSlideBefore: function() {},\n\t\tonSlideAfter: function() {},\n\t\tonSlideNext: function() {},\n\t\tonSlidePrev: function() {}\n\t}\n\n\t$.fn.bxSlider = function(options){\n\n\t\tif(this.length == 0) return this;\n\n\t\t// support mutltiple elements\n\t\tif(this.length > 1){\n\t\t\tthis.each(function(){$(this).bxSlider(options)});\n\t\t\treturn this;\n\t\t}\n\n\t\t// create a namespace to be used throughout the plugin\n\t\tvar slider = {};\n\t\t// set a reference to our slider element\n\t\tvar el = this;\n\t\tplugin.el = this;\n\n\t\t/**\n\t\t * Makes slideshow responsive\n\t\t */\n\t\t// first get the original window dimens (thanks alot IE)\n\t\tvar windowWidth = $(window).width();\n\t\tvar windowHeight = $(window).height();\n\n\n\n\t\t/**\n\t\t * ===================================================================================\n\t\t * = PRIVATE FUNCTIONS\n\t\t * ===================================================================================\n\t\t */\n\n\t\t/**\n\t\t * Initializes namespace settings to be used throughout plugin\n\t\t */\n\t\tvar init = function(){\n\t\t\t// merge user-supplied options with the defaults\n\t\t\tslider.settings = $.extend({}, defaults, options);\n\t\t\t// parse slideWidth setting\n\t\t\tslider.settings.slideWidth = parseInt(slider.settings.slideWidth);\n\t\t\t// store the original children\n\t\t\tslider.children = el.children(slider.settings.slideSelector);\n\t\t\t// check if actual number of slides is less than minSlides / maxSlides\n\t\t\tif(slider.children.length < slider.settings.minSlides) slider.settings.minSlides = slider.children.length;\n\t\t\tif(slider.children.length < slider.settings.maxSlides) slider.settings.maxSlides = slider.children.length;\n\t\t\t// if random start, set the startSlide setting to random number\n\t\t\tif(slider.settings.randomStart) slider.settings.startSlide = Math.floor(Math.random() * slider.children.length);\n\t\t\t// store active slide information\n\t\t\tslider.active = { index: slider.settings.startSlide }\n\t\t\t// store if the slider is in carousel mode (displaying / moving multiple slides)\n\t\t\tslider.carousel = slider.settings.minSlides > 1 || slider.settings.maxSlides > 1;\n\t\t\t// if carousel, force preloadImages = 'all'\n\t\t\tif(slider.carousel) slider.settings.preloadImages = 'all';\n\t\t\t// calculate the min / max width thresholds based on min / max number of slides\n\t\t\t// used to setup and update carousel slides dimensions\n\t\t\tslider.minThreshold = (slider.settings.minSlides * slider.settings.slideWidth) + ((slider.settings.minSlides - 1) * slider.settings.slideMargin);\n\t\t\tslider.maxThreshold = (slider.settings.maxSlides * slider.settings.slideWidth) + ((slider.settings.maxSlides - 1) * slider.settings.slideMargin);\n\t\t\t// store the current state of the slider (if currently animating, working is true)\n\t\t\tslider.working = false;\n\t\t\t// initialize the controls object\n\t\t\tslider.controls = {};\n\t\t\t// initialize an auto interval\n\t\t\tslider.interval = null;\n\t\t\t// determine which property to use for transitions\n\t\t\tslider.animProp = slider.settings.mode == 'vertical' ? 'top' : 'left';\n\t\t\t// determine if hardware acceleration can be used\n\t\t\tslider.usingCSS = slider.settings.useCSS && slider.settings.mode != 'fade' && (function(){\n\t\t\t\t// create our test div element\n\t\t\t\tvar div = document.createElement('div');\n\t\t\t\t// css transition properties\n\t\t\t\tvar props = ['WebkitPerspective', 'MozPerspective', 'OPerspective', 'msPerspective'];\n\t\t\t\t// test for each property\n\t\t\t\tfor(var i in props){\n\t\t\t\t\tif(div.style[props[i]] !== undefined){\n\t\t\t\t\t\tslider.cssPrefix = props[i].replace('Perspective', '').toLowerCase();\n\t\t\t\t\t\tslider.animProp = '-' + slider.cssPrefix + '-transform';\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}());\n\t\t\t// if vertical mode always make maxSlides and minSlides equal\n\t\t\tif(slider.settings.mode == 'vertical') slider.settings.maxSlides = slider.settings.minSlides;\n\t\t\t// save original style data\n\t\t\tel.data(\"origStyle\", el.attr(\"style\"));\n\t\t\tel.children(slider.settings.slideSelector).each(function() {\n\t\t\t  $(this).data(\"origStyle\", $(this).attr(\"style\"));\n\t\t\t});\n\t\t\t// perform all DOM / CSS modifications\n\t\t\tsetup();\n\t\t}\n\n\t\t/**\n\t\t * Performs all DOM and CSS modifications\n\t\t */\n\t\tvar setup = function(){\n\t\t\t// wrap el in a wrapper\n\t\t\tel.wrap('<div class=\"bx-wrapper\"><div class=\"bx-viewport\"></div></div>');\n\t\t\t// store a namspace reference to .bx-viewport\n\t\t\tslider.viewport = el.parent();\n\t\t\t// add a loading div to display while images are loading\n\t\t\tslider.loader = $('<div class=\"bx-loading\" />');\n\t\t\tslider.viewport.prepend(slider.loader);\n\t\t\t// set el to a massive width, to hold any needed slides\n\t\t\t// also strip any margin and padding from el\n\t\t\tel.css({\n\t\t\t\twidth: slider.settings.mode == 'horizontal' ? (slider.children.length * 100 + 215) + '%' : 'auto',\n\t\t\t\tposition: 'relative'\n\t\t\t});\n\t\t\t// if using CSS, add the easing property\n\t\t\tif(slider.usingCSS && slider.settings.easing){\n\t\t\t\tel.css('-' + slider.cssPrefix + '-transition-timing-function', slider.settings.easing);\n\t\t\t// if not using CSS and no easing value was supplied, use the default JS animation easing (swing)\n\t\t\t}else if(!slider.settings.easing){\n\t\t\t\tslider.settings.easing = 'swing';\n\t\t\t}\n\t\t\tvar slidesShowing = getNumberSlidesShowing();\n\t\t\t// make modifications to the viewport (.bx-viewport)\n\t\t\tslider.viewport.css({\n\t\t\t\twidth: '100%',\n\t\t\t\toverflow: 'hidden',\n\t\t\t\tposition: 'relative'\n\t\t\t});\n\t\t\tslider.viewport.parent().css({\n\t\t\t\tmaxWidth: getViewportMaxWidth()\n\t\t\t});\n\t\t\t// make modification to the wrapper (.bx-wrapper)\n\t\t\tif(!slider.settings.pager) {\n\t\t\t\tslider.viewport.parent().css({\n\t\t\t\tmargin: '0 auto 0px'\n\t\t\t\t});\n\t\t\t}\n\t\t\t// apply css to all slider children\n\t\t\tslider.children.css({\n\t\t\t\t'float': slider.settings.mode == 'horizontal' ? 'left' : 'none',\n\t\t\t\tlistStyle: 'none',\n\t\t\t\tposition: 'relative'\n\t\t\t});\n\t\t\t// apply the calculated width after the float is applied to prevent scrollbar interference\n\t\t\tslider.children.css('width', getSlideWidth());\n\t\t\t// if slideMargin is supplied, add the css\n\t\t\tif(slider.settings.mode == 'horizontal' && slider.settings.slideMargin > 0) slider.children.css('marginRight', slider.settings.slideMargin);\n\t\t\tif(slider.settings.mode == 'vertical' && slider.settings.slideMargin > 0) slider.children.css('marginBottom', slider.settings.slideMargin);\n\t\t\t// if \"fade\" mode, add positioning and z-index CSS\n\t\t\tif(slider.settings.mode == 'fade'){\n\t\t\t\tslider.children.css({\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\tzIndex: 0,\n\t\t\t\t\tdisplay: 'none'\n\t\t\t\t});\n\t\t\t\t// prepare the z-index on the showing element\n\t\t\t\tslider.children.eq(slider.settings.startSlide).css({zIndex: 50, display: 'block'});\n\t\t\t}\n\t\t\t// create an element to contain all slider controls (pager, start / stop, etc)\n\t\t\tslider.controls.el = $('<div class=\"bx-controls\" />');\n\t\t\t// if captions are requested, add them\n\t\t\tif(slider.settings.captions) appendCaptions();\n\t\t\t// check if startSlide is last slide\n\t\t\tslider.active.last = slider.settings.startSlide == getPagerQty() - 1;\n\t\t\t// if video is true, set up the fitVids plugin\n\t\t\tif(slider.settings.video) el.fitVids();\n\t\t\t// set the default preload selector (visible)\n\t\t\tvar preloadSelector = slider.children.eq(slider.settings.startSlide);\n\t\t\tif (slider.settings.preloadImages == \"all\") preloadSelector = slider.children;\n\t\t\t// only check for control addition if not in \"ticker\" mode\n\t\t\tif(!slider.settings.ticker){\n\t\t\t\t// if pager is requested, add it\n\t\t\t\tif(slider.settings.pager) appendPager();\n\t\t\t\t// if controls are requested, add them\n\t\t\t\tif(slider.settings.controls) appendControls();\n\t\t\t\t// if auto is true, and auto controls are requested, add them\n\t\t\t\tif(slider.settings.auto && slider.settings.autoControls) appendControlsAuto();\n\t\t\t\t// if any control option is requested, add the controls wrapper\n\t\t\t\tif(slider.settings.controls || slider.settings.autoControls || slider.settings.pager) slider.viewport.after(slider.controls.el);\n\t\t\t// if ticker mode, do not allow a pager\n\t\t\t}else{\n\t\t\t\tslider.settings.pager = false;\n\t\t\t}\n\t\t\t// preload all images, then perform final DOM / CSS modifications that depend on images being loaded\n\t\t\tloadElements(preloadSelector, start);\n\t\t}\n\n\t\tvar loadElements = function(selector, callback){\n\t\t\tvar total = selector.find('img, iframe').length;\n\t\t\tif (total == 0){\n\t\t\t\tcallback();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar count = 0;\n\t\t\tselector.find('img, iframe').each(function(){\n\t\t\t\t$(this).one('load', function() {\n\t\t\t\t  if(++count == total) callback();\n\t\t\t\t}).each(function() {\n\t\t\t\t  if(this.complete) $(this).load();\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Start the slider\n\t\t */\n\t\tvar start = function(){\n\t\t\t// if infinite loop, prepare additional slides\n\t\t\tif(slider.settings.infiniteLoop && slider.settings.mode != 'fade' && !slider.settings.ticker){\n\t\t\t\tvar slice = slider.settings.mode == 'vertical' ? slider.settings.minSlides : slider.settings.maxSlides;\n\t\t\t\tvar sliceAppend = slider.children.slice(0, slice).clone().addClass('bx-clone');\n\t\t\t\tvar slicePrepend = slider.children.slice(-slice).clone().addClass('bx-clone');\n\t\t\t\tel.append(sliceAppend).prepend(slicePrepend);\n\t\t\t}\n\t\t\t// remove the loading DOM element\n\t\t\tslider.loader.remove();\n\t\t\t// set the left / top position of \"el\"\n\t\t\tsetSlidePosition();\n\t\t\t// if \"vertical\" mode, always use adaptiveHeight to prevent odd behavior\n\t\t\tif (slider.settings.mode == 'vertical') slider.settings.adaptiveHeight = true;\n\t\t\t// set the viewport height\n\t\t\tslider.viewport.height(getViewportHeight());\n\t\t\t// make sure everything is positioned just right (same as a window resize)\n\t\t\tel.redrawSlider();\n\t\t\t// onSliderLoad callback\n\t\t\tslider.settings.onSliderLoad(slider.active.index);\n\t\t\t// slider has been fully initialized\n\t\t\tslider.initialized = true;\n\t\t\t// bind the resize call to the window\n\t\t\tif (slider.settings.responsive) $(window).bind('resize', resizeWindow);\n\t\t\t// if auto is true, start the show\n\t\t\tif (slider.settings.auto && slider.settings.autoStart) initAuto();\n\t\t\t// if ticker is true, start the ticker\n\t\t\tif (slider.settings.ticker) initTicker();\n\t\t\t// if pager is requested, make the appropriate pager link active\n\t\t\tif (slider.settings.pager) updatePagerActive(slider.settings.startSlide);\n\t\t\t// check for any updates to the controls (like hideControlOnEnd updates)\n\t\t\tif (slider.settings.controls) updateDirectionControls();\n\t\t\t// if touchEnabled is true, setup the touch events\n\t\t\tif (slider.settings.touchEnabled && !slider.settings.ticker) initTouch();\n\t\t}\n\n\t\t/**\n\t\t * Returns the calculated height of the viewport, used to determine either adaptiveHeight or the maxHeight value\n\t\t */\n\t\tvar getViewportHeight = function(){\n\t\t\tvar height = 0;\n\t\t\t// first determine which children (slides) should be used in our height calculation\n\t\t\tvar children = $();\n\t\t\t// if mode is not \"vertical\" and adaptiveHeight is false, include all children\n\t\t\tif(slider.settings.mode != 'vertical' && !slider.settings.adaptiveHeight){\n\t\t\t\tchildren = slider.children;\n\t\t\t}else{\n\t\t\t\t// if not carousel, return the single active child\n\t\t\t\tif(!slider.carousel){\n\t\t\t\t\tchildren = slider.children.eq(slider.active.index);\n\t\t\t\t// if carousel, return a slice of children\n\t\t\t\t}else{\n\t\t\t\t\t// get the individual slide index\n\t\t\t\t\tvar currentIndex = slider.settings.moveSlides == 1 ? slider.active.index : slider.active.index * getMoveBy();\n\t\t\t\t\t// add the current slide to the children\n\t\t\t\t\tchildren = slider.children.eq(currentIndex);\n\t\t\t\t\t// cycle through the remaining \"showing\" slides\n\t\t\t\t\tfor (i = 1; i <= slider.settings.maxSlides - 1; i++){\n\t\t\t\t\t\t// if looped back to the start\n\t\t\t\t\t\tif(currentIndex + i >= slider.children.length){\n\t\t\t\t\t\t\tchildren = children.add(slider.children.eq(i - 1));\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tchildren = children.add(slider.children.eq(currentIndex + i));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// if \"vertical\" mode, calculate the sum of the heights of the children\n\t\t\tif(slider.settings.mode == 'vertical'){\n\t\t\t\tchildren.each(function(index) {\n\t\t\t\t  height += $(this).outerHeight();\n\t\t\t\t});\n\t\t\t\t// add user-supplied margins\n\t\t\t\tif(slider.settings.slideMargin > 0){\n\t\t\t\t\theight += slider.settings.slideMargin * (slider.settings.minSlides - 1);\n\t\t\t\t}\n\t\t\t// if not \"vertical\" mode, calculate the max height of the children\n\t\t\t}else{\n\t\t\t\theight = Math.max.apply(Math, children.map(function(){\n\t\t\t\t\treturn $(this).outerHeight(false);\n\t\t\t\t}).get());\n\t\t\t}\n\t\t\treturn height;\n\t\t}\n\n\t\t/**\n\t\t * Returns the calculated width to be used for the outer wrapper / viewport\n\t\t */\n\t\tvar getViewportMaxWidth = function(){\n\t\t\tvar width = '100%';\n\t\t\tif(slider.settings.slideWidth > 0){\n\t\t\t\tif(slider.settings.mode == 'horizontal'){\n\t\t\t\t\twidth = (slider.settings.maxSlides * slider.settings.slideWidth) + ((slider.settings.maxSlides - 1) * slider.settings.slideMargin);\n\t\t\t\t}else{\n\t\t\t\t\twidth = slider.settings.slideWidth;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn width;\n\t\t}\n\n\t\t/**\n\t\t * Returns the calculated width to be applied to each slide\n\t\t */\n\t\tvar getSlideWidth = function(){\n\t\t\t// start with any user-supplied slide width\n\t\t\tvar newElWidth = slider.settings.slideWidth;\n\t\t\t// get the current viewport width\n\t\t\tvar wrapWidth = slider.viewport.width();\n\t\t\t// if slide width was not supplied, or is larger than the viewport use the viewport width\n\t\t\tif(slider.settings.slideWidth == 0 ||\n\t\t\t\t(slider.settings.slideWidth > wrapWidth && !slider.carousel) ||\n\t\t\t\tslider.settings.mode == 'vertical'){\n\t\t\t\tnewElWidth = wrapWidth;\n\t\t\t// if carousel, use the thresholds to determine the width\n\t\t\t}else if(slider.settings.maxSlides > 1 && slider.settings.mode == 'horizontal'){\n\t\t\t\tif(wrapWidth > slider.maxThreshold){\n\t\t\t\t\t// newElWidth = (wrapWidth - (slider.settings.slideMargin * (slider.settings.maxSlides - 1))) / slider.settings.maxSlides;\n\t\t\t\t}else if(wrapWidth < slider.minThreshold){\n\t\t\t\t\tnewElWidth = (wrapWidth - (slider.settings.slideMargin * (slider.settings.minSlides - 1))) / slider.settings.minSlides;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn newElWidth;\n\t\t}\n\n\t\t/**\n\t\t * Returns the number of slides currently visible in the viewport (includes partially visible slides)\n\t\t */\n\t\tvar getNumberSlidesShowing = function(){\n\t\t\tvar slidesShowing = 1;\n\t\t\tif(slider.settings.mode == 'horizontal' && slider.settings.slideWidth > 0){\n\t\t\t\t// if viewport is smaller than minThreshold, return minSlides\n\t\t\t\tif(slider.viewport.width() < slider.minThreshold){\n\t\t\t\t\tslidesShowing = slider.settings.minSlides;\n\t\t\t\t// if viewport is larger than minThreshold, return maxSlides\n\t\t\t\t}else if(slider.viewport.width() > slider.maxThreshold){\n\t\t\t\t\tslidesShowing = slider.settings.maxSlides;\n\t\t\t\t// if viewport is between min / max thresholds, divide viewport width by first child width\n\t\t\t\t}else{\n\t\t\t\t\tvar childWidth = slider.children.first().width();\n\t\t\t\t\tslidesShowing = Math.floor(slider.viewport.width() / childWidth);\n\t\t\t\t}\n\t\t\t// if \"vertical\" mode, slides showing will always be minSlides\n\t\t\t}else if(slider.settings.mode == 'vertical'){\n\t\t\t\tslidesShowing = slider.settings.minSlides;\n\t\t\t}\n\t\t\treturn slidesShowing;\n\t\t}\n\n\t\t/**\n\t\t * Returns the number of pages (one full viewport of slides is one \"page\")\n\t\t */\n\t\tvar getPagerQty = function(){\n\t\t\tvar pagerQty = 0;\n\t\t\t// if moveSlides is specified by the user\n\t\t\tif(slider.settings.moveSlides > 0){\n\t\t\t\tif(slider.settings.infiniteLoop){\n\t\t\t\t\tpagerQty = slider.children.length / getMoveBy();\n\t\t\t\t}else{\n\t\t\t\t\t// use a while loop to determine pages\n\t\t\t\t\tvar breakPoint = 0;\n\t\t\t\t\tvar counter = 0\n\t\t\t\t\t// when breakpoint goes above children length, counter is the number of pages\n\t\t\t\t\twhile (breakPoint < slider.children.length){\n\t\t\t\t\t\t++pagerQty;\n\t\t\t\t\t\tbreakPoint = counter + getNumberSlidesShowing();\n\t\t\t\t\t\tcounter += slider.settings.moveSlides <= getNumberSlidesShowing() ? slider.settings.moveSlides : getNumberSlidesShowing();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t// if moveSlides is 0 (auto) divide children length by sides showing, then round up\n\t\t\t}else{\n\t\t\t\tpagerQty = Math.ceil(slider.children.length / getNumberSlidesShowing());\n\t\t\t}\n\t\t\treturn pagerQty;\n\t\t}\n\n\t\t/**\n\t\t * Returns the number of indivual slides by which to shift the slider\n\t\t */\n\t\tvar getMoveBy = function(){\n\t\t\t// if moveSlides was set by the user and moveSlides is less than number of slides showing\n\t\t\tif(slider.settings.moveSlides > 0 && slider.settings.moveSlides <= getNumberSlidesShowing()){\n\t\t\t\treturn slider.settings.moveSlides;\n\t\t\t}\n\t\t\t// if moveSlides is 0 (auto)\n\t\t\treturn getNumberSlidesShowing();\n\t\t}\n\n\t\t/**\n\t\t * Sets the slider's (el) left or top position\n\t\t */\n\t\tvar setSlidePosition = function(){\n\t\t\t// if last slide, not infinite loop, and number of children is larger than specified maxSlides\n\t\t\tif(slider.children.length > slider.settings.maxSlides && slider.active.last && !slider.settings.infiniteLoop){\n\t\t\t\tif (slider.settings.mode == 'horizontal'){\n\t\t\t\t\t// get the last child's position\n\t\t\t\t\tvar lastChild = slider.children.last();\n\t\t\t\t\tvar position = lastChild.position();\n\t\t\t\t\t// set the left position\n\t\t\t\t\tsetPositionProperty(-(position.left - (slider.viewport.width() - lastChild.width())), 'reset', 0);\n\t\t\t\t}else if(slider.settings.mode == 'vertical'){\n\t\t\t\t\t// get the last showing index's position\n\t\t\t\t\tvar lastShowingIndex = slider.children.length - slider.settings.minSlides;\n\t\t\t\t\tvar position = slider.children.eq(lastShowingIndex).position();\n\t\t\t\t\t// set the top position\n\t\t\t\t\tsetPositionProperty(-position.top, 'reset', 0);\n\t\t\t\t}\n\t\t\t// if not last slide\n\t\t\t}else{\n\t\t\t\t// get the position of the first showing slide\n\t\t\t\tvar position = slider.children.eq(slider.active.index * getMoveBy()).position();\n\t\t\t\t// check for last slide\n\t\t\t\tif (slider.active.index == getPagerQty() - 1) slider.active.last = true;\n\t\t\t\t// set the repective position\n\t\t\t\tif (position != undefined){\n\t\t\t\t\tif (slider.settings.mode == 'horizontal') setPositionProperty(-position.left, 'reset', 0);\n\t\t\t\t\telse if (slider.settings.mode == 'vertical') setPositionProperty(-position.top, 'reset', 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Sets the el's animating property position (which in turn will sometimes animate el).\n\t\t * If using CSS, sets the transform property. If not using CSS, sets the top / left property.\n\t\t *\n\t\t * @param value (int)\n\t\t *  - the animating property's value\n\t\t *\n\t\t * @param type (string) 'slider', 'reset', 'ticker'\n\t\t *  - the type of instance for which the function is being\n\t\t *\n\t\t * @param duration (int)\n\t\t *  - the amount of time (in ms) the transition should occupy\n\t\t *\n\t\t * @param params (array) optional\n\t\t *  - an optional parameter containing any variables that need to be passed in\n\t\t */\n\t\tvar setPositionProperty = function(value, type, duration, params){\n\t\t\t// use CSS transform\n\t\t\tif(slider.usingCSS){\n\t\t\t\t// determine the translate3d value\n\t\t\t\tvar propValue = slider.settings.mode == 'vertical' ? 'translate3d(0, ' + value + 'px, 0)' : 'translate3d(' + value + 'px, 0, 0)';\n\t\t\t\t// add the CSS transition-duration\n\t\t\t\tel.css('-' + slider.cssPrefix + '-transition-duration', duration / 1000 + 's');\n\t\t\t\tif(type == 'slide'){\n\t\t\t\t\t// set the property value\n\t\t\t\t\tel.css(slider.animProp, propValue);\n\t\t\t\t\t// bind a callback method - executes when CSS transition completes\n\t\t\t\t\tel.bind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd', function(){\n\t\t\t\t\t\t// unbind the callback\n\t\t\t\t\t\tel.unbind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd');\n\t\t\t\t\t\tupdateAfterSlideTransition();\n\t\t\t\t\t});\n\t\t\t\t}else if(type == 'reset'){\n\t\t\t\t\tel.css(slider.animProp, propValue);\n\t\t\t\t}else if(type == 'ticker'){\n\t\t\t\t\t// make the transition use 'linear'\n\t\t\t\t\tel.css('-' + slider.cssPrefix + '-transition-timing-function', 'linear');\n\t\t\t\t\tel.css(slider.animProp, propValue);\n\t\t\t\t\t// bind a callback method - executes when CSS transition completes\n\t\t\t\t\tel.bind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd', function(){\n\t\t\t\t\t\t// unbind the callback\n\t\t\t\t\t\tel.unbind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd');\n\t\t\t\t\t\t// reset the position\n\t\t\t\t\t\tsetPositionProperty(params['resetValue'], 'reset', 0);\n\t\t\t\t\t\t// start the loop again\n\t\t\t\t\t\ttickerLoop();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t// use JS animate\n\t\t\t}else{\n\t\t\t\tvar animateObj = {};\n\t\t\t\tanimateObj[slider.animProp] = value;\n\t\t\t\tif(type == 'slide'){\n\t\t\t\t\tel.animate(animateObj, duration, slider.settings.easing, function(){\n\t\t\t\t\t\tupdateAfterSlideTransition();\n\t\t\t\t\t});\n\t\t\t\t}else if(type == 'reset'){\n\t\t\t\t\tel.css(slider.animProp, value)\n\t\t\t\t}else if(type == 'ticker'){\n\t\t\t\t\tel.animate(animateObj, speed, 'linear', function(){\n\t\t\t\t\t\tsetPositionProperty(params['resetValue'], 'reset', 0);\n\t\t\t\t\t\t// run the recursive loop after animation\n\t\t\t\t\t\ttickerLoop();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Populates the pager with proper amount of pages\n\t\t */\n\t\tvar populatePager = function(){\n\t\t\tvar pagerHtml = '';\n\t\t\tvar pagerQty = getPagerQty();\n\t\t\t// loop through each pager item\n\t\t\tfor(var i=0; i < pagerQty; i++){\n\t\t\t\tvar linkContent = '';\n\t\t\t\t// if a buildPager function is supplied, use it to get pager link value, else use index + 1\n\t\t\t\tif(slider.settings.buildPager && $.isFunction(slider.settings.buildPager)){\n\t\t\t\t\tlinkContent = slider.settings.buildPager(i);\n\t\t\t\t\tslider.pagerEl.addClass('bx-custom-pager');\n\t\t\t\t}else{\n\t\t\t\t\tlinkContent = i + 1;\n\t\t\t\t\tslider.pagerEl.addClass('bx-default-pager');\n\t\t\t\t}\n\t\t\t\t// var linkContent = slider.settings.buildPager && $.isFunction(slider.settings.buildPager) ? slider.settings.buildPager(i) : i + 1;\n\t\t\t\t// add the markup to the string\n\t\t\t\tpagerHtml += '<div class=\"bx-pager-item\"><a href=\"\" data-slide-index=\"' + i + '\" class=\"bx-pager-link\">' + linkContent + '</a></div>';\n\t\t\t};\n\t\t\t// populate the pager element with pager links\n\t\t\tslider.pagerEl.html(pagerHtml);\n\t\t}\n\n\t\t/**\n\t\t * Appends the pager to the controls element\n\t\t */\n\t\tvar appendPager = function(){\n\t\t\tif(!slider.settings.pagerCustom){\n\t\t\t\t// create the pager DOM element\n\t\t\t\tslider.pagerEl = $('<div class=\"bx-pager\" />');\n\t\t\t\t// if a pager selector was supplied, populate it with the pager\n\t\t\t\tif(slider.settings.pagerSelector){\n\t\t\t\t\t$(slider.settings.pagerSelector).html(slider.pagerEl);\n\t\t\t\t// if no pager selector was supplied, add it after the wrapper\n\t\t\t\t}else{\n\t\t\t\t\tslider.controls.el.addClass('bx-has-pager').append(slider.pagerEl);\n\t\t\t\t}\n\t\t\t\t// populate the pager\n\t\t\t\tpopulatePager();\n\t\t\t}else{\n\t\t\t\tslider.pagerEl = $(slider.settings.pagerCustom);\n\t\t\t}\n\t\t\t// assign the pager click binding\n\t\t\tslider.pagerEl.delegate('a', 'click', clickPagerBind);\n\t\t}\n\n\t\t/**\n\t\t * Appends prev / next controls to the controls element\n\t\t */\n\t\tvar appendControls = function(){\n\t\t\tslider.controls.next = $('<a class=\"bx-next\" href=\"\">' + slider.settings.nextText + '</a>');\n\t\t\tslider.controls.prev = $('<a class=\"bx-prev\" href=\"\">' + slider.settings.prevText + '</a>');\n\t\t\t// bind click actions to the controls\n\t\t\tslider.controls.next.bind('click', clickNextBind);\n\t\t\tslider.controls.prev.bind('click', clickPrevBind);\n\t\t\t// if nextSlector was supplied, populate it\n\t\t\tif(slider.settings.nextSelector){\n\t\t\t\t$(slider.settings.nextSelector).append(slider.controls.next);\n\t\t\t}\n\t\t\t// if prevSlector was supplied, populate it\n\t\t\tif(slider.settings.prevSelector){\n\t\t\t\t$(slider.settings.prevSelector).append(slider.controls.prev);\n\t\t\t}\n\t\t\t// if no custom selectors were supplied\n\t\t\tif(!slider.settings.nextSelector && !slider.settings.prevSelector){\n\t\t\t\t// add the controls to the DOM\n\t\t\t\tslider.controls.directionEl = $('<div class=\"bx-controls-direction\" />');\n\t\t\t\t// add the control elements to the directionEl\n\t\t\t\tslider.controls.directionEl.append(slider.controls.prev).append(slider.controls.next);\n\t\t\t\t// slider.viewport.append(slider.controls.directionEl);\n\t\t\t\tslider.controls.el.addClass('bx-has-controls-direction').append(slider.controls.directionEl);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Appends start / stop auto controls to the controls element\n\t\t */\n\t\tvar appendControlsAuto = function(){\n\t\t\tslider.controls.start = $('<div class=\"bx-controls-auto-item\"><a class=\"bx-start\" href=\"\">' + slider.settings.startText + '</a></div>');\n\t\t\tslider.controls.stop = $('<div class=\"bx-controls-auto-item\"><a class=\"bx-stop\" href=\"\">' + slider.settings.stopText + '</a></div>');\n\t\t\t// add the controls to the DOM\n\t\t\tslider.controls.autoEl = $('<div class=\"bx-controls-auto\" />');\n\t\t\t// bind click actions to the controls\n\t\t\tslider.controls.autoEl.delegate('.bx-start', 'click', clickStartBind);\n\t\t\tslider.controls.autoEl.delegate('.bx-stop', 'click', clickStopBind);\n\t\t\t// if autoControlsCombine, insert only the \"start\" control\n\t\t\tif(slider.settings.autoControlsCombine){\n\t\t\t\tslider.controls.autoEl.append(slider.controls.start);\n\t\t\t// if autoControlsCombine is false, insert both controls\n\t\t\t}else{\n\t\t\t\tslider.controls.autoEl.append(slider.controls.start).append(slider.controls.stop);\n\t\t\t}\n\t\t\t// if auto controls selector was supplied, populate it with the controls\n\t\t\tif(slider.settings.autoControlsSelector){\n\t\t\t\t$(slider.settings.autoControlsSelector).html(slider.controls.autoEl);\n\t\t\t// if auto controls selector was not supplied, add it after the wrapper\n\t\t\t}else{\n\t\t\t\tslider.controls.el.addClass('bx-has-controls-auto').append(slider.controls.autoEl);\n\t\t\t}\n\t\t\t// update the auto controls\n\t\t\tupdateAutoControls(slider.settings.autoStart ? 'stop' : 'start');\n\t\t}\n\n\t\t/**\n\t\t * Appends image captions to the DOM\n\t\t */\n\t\tvar appendCaptions = function(){\n\t\t\t// cycle through each child\n\t\t\tslider.children.each(function(index){\n\t\t\t\t// get the image title attribute\n\t\t\t\tvar title = $(this).find('img:first').attr('title');\n\t\t\t\t// append the caption\n\t\t\t\tif (title != undefined && ('' + title).length) {\n                    $(this).append('<div class=\"bx-caption\"><span>' + title + '</span></div>');\n                }\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Click next binding\n\t\t *\n\t\t * @param e (event)\n\t\t *  - DOM event object\n\t\t */\n\t\tvar clickNextBind = function(e){\n\t\t\t// if auto show is running, stop it\n\t\t\tif (slider.settings.auto) el.stopAuto();\n\t\t\tel.goToNextSlide();\n\t\t\te.preventDefault();\n\t\t}\n\n\t\t/**\n\t\t * Click prev binding\n\t\t *\n\t\t * @param e (event)\n\t\t *  - DOM event object\n\t\t */\n\t\tvar clickPrevBind = function(e){\n\t\t\t// if auto show is running, stop it\n\t\t\tif (slider.settings.auto) el.stopAuto();\n\t\t\tel.goToPrevSlide();\n\t\t\te.preventDefault();\n\t\t}\n\n\t\t/**\n\t\t * Click start binding\n\t\t *\n\t\t * @param e (event)\n\t\t *  - DOM event object\n\t\t */\n\t\tvar clickStartBind = function(e){\n\t\t\tel.startAuto();\n\t\t\te.preventDefault();\n\t\t}\n\n\t\t/**\n\t\t * Click stop binding\n\t\t *\n\t\t * @param e (event)\n\t\t *  - DOM event object\n\t\t */\n\t\tvar clickStopBind = function(e){\n\t\t\tel.stopAuto();\n\t\t\te.preventDefault();\n\t\t}\n\n\t\t/**\n\t\t * Click pager binding\n\t\t *\n\t\t * @param e (event)\n\t\t *  - DOM event object\n\t\t */\n\t\tvar clickPagerBind = function(e){\n\t\t\t// if auto show is running, stop it\n\t\t\tif (slider.settings.auto) el.stopAuto();\n\t\t\tvar pagerLink = $(e.currentTarget);\n\t\t\tvar pagerIndex = parseInt(pagerLink.attr('data-slide-index'));\n\t\t\t// if clicked pager link is not active, continue with the goToSlide call\n\t\t\tif(pagerIndex != slider.active.index) el.goToSlide(pagerIndex);\n\t\t\te.preventDefault();\n\t\t}\n\n\t\t/**\n\t\t * Updates the pager links with an active class\n\t\t *\n\t\t * @param slideIndex (int)\n\t\t *  - index of slide to make active\n\t\t */\n\t\tvar updatePagerActive = function(slideIndex){\n\t\t\t// if \"short\" pager type\n\t\t\tvar len = slider.children.length; // nb of children\n\t\t\tif(slider.settings.pagerType == 'short'){\n\t\t\t\tif(slider.settings.maxSlides > 1) {\n\t\t\t\t\tlen = Math.ceil(slider.children.length/slider.settings.maxSlides);\n\t\t\t\t}\n\t\t\t\tslider.pagerEl.html( (slideIndex + 1) + slider.settings.pagerShortSeparator + len);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// remove all pager active classes\n\t\t\tslider.pagerEl.find('a').removeClass('active');\n\t\t\t// apply the active class for all pagers\n\t\t\tslider.pagerEl.each(function(i, el) { $(el).find('a').eq(slideIndex).addClass('active'); });\n\t\t}\n\n\t\t/**\n\t\t * Performs needed actions after a slide transition\n\t\t */\n\t\tvar updateAfterSlideTransition = function(){\n\t\t\t// if infinte loop is true\n\t\t\tif(slider.settings.infiniteLoop){\n\t\t\t\tvar position = '';\n\t\t\t\t// first slide\n\t\t\t\tif(slider.active.index == 0){\n\t\t\t\t\t// set the new position\n\t\t\t\t\tposition = slider.children.eq(0).position();\n\t\t\t\t// carousel, last slide\n\t\t\t\t}else if(slider.active.index == getPagerQty() - 1 && slider.carousel){\n\t\t\t\t\tposition = slider.children.eq((getPagerQty() - 1) * getMoveBy()).position();\n\t\t\t\t// last slide\n\t\t\t\t}else if(slider.active.index == slider.children.length - 1){\n\t\t\t\t\tposition = slider.children.eq(slider.children.length - 1).position();\n\t\t\t\t}\n\t\t\t\tif (slider.settings.mode == 'horizontal') { setPositionProperty(-position.left, 'reset', 0);; }\n\t\t\t\telse if (slider.settings.mode == 'vertical') { setPositionProperty(-position.top, 'reset', 0);; }\n\t\t\t}\n\t\t\t// declare that the transition is complete\n\t\t\tslider.working = false;\n\t\t\t// onSlideAfter callback\n\t\t\tslider.settings.onSlideAfter(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index);\n\t\t}\n\n\t\t/**\n\t\t * Updates the auto controls state (either active, or combined switch)\n\t\t *\n\t\t * @param state (string) \"start\", \"stop\"\n\t\t *  - the new state of the auto show\n\t\t */\n\t\tvar updateAutoControls = function(state){\n\t\t\t// if autoControlsCombine is true, replace the current control with the new state\n\t\t\tif(slider.settings.autoControlsCombine){\n\t\t\t\tslider.controls.autoEl.html(slider.controls[state]);\n\t\t\t// if autoControlsCombine is false, apply the \"active\" class to the appropriate control\n\t\t\t}else{\n\t\t\t\tslider.controls.autoEl.find('a').removeClass('active');\n\t\t\t\tslider.controls.autoEl.find('a:not(.bx-' + state + ')').addClass('active');\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Updates the direction controls (checks if either should be hidden)\n\t\t */\n\t\tvar updateDirectionControls = function(){\n\t\t\tif(getPagerQty() == 1){\n\t\t\t\tslider.controls.prev.addClass('disabled');\n\t\t\t\tslider.controls.next.addClass('disabled');\n\t\t\t}else if(!slider.settings.infiniteLoop && slider.settings.hideControlOnEnd){\n\t\t\t\t// if first slide\n\t\t\t\tif (slider.active.index == 0){\n\t\t\t\t\tslider.controls.prev.addClass('disabled');\n\t\t\t\t\tslider.controls.next.removeClass('disabled');\n\t\t\t\t// if last slide\n\t\t\t\t}else if(slider.active.index == getPagerQty() - 1){\n\t\t\t\t\tslider.controls.next.addClass('disabled');\n\t\t\t\t\tslider.controls.prev.removeClass('disabled');\n\t\t\t\t// if any slide in the middle\n\t\t\t\t}else{\n\t\t\t\t\tslider.controls.prev.removeClass('disabled');\n\t\t\t\t\tslider.controls.next.removeClass('disabled');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Initialzes the auto process\n\t\t */\n\t\tvar initAuto = function(){\n\t\t\t// if autoDelay was supplied, launch the auto show using a setTimeout() call\n\t\t\tif(slider.settings.autoDelay > 0){\n\t\t\t\tvar timeout = setTimeout(el.startAuto, slider.settings.autoDelay);\n\t\t\t// if autoDelay was not supplied, start the auto show normally\n\t\t\t}else{\n\t\t\t\tel.startAuto();\n\t\t\t}\n\t\t\t// if autoHover is requested\n\t\t\tif(slider.settings.autoHover){\n\t\t\t\t// on el hover\n\t\t\t\tel.hover(function(){\n\t\t\t\t\t// if the auto show is currently playing (has an active interval)\n\t\t\t\t\tif(slider.interval){\n\t\t\t\t\t\t// stop the auto show and pass true agument which will prevent control update\n\t\t\t\t\t\tel.stopAuto(true);\n\t\t\t\t\t\t// create a new autoPaused value which will be used by the relative \"mouseout\" event\n\t\t\t\t\t\tslider.autoPaused = true;\n\t\t\t\t\t}\n\t\t\t\t}, function(){\n\t\t\t\t\t// if the autoPaused value was created be the prior \"mouseover\" event\n\t\t\t\t\tif(slider.autoPaused){\n\t\t\t\t\t\t// start the auto show and pass true agument which will prevent control update\n\t\t\t\t\t\tel.startAuto(true);\n\t\t\t\t\t\t// reset the autoPaused value\n\t\t\t\t\t\tslider.autoPaused = null;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Initialzes the ticker process\n\t\t */\n\t\tvar initTicker = function(){\n\t\t\tvar startPosition = 0;\n\t\t\t// if autoDirection is \"next\", append a clone of the entire slider\n\t\t\tif(slider.settings.autoDirection == 'next'){\n\t\t\t\tel.append(slider.children.clone().addClass('bx-clone'));\n\t\t\t// if autoDirection is \"prev\", prepend a clone of the entire slider, and set the left position\n\t\t\t}else{\n\t\t\t\tel.prepend(slider.children.clone().addClass('bx-clone'));\n\t\t\t\tvar position = slider.children.first().position();\n\t\t\t\tstartPosition = slider.settings.mode == 'horizontal' ? -position.left : -position.top;\n\t\t\t}\n\t\t\tsetPositionProperty(startPosition, 'reset', 0);\n\t\t\t// do not allow controls in ticker mode\n\t\t\tslider.settings.pager = false;\n\t\t\tslider.settings.controls = false;\n\t\t\tslider.settings.autoControls = false;\n\t\t\t// if autoHover is requested\n\t\t\tif(slider.settings.tickerHover && !slider.usingCSS){\n\t\t\t\t// on el hover\n\t\t\t\tslider.viewport.hover(function(){\n\t\t\t\t\tel.stop();\n\t\t\t\t}, function(){\n\t\t\t\t\t// calculate the total width of children (used to calculate the speed ratio)\n\t\t\t\t\tvar totalDimens = 0;\n\t\t\t\t\tslider.children.each(function(index){\n\t\t\t\t\t  totalDimens += slider.settings.mode == 'horizontal' ? $(this).outerWidth(true) : $(this).outerHeight(true);\n\t\t\t\t\t});\n\t\t\t\t\t// calculate the speed ratio (used to determine the new speed to finish the paused animation)\n\t\t\t\t\tvar ratio = slider.settings.speed / totalDimens;\n\t\t\t\t\t// determine which property to use\n\t\t\t\t\tvar property = slider.settings.mode == 'horizontal' ? 'left' : 'top';\n\t\t\t\t\t// calculate the new speed\n\t\t\t\t\tvar newSpeed = ratio * (totalDimens - (Math.abs(parseInt(el.css(property)))));\n\t\t\t\t\ttickerLoop(newSpeed);\n\t\t\t\t});\n\t\t\t}\n\t\t\t// start the ticker loop\n\t\t\ttickerLoop();\n\t\t}\n\n\t\t/**\n\t\t * Runs a continuous loop, news ticker-style\n\t\t */\n\t\tvar tickerLoop = function(resumeSpeed){\n\t\t\tspeed = resumeSpeed ? resumeSpeed : slider.settings.speed;\n\t\t\tvar position = {left: 0, top: 0};\n\t\t\tvar reset = {left: 0, top: 0};\n\t\t\t// if \"next\" animate left position to last child, then reset left to 0\n\t\t\tif(slider.settings.autoDirection == 'next'){\n\t\t\t\tposition = el.find('.bx-clone').first().position();\n\t\t\t// if \"prev\" animate left position to 0, then reset left to first non-clone child\n\t\t\t}else{\n\t\t\t\treset = slider.children.first().position();\n\t\t\t}\n\t\t\tvar animateProperty = slider.settings.mode == 'horizontal' ? -position.left : -position.top;\n\t\t\tvar resetValue = slider.settings.mode == 'horizontal' ? -reset.left : -reset.top;\n\t\t\tvar params = {resetValue: resetValue};\n\t\t\tsetPositionProperty(animateProperty, 'ticker', speed, params);\n\t\t}\n\n\t\t/**\n\t\t * Initializes touch events\n\t\t */\n\t\tvar initTouch = function(){\n\t\t\t// initialize object to contain all touch values\n\t\t\tslider.touch = {\n\t\t\t\tstart: {x: 0, y: 0},\n\t\t\t\tend: {x: 0, y: 0}\n\t\t\t}\n\t\t\tslider.viewport.bind('touchstart', onTouchStart);\n\t\t}\n\n\t\t/**\n\t\t * Event handler for \"touchstart\"\n\t\t *\n\t\t * @param e (event)\n\t\t *  - DOM event object\n\t\t */\n\t\tvar onTouchStart = function(e){\n\t\t\tif(slider.working){\n\t\t\t\te.preventDefault();\n\t\t\t}else{\n\t\t\t\t// record the original position when touch starts\n\t\t\t\tslider.touch.originalPos = el.position();\n\t\t\t\tvar orig = e.originalEvent;\n\t\t\t\t// record the starting touch x, y coordinates\n\t\t\t\tslider.touch.start.x = orig.changedTouches[0].pageX;\n\t\t\t\tslider.touch.start.y = orig.changedTouches[0].pageY;\n\t\t\t\t// bind a \"touchmove\" event to the viewport\n\t\t\t\tslider.viewport.bind('touchmove', onTouchMove);\n\t\t\t\t// bind a \"touchend\" event to the viewport\n\t\t\t\tslider.viewport.bind('touchend', onTouchEnd);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Event handler for \"touchmove\"\n\t\t *\n\t\t * @param e (event)\n\t\t *  - DOM event object\n\t\t */\n\t\tvar onTouchMove = function(e){\n\t\t\tvar orig = e.originalEvent;\n\t\t\t// if scrolling on y axis, do not prevent default\n\t\t\tvar xMovement = Math.abs(orig.changedTouches[0].pageX - slider.touch.start.x);\n\t\t\tvar yMovement = Math.abs(orig.changedTouches[0].pageY - slider.touch.start.y);\n\t\t\t// x axis swipe\n\t\t\tif((xMovement * 3) > yMovement && slider.settings.preventDefaultSwipeX){\n\t\t\t\te.preventDefault();\n\t\t\t// y axis swipe\n\t\t\t}else if((yMovement * 3) > xMovement && slider.settings.preventDefaultSwipeY){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\tif(slider.settings.mode != 'fade' && slider.settings.oneToOneTouch){\n\t\t\t\tvar value = 0;\n\t\t\t\t// if horizontal, drag along x axis\n\t\t\t\tif(slider.settings.mode == 'horizontal'){\n\t\t\t\t\tvar change = orig.changedTouches[0].pageX - slider.touch.start.x;\n\t\t\t\t\tvalue = slider.touch.originalPos.left + change;\n\t\t\t\t// if vertical, drag along y axis\n\t\t\t\t}else{\n\t\t\t\t\tvar change = orig.changedTouches[0].pageY - slider.touch.start.y;\n\t\t\t\t\tvalue = slider.touch.originalPos.top + change;\n\t\t\t\t}\n\t\t\t\tsetPositionProperty(value, 'reset', 0);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Event handler for \"touchend\"\n\t\t *\n\t\t * @param e (event)\n\t\t *  - DOM event object\n\t\t */\n\t\tvar onTouchEnd = function(e){\n\t\t\tslider.viewport.unbind('touchmove', onTouchMove);\n\t\t\tvar orig = e.originalEvent;\n\t\t\tvar value = 0;\n\t\t\t// record end x, y positions\n\t\t\tslider.touch.end.x = orig.changedTouches[0].pageX;\n\t\t\tslider.touch.end.y = orig.changedTouches[0].pageY;\n\t\t\t// if fade mode, check if absolute x distance clears the threshold\n\t\t\tif(slider.settings.mode == 'fade'){\n\t\t\t\tvar distance = Math.abs(slider.touch.start.x - slider.touch.end.x);\n\t\t\t\tif(distance >= slider.settings.swipeThreshold){\n\t\t\t\t\tslider.touch.start.x > slider.touch.end.x ? el.goToNextSlide() : el.goToPrevSlide();\n\t\t\t\t\tel.stopAuto();\n\t\t\t\t}\n\t\t\t// not fade mode\n\t\t\t}else{\n\t\t\t\tvar distance = 0;\n\t\t\t\t// calculate distance and el's animate property\n\t\t\t\tif(slider.settings.mode == 'horizontal'){\n\t\t\t\t\tdistance = slider.touch.end.x - slider.touch.start.x;\n\t\t\t\t\tvalue = slider.touch.originalPos.left;\n\t\t\t\t}else{\n\t\t\t\t\tdistance = slider.touch.end.y - slider.touch.start.y;\n\t\t\t\t\tvalue = slider.touch.originalPos.top;\n\t\t\t\t}\n\t\t\t\t// if not infinite loop and first / last slide, do not attempt a slide transition\n\t\t\t\tif(!slider.settings.infiniteLoop && ((slider.active.index == 0 && distance > 0) || (slider.active.last && distance < 0))){\n\t\t\t\t\tsetPositionProperty(value, 'reset', 200);\n\t\t\t\t}else{\n\t\t\t\t\t// check if distance clears threshold\n\t\t\t\t\tif(Math.abs(distance) >= slider.settings.swipeThreshold){\n\t\t\t\t\t\tdistance < 0 ? el.goToNextSlide() : el.goToPrevSlide();\n\t\t\t\t\t\tel.stopAuto();\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// el.animate(property, 200);\n\t\t\t\t\t\tsetPositionProperty(value, 'reset', 200);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tslider.viewport.unbind('touchend', onTouchEnd);\n\t\t}\n\n\t\t/**\n\t\t * Window resize event callback\n\t\t */\n\t\tvar resizeWindow = function(e){\n\t\t\t// get the new window dimens (again, thank you IE)\n\t\t\tvar windowWidthNew = $(window).width();\n\t\t\tvar windowHeightNew = $(window).height();\n\t\t\t// make sure that it is a true window resize\n\t\t\t// *we must check this because our dinosaur friend IE fires a window resize event when certain DOM elements\n\t\t\t// are resized. Can you just die already?*\n\t\t\tif(windowWidth != windowWidthNew || windowHeight != windowHeightNew){\n\t\t\t\t// set the new window dimens\n\t\t\t\twindowWidth = windowWidthNew;\n\t\t\t\twindowHeight = windowHeightNew;\n\t\t\t\t// update all dynamic elements\n\t\t\t\tel.redrawSlider();\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * ===================================================================================\n\t\t * = PUBLIC FUNCTIONS\n\t\t * ===================================================================================\n\t\t */\n\n\t\t/**\n\t\t * Performs slide transition to the specified slide\n\t\t *\n\t\t * @param slideIndex (int)\n\t\t *  - the destination slide's index (zero-based)\n\t\t *\n\t\t * @param direction (string)\n\t\t *  - INTERNAL USE ONLY - the direction of travel (\"prev\" / \"next\")\n\t\t */\n\t\tel.goToSlide = function(slideIndex, direction){\n\t\t\t// if plugin is currently in motion, ignore request\n\t\t\tif(slider.working || slider.active.index == slideIndex) return;\n\t\t\t// declare that plugin is in motion\n\t\t\tslider.working = true;\n\t\t\t// store the old index\n\t\t\tslider.oldIndex = slider.active.index;\n\t\t\t// if slideIndex is less than zero, set active index to last child (this happens during infinite loop)\n\t\t\tif(slideIndex < 0){\n\t\t\t\tslider.active.index = getPagerQty() - 1;\n\t\t\t// if slideIndex is greater than children length, set active index to 0 (this happens during infinite loop)\n\t\t\t}else if(slideIndex >= getPagerQty()){\n\t\t\t\tslider.active.index = 0;\n\t\t\t// set active index to requested slide\n\t\t\t}else{\n\t\t\t\tslider.active.index = slideIndex;\n\t\t\t}\n\t\t\t// onSlideBefore, onSlideNext, onSlidePrev callbacks\n\t\t\tslider.settings.onSlideBefore(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index);\n\t\t\tif(direction == 'next'){\n\t\t\t\tslider.settings.onSlideNext(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index);\n\t\t\t}else if(direction == 'prev'){\n\t\t\t\tslider.settings.onSlidePrev(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index);\n\t\t\t}\n\t\t\t// check if last slide\n\t\t\tslider.active.last = slider.active.index >= getPagerQty() - 1;\n\t\t\t// update the pager with active class\n\t\t\tif(slider.settings.pager) updatePagerActive(slider.active.index);\n\t\t\t// // check for direction control update\n\t\t\tif(slider.settings.controls) updateDirectionControls();\n\t\t\t// if slider is set to mode: \"fade\"\n\t\t\tif(slider.settings.mode == 'fade'){\n\t\t\t\t// if adaptiveHeight is true and next height is different from current height, animate to the new height\n\t\t\t\tif(slider.settings.adaptiveHeight && slider.viewport.height() != getViewportHeight()){\n\t\t\t\t\tslider.viewport.animate({height: getViewportHeight()}, slider.settings.adaptiveHeightSpeed);\n\t\t\t\t}\n\t\t\t\t// fade out the visible child and reset its z-index value\n\t\t\t\tslider.children.filter(':visible').fadeOut(slider.settings.speed).css({zIndex: 0});\n\t\t\t\t// fade in the newly requested slide\n\t\t\t\tslider.children.eq(slider.active.index).css('zIndex', 51).fadeIn(slider.settings.speed, function(){\n\t\t\t\t\t$(this).css('zIndex', 50);\n\t\t\t\t\tupdateAfterSlideTransition();\n\t\t\t\t});\n\t\t\t// slider mode is not \"fade\"\n\t\t\t}else{\n\t\t\t\t// if adaptiveHeight is true and next height is different from current height, animate to the new height\n\t\t\t\tif(slider.settings.adaptiveHeight && slider.viewport.height() != getViewportHeight()){\n\t\t\t\t\tslider.viewport.animate({height: getViewportHeight()}, slider.settings.adaptiveHeightSpeed);\n\t\t\t\t}\n\t\t\t\tvar moveBy = 0;\n\t\t\t\tvar position = {left: 0, top: 0};\n\t\t\t\t// if carousel and not infinite loop\n\t\t\t\tif(!slider.settings.infiniteLoop && slider.carousel && slider.active.last){\n\t\t\t\t\tif(slider.settings.mode == 'horizontal'){\n\t\t\t\t\t\t// get the last child position\n\t\t\t\t\t\tvar lastChild = slider.children.eq(slider.children.length - 1);\n\t\t\t\t\t\tposition = lastChild.position();\n\t\t\t\t\t\t// calculate the position of the last slide\n\t\t\t\t\t\tmoveBy = slider.viewport.width() - lastChild.outerWidth();\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// get last showing index position\n\t\t\t\t\t\tvar lastShowingIndex = slider.children.length - slider.settings.minSlides;\n\t\t\t\t\t\tposition = slider.children.eq(lastShowingIndex).position();\n\t\t\t\t\t}\n\t\t\t\t\t// horizontal carousel, going previous while on first slide (infiniteLoop mode)\n\t\t\t\t}else if(slider.carousel && slider.active.last && direction == 'prev'){\n\t\t\t\t\t// get the last child position\n\t\t\t\t\tvar eq = slider.settings.moveSlides == 1 ? slider.settings.maxSlides - getMoveBy() : ((getPagerQty() - 1) * getMoveBy()) - (slider.children.length - slider.settings.maxSlides);\n\t\t\t\t\tvar lastChild = el.children('.bx-clone').eq(eq);\n\t\t\t\t\tposition = lastChild.position();\n\t\t\t\t// if infinite loop and \"Next\" is clicked on the last slide\n\t\t\t\t}else if(direction == 'next' && slider.active.index == 0){\n\t\t\t\t\t// get the last clone position\n\t\t\t\t\tposition = el.find('> .bx-clone').eq(slider.settings.maxSlides).position();\n\t\t\t\t\tslider.active.last = false;\n\t\t\t\t// normal non-zero requests\n\t\t\t\t}else if(slideIndex >= 0){\n\t\t\t\t\tvar requestEl = slideIndex * getMoveBy();\n\t\t\t\t\tposition = slider.children.eq(requestEl).position();\n\t\t\t\t}\n\n\t\t\t\t/* If the position doesn't exist\n\t\t\t\t * (e.g. if you destroy the slider on a next click),\n\t\t\t\t * it doesn't throw an error.\n\t\t\t\t */\n\t\t\t\tif (\"undefined\" !== typeof(position)) {\n\t\t\t\t\tvar value = slider.settings.mode == 'horizontal' ? -(position.left - moveBy) : -position.top;\n\t\t\t\t\t// plugin values to be animated\n\t\t\t\t\tsetPositionProperty(value, 'slide', slider.settings.speed);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Transitions to the next slide in the show\n\t\t */\n\t\tel.goToNextSlide = function(){\n\t\t\t// if infiniteLoop is false and last page is showing, disregard call\n\t\t\tif (!slider.settings.infiniteLoop && slider.active.last) return;\n\t\t\tvar pagerIndex = parseInt(slider.active.index) + 1;\n\t\t\tel.goToSlide(pagerIndex, 'next');\n\t\t}\n\n\t\t/**\n\t\t * Transitions to the prev slide in the show\n\t\t */\n\t\tel.goToPrevSlide = function(){\n\t\t\t// if infiniteLoop is false and last page is showing, disregard call\n\t\t\tif (!slider.settings.infiniteLoop && slider.active.index == 0) return;\n\t\t\tvar pagerIndex = parseInt(slider.active.index) - 1;\n\t\t\tel.goToSlide(pagerIndex, 'prev');\n\t\t}\n\n\t\t/**\n\t\t * Starts the auto show\n\t\t *\n\t\t * @param preventControlUpdate (boolean)\n\t\t *  - if true, auto controls state will not be updated\n\t\t */\n\t\tel.startAuto = function(preventControlUpdate){\n\t\t\t// if an interval already exists, disregard call\n\t\t\tif(slider.interval) return;\n\t\t\t// create an interval\n\t\t\tslider.interval = setInterval(function(){\n\t\t\t\tslider.settings.autoDirection == 'next' ? el.goToNextSlide() : el.goToPrevSlide();\n\t\t\t}, slider.settings.pause);\n\t\t\t// if auto controls are displayed and preventControlUpdate is not true\n\t\t\tif (slider.settings.autoControls && preventControlUpdate != true) updateAutoControls('stop');\n\t\t}\n\n\t\t/**\n\t\t * Stops the auto show\n\t\t *\n\t\t * @param preventControlUpdate (boolean)\n\t\t *  - if true, auto controls state will not be updated\n\t\t */\n\t\tel.stopAuto = function(preventControlUpdate){\n\t\t\t// if no interval exists, disregard call\n\t\t\tif(!slider.interval) return;\n\t\t\t// clear the interval\n\t\t\tclearInterval(slider.interval);\n\t\t\tslider.interval = null;\n\t\t\t// if auto controls are displayed and preventControlUpdate is not true\n\t\t\tif (slider.settings.autoControls && preventControlUpdate != true) updateAutoControls('start');\n\t\t}\n\n\t\t/**\n\t\t * Returns current slide index (zero-based)\n\t\t */\n\t\tel.getCurrentSlide = function(){\n\t\t\treturn slider.active.index;\n\t\t}\n\n\t\t/**\n\t\t * Returns number of slides in show\n\t\t */\n\t\tel.getSlideCount = function(){\n\t\t\treturn slider.children.length;\n\t\t}\n\n\t\t/**\n\t\t * Update all dynamic slider elements\n\t\t */\n\t\tel.redrawSlider = function(){\n\t\t\t// resize all children in ratio to new screen size\n\t\t\tslider.children.add(el.find('.bx-clone')).outerWidth(getSlideWidth());\n\t\t\t// adjust the height\n\t\t\tslider.viewport.css('height', getViewportHeight());\n\t\t\t// update the slide position\n\t\t\tif(!slider.settings.ticker) setSlidePosition();\n\t\t\t// if active.last was true before the screen resize, we want\n\t\t\t// to keep it last no matter what screen size we end on\n\t\t\tif (slider.active.last) slider.active.index = getPagerQty() - 1;\n\t\t\t// if the active index (page) no longer exists due to the resize, simply set the index as last\n\t\t\tif (slider.active.index >= getPagerQty()) slider.active.last = true;\n\t\t\t// if a pager is being displayed and a custom pager is not being used, update it\n\t\t\tif(slider.settings.pager && !slider.settings.pagerCustom){\n\t\t\t\tpopulatePager();\n\t\t\t\tupdatePagerActive(slider.active.index);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Destroy the current instance of the slider (revert everything back to original state)\n\t\t */\n\t\tel.destroySlider = function(){\n\t\t\t// don't do anything if slider has already been destroyed\n\t\t\tif(!slider.initialized) return;\n\t\t\tslider.initialized = false;\n\t\t\t$('.bx-clone', this).remove();\n\t\t\tslider.children.each(function() {\n\t\t\t\t$(this).data(\"origStyle\") != undefined ? $(this).attr(\"style\", $(this).data(\"origStyle\")) : $(this).removeAttr('style');\n\t\t\t});\n\t\t\t$(this).data(\"origStyle\") != undefined ? this.attr(\"style\", $(this).data(\"origStyle\")) : $(this).removeAttr('style');\n\t\t\t$(this).unwrap().unwrap();\n\t\t\tif(slider.controls.el) slider.controls.el.remove();\n\t\t\tif(slider.controls.next) slider.controls.next.remove();\n\t\t\tif(slider.controls.prev) slider.controls.prev.remove();\n\t\t\tif(slider.pagerEl) slider.pagerEl.remove();\n\t\t\t$('.bx-caption', this).remove();\n\t\t\tif(slider.controls.autoEl) slider.controls.autoEl.remove();\n\t\t\tclearInterval(slider.interval);\n\t\t\tif(slider.settings.responsive) $(window).unbind('resize', resizeWindow);\n\t\t}\n\n\t\t/**\n\t\t * Reload the slider (revert all DOM changes, and re-initialize)\n\t\t */\n\t\tel.reloadSlider = function(settings){\n\t\t\tif (settings != undefined) options = settings;\n\t\t\tel.destroySlider();\n\t\t\tinit();\n\t\t}\n\n\t\tinit();\n\n\t\t// returns the current jQuery object\n\t\treturn this;\n\t}\n\n})(jQuery);"]}]}